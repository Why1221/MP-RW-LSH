#include <catch2/catch.hpp>
#include <utils.hpp>
#include <vector>

using namespace ss::util;
TEST_CASE("Tests for dot product", "[single-file]") {

  SECTION("int dot_prod_cb_enc(const int*, const uint32_t*, size_t), dim=64") {
    {
      int va[] =
          {43, 146, 81, 212, 70, 140, 110, 228, 136, 180, 212, 187, 49, 36, 49, 110, 129, 58, 172, 115, 129, 113, 16,
           187, 177, 23, 71, 133, 207, 128, 124, 6, 254, 18, 53, 36, 189, 3, 113, 188, 209, 215, 209, 254, 19, 7, 164,
           77, 54, 30, 77, 55, 254, 64, 80, 209, 141, 193, 208, 163, 43, 176, 84, 80};
      uint32_t vb[] = {1204819941u, 3493197158u};
      size_t l = 64;
      REQUIRE(dot_prod_cb_enc<int /* 32 */, int /* 32 */, uint32_t>(va, vb, l) == 240);
    }
    {
      int va[] =
          {152, 112, 202, 226, 155, 121, 52, 24, 227, 135, 144, 160, 249, 229, 187, 36, 99, 56, 133, 3, 42, 103, 206,
           95, 42, 177, 156, 123, 16, 252, 19, 69, 97, 172, 194, 6, 141, 165, 35, 31, 145, 42, 209, 236, 52, 232, 242,
           41, 134, 21, 207, 51, 91, 240, 111, 248, 12, 243, 120, 123, 214, 11, 136, 103};
      uint32_t vb[] = {6794240u, 2193065819u};
      size_t l = 64;
      REQUIRE(dot_prod_cb_enc<int /* 32 */, int /* 32 */, uint32_t>(va, vb, l) == -313);
    }
    {
      int va[] =
          {202, 164, 161, 153, 0, 72, 74, 46, 152, 83, 4, 139, 193, 153, 230, 190, 152, 160, 230, 75, 162, 15, 17, 41,
           188, 134, 204, 133, 187, 17, 53, 43, 14, 92, 186, 231, 244, 250, 248, 164, 184, 217, 150, 35, 166, 21, 220,
           235, 77, 178, 190, 128, 127, 129, 112, 240, 143, 208, 143, 29, 165, 170, 173, 201};
      uint32_t vb[] = {3573713284u, 2944581546u};
      size_t l = 64;
      REQUIRE(dot_prod_cb_enc<int /* 32 */, int /* 32 */, uint32_t>(va, vb, l) == 231);
    }
    {
      int va[] =
          {96, 9, 18, 88, 183, 237, 0, 172, 124, 199, 41, 159, 43, 160, 144, 146, 128, 214, 80, 30, 218, 10, 109, 128,
           45, 141, 233, 196, 203, 212, 14, 160, 53, 127, 90, 217, 145, 77, 139, 166, 148, 84, 126, 210, 137, 102, 73,
           148, 83, 70, 232, 6, 252, 151, 231, 197, 251, 224, 14, 159, 93, 241, 158, 14};
      uint32_t vb[] = {2901447533u, 409243864u};
      size_t l = 64;
      REQUIRE(dot_prod_cb_enc<int /* 32 */, int /* 32 */, uint32_t>(va, vb, l) == -576);
    }
    {
      int va[] =
          {154, 201, 4, 38, 68, 190, 117, 9, 135, 179, 212, 186, 118, 30, 215, 33, 47, 148, 76, 23, 205, 63, 26, 136,
           233, 106, 130, 185, 188, 107, 98, 84, 1, 83, 107, 152, 79, 115, 62, 83, 55, 24, 147, 21, 208, 60, 125, 177,
           169, 197, 88, 155, 58, 243, 255, 89, 98, 49, 73, 16, 1, 122, 217, 58};
      uint32_t vb[] = {4280672920u, 700982793u};
      size_t l = 64;
      REQUIRE(dot_prod_cb_enc<int /* 32 */, int /* 32 */, uint32_t>(va, vb, l) == -811);
    }
  }

  SECTION("int dot_prod_cb_enc(const int*, const uint32_t*, size_t), dim=128") {
    {
      int va[] =
          {155, 62, 248, 217, 135, 154, 76, 212, 147, 126, 71, 162, 227, 82, 252, 175, 43, 214, 244, 1, 2, 68, 57, 92,
           21, 109, 172, 174, 103, 248, 155, 215, 73, 77, 82, 149, 168, 250, 175, 141, 222, 136, 3, 27, 31, 203, 155,
           130, 103, 221, 40, 195, 192, 121, 131, 11, 192, 189, 252, 88, 59, 1, 13, 6, 216, 111, 164, 239, 84, 181, 8,
           142, 102, 212, 179, 198, 142, 116, 162, 244, 129, 173, 206, 123, 91, 174, 123, 102, 75, 201, 85, 54, 19, 7,
           62, 197, 249, 128, 27, 24, 189, 206, 55, 50, 127, 166, 144, 152, 166, 118, 163, 159, 254, 13, 52, 164, 91,
           172, 123, 207, 66, 8, 126, 238, 18, 62, 182, 14};
      uint32_t vb[] = {532174631u, 1563186439u, 3321129283u, 4077136032u};
      size_t l = 128;
      REQUIRE(dot_prod_cb_enc<int /* 32 */, int /* 32 */, uint32_t>(va, vb, l) == -1113);
    }
    {
      int va[] =
          {206, 195, 34, 198, 171, 145, 182, 193, 102, 48, 22, 120, 148, 205, 252, 187, 111, 209, 121, 225, 64, 97, 237,
           130, 72, 145, 2, 180, 147, 49, 1, 69, 80, 238, 80, 178, 144, 119, 97, 102, 29, 135, 79, 57, 102, 61, 147,
           253, 216, 52, 109, 14, 194, 178, 84, 97, 133, 134, 108, 42, 203, 42, 6, 204, 147, 80, 108, 152, 106, 86, 149,
           246, 79, 48, 64, 217, 157, 217, 1, 157, 123, 60, 56, 58, 46, 252, 225, 40, 101, 49, 225, 123, 30, 162, 206,
           123, 197, 38, 94, 241, 119, 79, 245, 205, 226, 102, 221, 25, 64, 142, 190, 206, 142, 32, 173, 233, 193, 196,
           58, 190, 1, 76, 181, 117, 49, 198, 123, 190};
      uint32_t vb[] = {1157561170u, 1123096749u, 1836860157u, 3471195571u};
      size_t l = 128;
      REQUIRE(dot_prod_cb_enc<int /* 32 */, int /* 32 */, uint32_t>(va, vb, l) == 3635);
    }
    {
      int va[] =
          {100, 212, 5, 253, 147, 7, 179, 0, 71, 146, 60, 202, 19, 36, 58, 222, 65, 214, 20, 157, 234, 253, 129, 190,
           17, 150, 242, 166, 142, 82, 18, 96, 120, 235, 193, 2, 144, 84, 56, 51, 157, 192, 89, 165, 138, 130, 212, 247,
           93, 235, 219, 145, 89, 0, 55, 252, 162, 2, 98, 106, 99, 160, 94, 100, 102, 117, 240, 60, 94, 96, 222, 2, 145,
           234, 37, 181, 2, 32, 62, 228, 131, 77, 16, 196, 90, 31, 141, 227, 115, 7, 46, 77, 207, 145, 57, 218, 251,
           183, 3, 120, 185, 86, 129, 110, 33, 105, 61, 23, 13, 75, 224, 134, 28, 6, 254, 1, 153, 85, 47, 27, 186, 82,
           93, 11, 103, 42, 72, 218};
      uint32_t vb[] = {3767554527u, 3270281314u, 1071437826u, 2685178378u};
      size_t l = 128;
      REQUIRE(dot_prod_cb_enc<int /* 32 */, int /* 32 */, uint32_t>(va, vb, l) == -3260);
    }
    {
      int va[] =
          {126, 203, 55, 217, 185, 201, 247, 104, 72, 189, 47, 135, 81, 248, 113, 78, 92, 160, 14, 194, 90, 81, 238,
           235, 114, 35, 235, 88, 112, 105, 136, 91, 235, 184, 97, 205, 94, 11, 107, 16, 201, 255, 46, 228, 249, 119,
           84, 198, 192, 119, 38, 65, 203, 251, 140, 156, 172, 8, 200, 184, 101, 1, 56, 162, 82, 17, 192, 144, 178, 254,
           233, 175, 184, 206, 243, 248, 206, 160, 236, 111, 189, 202, 167, 116, 49, 151, 133, 242, 166, 251, 31, 158,
           210, 8, 67, 91, 129, 100, 187, 0, 227, 162, 201, 223, 123, 124, 124, 142, 122, 164, 13, 81, 96, 31, 218, 114,
           132, 71, 202, 43, 209, 128, 6, 60, 161, 186, 18, 180};
      uint32_t vb[] = {3028428563u, 574205888u, 660921259u, 3405727978u};
      size_t l = 128;
      REQUIRE(dot_prod_cb_enc<int /* 32 */, int /* 32 */, uint32_t>(va, vb, l) == 117);
    }
    {
      int va[] =
          {126, 91, 175, 165, 142, 166, 182, 15, 27, 131, 1, 21, 241, 222, 252, 130, 148, 83, 18, 94, 82, 93, 251, 152,
           250, 183, 166, 251, 180, 41, 217, 46, 227, 23, 45, 184, 177, 1, 89, 48, 133, 4, 73, 120, 237, 148, 212, 142,
           166, 165, 139, 98, 173, 11, 62, 173, 50, 151, 122, 127, 139, 213, 52, 59, 161, 23, 121, 162, 130, 135, 155,
           180, 173, 12, 4, 9, 168, 85, 45, 111, 176, 205, 159, 255, 33, 154, 174, 2, 14, 171, 213, 117, 212, 84, 80,
           215, 1, 126, 196, 130, 119, 236, 167, 181, 219, 156, 247, 43, 204, 53, 79, 21, 114, 6, 217, 139, 35, 195,
           113, 185, 25, 66, 86, 133, 74, 33, 18, 126};
      uint32_t vb[] = {678517096u, 1301439891u, 329714206u, 767918382u};
      size_t l = 128;
      REQUIRE(dot_prod_cb_enc<int /* 32 */, int /* 32 */, uint32_t>(va, vb, l) == -3114);
    }
  }

  SECTION("int dot_prod_cb_enc(const int*, const uint32_t*, size_t), dim=256") {
    {
      int va[] =
          {202, 183, 93, 91, 137, 247, 178, 159, 55, 49, 136, 204, 177, 147, 180, 98, 129, 112, 187, 217, 163, 186, 252,
           61, 182, 44, 168, 35, 255, 89, 238, 250, 181, 114, 254, 233, 164, 90, 104, 99, 97, 4, 78, 149, 80, 228, 88,
           189, 107, 177, 190, 27, 45, 66, 213, 115, 132, 37, 181, 113, 70, 5, 241, 150, 146, 184, 117, 103, 152, 134,
           20, 225, 16, 236, 206, 226, 125, 163, 227, 202, 154, 176, 158, 203, 116, 117, 225, 217, 25, 65, 222, 47, 105,
           139, 207, 106, 111, 94, 173, 129, 153, 228, 27, 16, 239, 198, 241, 62, 37, 215, 128, 56, 73, 130, 252, 229,
           213, 173, 126, 73, 148, 52, 241, 57, 207, 189, 61, 185, 129, 88, 161, 7, 87, 240, 23, 126, 251, 249, 76, 149,
           92, 202, 138, 97, 164, 184, 33, 135, 105, 87, 38, 34, 144, 201, 26, 70, 161, 178, 66, 13, 220, 112, 69, 101,
           145, 135, 13, 70, 123, 183, 115, 52, 104, 82, 123, 58, 107, 205, 228, 238, 211, 111, 118, 198, 198, 65, 243,
           159, 165, 212, 78, 96, 66, 38, 65, 86, 36, 70, 74, 11, 35, 230, 132, 239, 174, 77, 53, 206, 181, 231, 247,
           62, 102, 84, 200, 214, 223, 91, 150, 210, 153, 196, 42, 229, 56, 151, 93, 47, 145, 141, 133, 11, 222, 208,
           44, 181, 40, 143, 50, 25, 102, 69, 24, 141, 162, 53, 12, 187, 124, 62, 35, 0, 222, 2, 82, 57};
      uint32_t
          vb[] = {2951940609u, 4254295053u, 2047565740u, 550570742u, 1287019157u, 1650121309u, 2164171244u, 611666835u};
      size_t l = 256;
      REQUIRE(dot_prod_cb_enc<int /* 32 */, int /* 32 */, uint32_t>(va, vb, l) == 1529);
    }
    {
      int va[] =
          {73, 10, 137, 18, 106, 243, 226, 172, 87, 114, 181, 244, 100, 9, 98, 254, 190, 121, 249, 131, 161, 98, 210,
           185, 87, 210, 57, 181, 58, 15, 136, 228, 4, 231, 15, 142, 160, 27, 196, 1, 84, 172, 239, 213, 185, 209, 153,
           195, 174, 200, 226, 19, 152, 125, 7, 104, 209, 232, 67, 249, 199, 188, 172, 78, 190, 171, 23, 41, 119, 32,
           165, 6, 30, 247, 52, 6, 177, 70, 133, 134, 38, 60, 49, 150, 97, 8, 211, 182, 84, 140, 18, 255, 50, 225, 127,
           242, 72, 175, 214, 216, 53, 184, 85, 35, 218, 99, 93, 91, 210, 19, 253, 32, 104, 59, 185, 151, 185, 112, 1,
           136, 83, 213, 210, 238, 144, 47, 134, 54, 101, 255, 169, 212, 10, 171, 40, 109, 4, 128, 209, 118, 241, 83,
           74, 204, 226, 40, 152, 179, 159, 65, 95, 111, 170, 47, 96, 158, 190, 118, 219, 158, 94, 153, 14, 129, 75,
           164, 68, 234, 58, 128, 103, 240, 2, 210, 43, 218, 109, 219, 41, 134, 19, 122, 24, 221, 120, 202, 202, 35,
           235, 19, 215, 161, 97, 128, 229, 104, 48, 136, 239, 234, 60, 230, 108, 56, 68, 140, 96, 80, 55, 50, 145, 251,
           236, 22, 119, 117, 145, 158, 182, 28, 161, 233, 27, 136, 55, 128, 166, 241, 235, 100, 196, 30, 169, 129, 54,
           44, 71, 176, 225, 60, 115, 43, 253, 91, 158, 220, 70, 54, 16, 173, 74, 202, 217, 232, 247, 122};
      uint32_t
          vb[] = {687812657u, 134219642u, 3912470825u, 3005487995u, 1326127586u, 3089548851u, 4249183155u, 2266689994u};
      size_t l = 256;
      REQUIRE(dot_prod_cb_enc<int /* 32 */, int /* 32 */, uint32_t>(va, vb, l) == -2759);
    }
    {
      int va[] =
          {229, 44, 56, 234, 41, 231, 225, 16, 34, 9, 161, 128, 231, 69, 247, 235, 17, 99, 243, 69, 40, 115, 5, 184,
           203, 101, 36, 160, 182, 4, 84, 125, 233, 252, 50, 98, 237, 90, 69, 223, 140, 11, 118, 228, 22, 164, 81, 35,
           39, 203, 135, 202, 158, 247, 100, 176, 173, 177, 170, 77, 233, 127, 64, 185, 209, 80, 242, 237, 72, 203, 130,
           208, 62, 19, 213, 229, 47, 43, 39, 36, 100, 231, 140, 51, 236, 85, 191, 235, 195, 252, 249, 171, 41, 221,
           169, 227, 134, 224, 4, 220, 98, 67, 120, 24, 222, 27, 201, 221, 83, 125, 195, 170, 116, 56, 171, 115, 123,
           236, 146, 53, 107, 114, 138, 192, 251, 222, 143, 91, 199, 233, 39, 123, 203, 155, 156, 96, 200, 152, 138,
           244, 144, 200, 172, 79, 107, 136, 114, 134, 107, 138, 35, 136, 139, 161, 86, 25, 106, 155, 72, 19, 237, 139,
           83, 50, 199, 27, 156, 255, 121, 120, 77, 86, 6, 52, 116, 9, 230, 214, 111, 239, 191, 149, 111, 201, 58, 143,
           120, 69, 253, 180, 220, 158, 200, 88, 101, 87, 119, 123, 104, 220, 173, 23, 196, 42, 130, 199, 95, 96, 107,
           118, 147, 126, 13, 100, 98, 97, 151, 166, 67, 32, 98, 240, 75, 233, 116, 118, 150, 144, 44, 206, 22, 208,
           115, 51, 21, 215, 238, 214, 136, 54, 213, 177, 65, 168, 131, 69, 26, 251, 6, 175, 87, 14, 135, 185, 220, 34};
      uint32_t
          vb[] = {1421989072u, 177718373u, 3484103816u, 3650703908u, 1347521332u, 713294748u, 1291584871u, 3620748851u};
      size_t l = 256;
      REQUIRE(dot_prod_cb_enc<int /* 32 */, int /* 32 */, uint32_t>(va, vb, l) == -4937);
    }
    {
      int va[] =
          {255, 72, 32, 183, 183, 211, 157, 39, 40, 71, 62, 133, 203, 109, 192, 25, 250, 237, 17, 208, 236, 110, 10, 7,
           83, 116, 49, 55, 67, 29, 17, 120, 64, 166, 65, 112, 212, 238, 230, 25, 65, 200, 23, 55, 77, 242, 26, 220, 54,
           159, 28, 29, 78, 246, 203, 60, 226, 24, 25, 42, 122, 80, 92, 54, 118, 165, 220, 100, 233, 67, 52, 109, 15,
           122, 84, 82, 164, 199, 5, 236, 41, 255, 51, 92, 66, 110, 75, 240, 30, 175, 3, 69, 75, 156, 112, 14, 128, 4,
           130, 145, 184, 61, 45, 129, 240, 9, 37, 49, 192, 128, 75, 227, 139, 54, 77, 61, 41, 242, 17, 96, 146, 72, 57,
           4, 218, 253, 196, 78, 181, 128, 225, 175, 245, 173, 111, 254, 242, 72, 199, 218, 112, 193, 135, 189, 180,
           253, 167, 36, 242, 14, 78, 23, 56, 61, 52, 122, 174, 28, 55, 229, 74, 173, 69, 170, 112, 252, 203, 89, 152,
           230, 29, 33, 113, 178, 98, 37, 217, 91, 201, 120, 164, 44, 119, 43, 87, 201, 156, 195, 10, 156, 112, 72, 39,
           146, 115, 3, 249, 66, 129, 0, 228, 200, 223, 62, 19, 186, 18, 132, 121, 45, 183, 221, 207, 7, 156, 18, 100,
           37, 87, 67, 115, 64, 149, 99, 73, 163, 82, 114, 86, 123, 45, 30, 242, 231, 150, 228, 20, 146, 145, 70, 133,
           146, 183, 118, 107, 205, 177, 171, 184, 181, 66, 21, 98, 235, 100, 66};
      uint32_t
          vb[] = {2548035186u, 4093879860u, 597704907u, 1758042556u, 2696008776u, 4041288060u, 2836801095u, 503730236u};
      size_t l = 256;
      REQUIRE(dot_prod_cb_enc<int /* 32 */, int /* 32 */, uint32_t>(va, vb, l) == -2111);
    }
    {
      int va[] =
          {190, 94, 33, 49, 106, 73, 49, 246, 117, 81, 126, 140, 189, 211, 100, 37, 27, 156, 169, 169, 27, 118, 84, 192,
           235, 105, 134, 42, 244, 149, 76, 121, 34, 5, 66, 51, 212, 170, 254, 20, 123, 198, 176, 219, 162, 55, 249,
           225, 219, 195, 10, 244, 139, 72, 96, 229, 52, 189, 145, 168, 69, 167, 243, 245, 226, 86, 14, 148, 31, 24, 96,
           26, 7, 88, 69, 54, 12, 19, 132, 48, 209, 130, 144, 72, 118, 105, 142, 123, 234, 118, 148, 60, 214, 231, 23,
           33, 51, 109, 230, 90, 35, 228, 239, 206, 52, 194, 81, 221, 255, 18, 133, 54, 67, 172, 150, 193, 139, 228,
           247, 210, 131, 76, 131, 230, 56, 124, 134, 98, 18, 85, 133, 89, 63, 147, 45, 34, 213, 152, 61, 0, 8, 76, 100,
           66, 94, 156, 71, 108, 86, 255, 70, 242, 223, 7, 93, 44, 107, 50, 172, 9, 26, 203, 184, 198, 106, 90, 162,
           147, 96, 221, 46, 179, 5, 197, 13, 162, 200, 16, 185, 185, 88, 13, 32, 241, 238, 243, 232, 103, 170, 67, 234,
           220, 236, 53, 73, 95, 204, 114, 159, 114, 156, 179, 130, 203, 228, 141, 120, 0, 142, 18, 254, 180, 133, 192,
           109, 113, 105, 161, 74, 64, 77, 59, 124, 55, 46, 74, 50, 82, 159, 48, 77, 74, 31, 204, 87, 69, 63, 233, 200,
           194, 52, 234, 72, 220, 87, 108, 230, 239, 203, 180, 125, 7, 222, 241, 189, 52};
      uint32_t vb[] =
          {3368364691u, 3421882618u, 1423619139u, 2506630673u, 1736036736u, 2334862376u, 2599499860u, 3287112189u};
      size_t l = 256;
      REQUIRE(dot_prod_cb_enc<int /* 32 */, int /* 32 */, uint32_t>(va, vb, l) == -436);
    }
  }

  SECTION("int dot_prod_cb_enc(const int*, const uint32_t*, size_t), dim=60") {
    {
      int va[] =
          {237, 12, 209, 85, 184, 4, 141, 160, 255, 144, 162, 19, 86, 102, 155, 68, 201, 163, 137, 203, 82, 186, 179,
           124, 221, 174, 58, 211, 136, 53, 238, 31, 254, 247, 57, 95, 59, 230, 241, 33, 66, 131, 207, 112, 23, 188, 1,
           137, 61, 66, 141, 229, 148, 171, 198, 31, 38, 171, 83, 108};
      uint32_t vb[] = {3234538008u, 62651030u};
      size_t l = 60;
      REQUIRE(dot_prod_cb_enc<int /* 32 */, int /* 32 */, uint32_t>(va, vb, l) == -998);
    }
    {
      int va[] =
          {47, 97, 39, 200, 160, 128, 15, 38, 160, 151, 247, 72, 98, 20, 94, 199, 5, 242, 149, 212, 105, 201, 12, 108,
           166, 4, 201, 252, 26, 246, 240, 40, 0, 252, 178, 29, 75, 17, 242, 226, 255, 137, 37, 187, 31, 15, 120, 207,
           109, 96, 23, 178, 240, 101, 94, 225, 109, 164, 106, 9};
      uint32_t vb[] = {39666730u, 177370812u};
      size_t l = 60;
      REQUIRE(dot_prod_cb_enc<int /* 32 */, int /* 32 */, uint32_t>(va, vb, l) == -888);
    }
    {
      int va[] =
          {125, 194, 91, 74, 242, 117, 59, 194, 74, 99, 24, 180, 221, 174, 44, 177, 78, 114, 48, 171, 27, 54, 184, 178,
           164, 191, 130, 208, 188, 9, 185, 248, 65, 148, 99, 236, 253, 190, 104, 69, 147, 178, 227, 200, 146, 34, 30,
           212, 231, 99, 91, 246, 243, 90, 201, 165, 152, 28, 126, 178};
      uint32_t vb[] = {3612405934u, 226303158u};
      size_t l = 60;
      REQUIRE(dot_prod_cb_enc<int /* 32 */, int /* 32 */, uint32_t>(va, vb, l) == 1088);
    }
    {
      int va[] =
          {192, 129, 68, 76, 109, 28, 150, 143, 163, 145, 9, 33, 83, 180, 77, 235, 17, 217, 139, 6, 101, 170, 127, 61,
           40, 230, 20, 18, 209, 9, 115, 40, 2, 202, 203, 26, 77, 75, 28, 162, 52, 82, 201, 84, 246, 105, 8, 127, 93,
           45, 49, 78, 170, 76, 109, 64, 174, 180, 149, 112};
      uint32_t vb[] = {1021097819u, 17563212u};
      size_t l = 60;
      REQUIRE(dot_prod_cb_enc<int /* 32 */, int /* 32 */, uint32_t>(va, vb, l) == 648);
    }
    {
      int va[] =
          {246, 146, 210, 182, 225, 53, 33, 176, 239, 189, 205, 209, 13, 218, 122, 72, 152, 162, 199, 163, 199, 28, 110,
           215, 114, 212, 137, 75, 110, 150, 127, 66, 218, 98, 148, 90, 166, 117, 28, 48, 193, 169, 232, 123, 123, 140,
           243, 251, 83, 242, 88, 153, 181, 167, 233, 21, 83, 162, 173, 84};
      uint32_t vb[] = {3629838410u, 140609870u};
      size_t l = 60;
      REQUIRE(dot_prod_cb_enc<int /* 32 */, int /* 32 */, uint32_t>(va, vb, l) == -1040);
    }
  }

  SECTION("int dot_prod_cb_enc(const int*, const uint32_t*, size_t), dim=59") {
    {
      int va[] =
          {86, 36, 36, 228, 111, 165, 114, 233, 51, 195, 67, 41, 32, 158, 221, 88, 131, 42, 73, 170, 1, 119, 70, 137,
           24, 82, 227, 123, 42, 136, 200, 66, 130, 224, 242, 162, 22, 14, 157, 86, 175, 14, 71, 58, 104, 31, 70, 123,
           126, 161, 194, 3, 75, 87, 8, 7, 200, 83, 241};
      uint32_t vb[] = {3704568875u, 109945693u};
      size_t l = 59;
      REQUIRE(dot_prod_cb_enc<int /* 32 */, int /* 32 */, uint32_t>(va, vb, l) == 1811);
    }
    {
      int va[] =
          {99, 71, 44, 53, 36, 96, 29, 2, 49, 26, 82, 156, 215, 159, 242, 180, 0, 225, 162, 240, 169, 95, 205, 152, 31,
           112, 99, 120, 168, 240, 210, 85, 40, 97, 178, 232, 108, 160, 192, 106, 28, 20, 60, 12, 97, 211, 99, 242, 141,
           169, 185, 147, 132, 228, 85, 42, 199, 165, 244};
      uint32_t vb[] = {511584040u, 69389305u};
      size_t l = 59;
      REQUIRE(dot_prod_cb_enc<int /* 32 */, int /* 32 */, uint32_t>(va, vb, l) == 85);
    }
    {
      int va[] =
          {125, 78, 71, 68, 20, 54, 31, 25, 141, 41, 197, 233, 224, 57, 131, 244, 116, 235, 200, 79, 158, 218, 136, 161,
           29, 93, 87, 235, 107, 198, 205, 187, 7, 99, 9, 200, 212, 65, 124, 217, 170, 99, 26, 241, 76, 210, 104, 201,
           175, 146, 176, 239, 91, 142, 62, 195, 81, 44, 67};
      uint32_t vb[] = {355311789u, 131687822u};
      size_t l = 59;
      REQUIRE(dot_prod_cb_enc<int /* 32 */, int /* 32 */, uint32_t>(va, vb, l) == 104);
    }
    {
      int va[] =
          {10, 154, 210, 176, 35, 32, 38, 187, 61, 117, 231, 54, 224, 213, 252, 156, 217, 201, 184, 181, 0, 2, 232, 30,
           241, 2, 23, 255, 198, 65, 231, 195, 108, 149, 69, 25, 236, 106, 225, 64, 176, 0, 229, 85, 251, 94, 193, 175,
           29, 195, 162, 11, 9, 75, 32, 145, 105, 78, 84};
      uint32_t vb[] = {730944352u, 70061959u};
      size_t l = 59;
      REQUIRE(dot_prod_cb_enc<int /* 32 */, int /* 32 */, uint32_t>(va, vb, l) == -1653);
    }
    {
      int va[] =
          {64, 83, 30, 14, 245, 5, 79, 47, 128, 156, 147, 88, 112, 189, 129, 145, 63, 39, 163, 55, 63, 37, 87, 235, 180,
           216, 6, 228, 233, 195, 12, 83, 233, 107, 227, 161, 79, 136, 57, 4, 23, 41, 144, 197, 128, 157, 32, 48, 119,
           113, 171, 27, 182, 209, 97, 0, 81, 243, 214};
      uint32_t vb[] = {3278312263u, 49639142u};
      size_t l = 59;
      REQUIRE(dot_prod_cb_enc<int /* 32 */, int /* 32 */, uint32_t>(va, vb, l) == 1086);
    }
  }

  SECTION("int dot_prod_cb_enc(const int*, const uint32_t*, size_t), dim=100") {
    {
      int va[] =
          {44, 35, 163, 99, 222, 46, 81, 114, 179, 112, 147, 227, 32, 241, 132, 163, 214, 49, 212, 119, 132, 73, 213,
           104, 77, 23, 128, 242, 38, 18, 52, 210, 215, 238, 106, 64, 39, 202, 159, 47, 136, 115, 203, 189, 26, 73, 0,
           59, 196, 90, 138, 105, 164, 127, 131, 56, 171, 218, 4, 170, 138, 113, 92, 142, 212, 94, 62, 69, 216, 162, 19,
           47, 50, 189, 121, 198, 99, 243, 145, 11, 241, 67, 138, 74, 97, 110, 146, 130, 8, 245, 74, 172, 134, 154, 218,
           232, 166, 140, 85, 46};
      uint32_t vb[] = {1226641427u, 1249684144u, 2870683015u, 2u};
      size_t l = 100;
      REQUIRE(dot_prod_cb_enc<int /* 32 */, int /* 32 */, uint32_t>(va, vb, l) == -967);
    }
    {
      int va[] =
          {239, 232, 210, 252, 91, 208, 214, 124, 221, 31, 30, 81, 220, 115, 234, 230, 13, 83, 198, 229, 88, 136, 152,
           74, 253, 61, 110, 32, 126, 147, 5, 200, 118, 108, 63, 50, 32, 139, 124, 103, 173, 105, 143, 9, 205, 229, 228,
           233, 22, 19, 91, 7, 0, 110, 240, 54, 140, 217, 204, 151, 241, 76, 15, 151, 191, 191, 46, 51, 211, 194, 77,
           56, 157, 23, 108, 172, 35, 41, 193, 205, 125, 35, 25, 231, 235, 61, 109, 16, 187, 216, 190, 233, 120, 145,
           50, 119, 17, 3, 76, 75};
      uint32_t vb[] = {19058466u, 639958076u, 3142536329u, 2u};
      size_t l = 100;
      REQUIRE(dot_prod_cb_enc<int /* 32 */, int /* 32 */, uint32_t>(va, vb, l) == -3398);
    }
    {
      int va[] =
          {8, 92, 217, 86, 20, 92, 101, 22, 20, 193, 137, 225, 145, 70, 252, 183, 201, 172, 32, 84, 219, 191, 219, 0,
           174, 19, 10, 230, 188, 39, 36, 52, 220, 122, 227, 182, 202, 119, 172, 213, 113, 192, 108, 243, 104, 137, 176,
           247, 62, 156, 19, 135, 162, 235, 237, 126, 137, 216, 31, 4, 41, 112, 254, 198, 27, 88, 164, 107, 101, 118,
           58, 78, 225, 5, 10, 19, 201, 26, 198, 118, 235, 171, 9, 48, 72, 219, 164, 105, 163, 30, 237, 150, 130, 169,
           96, 0, 137, 142, 42, 191};
      uint32_t vb[] = {186837198u, 3903893669u, 1863601361u, 12u};
      size_t l = 100;
      REQUIRE(dot_prod_cb_enc<int /* 32 */, int /* 32 */, uint32_t>(va, vb, l) == -2130);
    }
    {
      int va[] =
          {210, 243, 225, 1, 230, 161, 234, 14, 17, 252, 61, 149, 0, 138, 109, 4, 56, 191, 183, 39, 175, 48, 23, 107,
           52, 94, 32, 129, 89, 231, 70, 215, 72, 41, 232, 178, 164, 108, 58, 27, 5, 87, 201, 125, 66, 125, 235, 204,
           149, 194, 53, 186, 2, 253, 224, 193, 245, 152, 233, 28, 162, 42, 204, 11, 226, 137, 51, 220, 44, 175, 54,
           255, 231, 189, 113, 129, 222, 177, 151, 192, 87, 39, 41, 83, 225, 136, 185, 159, 150, 9, 71, 97, 250, 10,
           223, 188, 194, 124, 9, 93};
      uint32_t vb[] = {1786049823u, 129177698u, 4151804189u, 14u};
      size_t l = 100;
      REQUIRE(dot_prod_cb_enc<int /* 32 */, int /* 32 */, uint32_t>(va, vb, l) == 2654);
    }
    {
      int va[] =
          {8, 181, 168, 80, 148, 232, 47, 219, 87, 88, 24, 224, 81, 163, 202, 57, 111, 31, 3, 102, 140, 64, 170, 130,
           52, 86, 170, 53, 27, 237, 171, 221, 82, 175, 6, 249, 240, 235, 168, 10, 248, 228, 170, 83, 96, 96, 172, 210,
           232, 184, 54, 26, 102, 124, 47, 86, 110, 39, 200, 60, 134, 208, 4, 13, 190, 235, 116, 101, 7, 135, 118, 80,
           206, 63, 5, 196, 226, 6, 13, 134, 150, 48, 58, 232, 100, 0, 38, 28, 176, 132, 14, 244, 86, 181, 246, 231,
           242, 202, 27, 219};
      uint32_t vb[] = {1062186898u, 172880669u, 4053691437u, 5u};
      size_t l = 100;
      REQUIRE(dot_prod_cb_enc<int /* 32 */, int /* 32 */, uint32_t>(va, vb, l) == 1585);
    }
  }

  SECTION("int dot_prod_cb_enc(const int*, const uint32_t*, size_t), dim=119") {
    {
      int va[] =
          {54, 162, 130, 43, 72, 136, 98, 67, 220, 61, 224, 159, 114, 153, 173, 20, 58, 83, 206, 37, 207, 26, 88, 37,
           110, 101, 91, 237, 168, 112, 201, 138, 52, 0, 254, 171, 102, 147, 197, 187, 137, 249, 203, 216, 135, 227,
           117, 107, 126, 214, 13, 47, 66, 174, 199, 99, 146, 71, 172, 10, 216, 117, 84, 101, 140, 115, 96, 170, 103,
           42, 64, 190, 64, 161, 181, 5, 43, 168, 109, 5, 15, 97, 189, 210, 28, 74, 69, 92, 8, 208, 206, 115, 67, 211,
           62, 94, 176, 84, 29, 8, 126, 69, 24, 135, 76, 13, 110, 143, 217, 118, 189, 86, 170, 195, 148, 86, 45, 87,
           25};
      uint32_t vb[] = {1649901624u, 2083328185u, 2158810376u, 4265499u};
      size_t l = 119;
      REQUIRE(dot_prod_cb_enc<int /* 32 */, int /* 32 */, uint32_t>(va, vb, l) == -2522);
    }
    {
      int va[] =
          {47, 134, 253, 212, 157, 101, 19, 156, 187, 80, 93, 250, 232, 126, 11, 47, 30, 178, 146, 17, 114, 53, 190, 15,
           4, 30, 44, 58, 243, 6, 38, 149, 191, 222, 23, 222, 223, 102, 19, 108, 158, 142, 252, 5, 84, 127, 20, 230,
           177, 89, 235, 217, 209, 103, 86, 57, 54, 51, 62, 203, 118, 86, 66, 57, 113, 21, 165, 46, 26, 193, 145, 39,
           168, 95, 100, 78, 30, 211, 110, 64, 128, 138, 102, 60, 112, 210, 56, 75, 36, 128, 2, 55, 160, 252, 98, 136,
           55, 171, 51, 239, 236, 53, 65, 132, 165, 96, 98, 167, 231, 126, 90, 130, 253, 75, 77, 35, 204, 132, 64};
      uint32_t vb[] = {4079215520u, 1441757785u, 1055557488u, 7533823u};
      size_t l = 119;
      REQUIRE(dot_prod_cb_enc<int /* 32 */, int /* 32 */, uint32_t>(va, vb, l) == 2815);
    }
    {
      int va[] =
          {31, 181, 83, 122, 53, 85, 243, 49, 124, 19, 118, 243, 190, 172, 13, 48, 223, 46, 26, 99, 158, 229, 239, 110,
           209, 81, 95, 227, 220, 129, 199, 151, 88, 181, 135, 155, 232, 57, 232, 178, 23, 72, 231, 43, 195, 121, 149,
           62, 21, 194, 241, 7, 200, 62, 111, 80, 161, 127, 25, 107, 197, 125, 17, 223, 246, 205, 116, 113, 157, 80,
           185, 192, 178, 16, 12, 88, 187, 91, 170, 151, 46, 109, 75, 202, 165, 110, 60, 90, 111, 132, 7, 249, 23, 81,
           143, 127, 163, 28, 208, 64, 105, 159, 196, 220, 178, 51, 107, 15, 227, 92, 0, 207, 66, 204, 242, 66, 247, 37,
           184};
      uint32_t vb[] = {4126275318u, 2360152668u, 339396224u, 5777277u};
      size_t l = 119;
      REQUIRE(dot_prod_cb_enc<int /* 32 */, int /* 32 */, uint32_t>(va, vb, l) == -274);
    }
    {
      int va[] =
          {70, 54, 50, 20, 30, 94, 120, 121, 209, 247, 95, 245, 10, 234, 91, 222, 132, 3, 223, 238, 117, 63, 98, 213,
           145, 207, 14, 97, 142, 211, 161, 173, 151, 134, 78, 242, 71, 67, 79, 35, 226, 36, 107, 95, 151, 117, 249,
           178, 250, 136, 249, 64, 137, 23, 80, 130, 150, 135, 201, 105, 255, 252, 110, 250, 227, 118, 146, 125, 183,
           41, 219, 117, 249, 42, 222, 154, 150, 239, 184, 20, 116, 44, 255, 55, 167, 5, 84, 181, 181, 41, 61, 227, 165,
           163, 237, 58, 206, 83, 5, 143, 5, 130, 108, 45, 162, 211, 181, 122, 218, 157, 214, 203, 203, 131, 7, 92, 184,
           152, 77};
      uint32_t vb[] = {377729507u, 3348372038u, 1388380729u, 3136009u};
      size_t l = 119;
      REQUIRE(dot_prod_cb_enc<int /* 32 */, int /* 32 */, uint32_t>(va, vb, l) == -2973);
    }
    {
      int va[] =
          {126, 154, 113, 152, 23, 63, 186, 189, 25, 207, 174, 34, 48, 183, 107, 108, 119, 104, 184, 34, 206, 156, 129,
           239, 1, 157, 163, 183, 117, 82, 196, 207, 77, 246, 146, 37, 13, 36, 111, 255, 135, 200, 38, 126, 188, 137,
           96, 187, 254, 237, 24, 248, 28, 243, 190, 101, 207, 62, 33, 67, 9, 162, 66, 55, 98, 34, 122, 125, 148, 142,
           131, 15, 218, 144, 81, 66, 47, 98, 13, 23, 188, 99, 203, 81, 186, 154, 165, 219, 197, 216, 217, 29, 34, 126,
           80, 197, 21, 22, 187, 48, 174, 116, 161, 73, 32, 69, 249, 26, 159, 117, 112, 255, 105, 249, 107, 208, 214, 1,
           124};
      uint32_t vb[] = {1650454582u, 3400105559u, 2925049676u, 6188727u};
      size_t l = 119;
      REQUIRE(dot_prod_cb_enc<int /* 32 */, int /* 32 */, uint32_t>(va, vb, l) == 2622);
    }
  }

  SECTION("int dot_prod_cb_enc(const int*, const uint32_t*, size_t), dim=24") {
    {
      int va[] = {53, 61, 217, 57, 12, 129, 90, 6, 240, 71, 83, 131, 61, 151, 10, 140, 37, 4, 13, 155, 136, 50, 9, 159};
      uint32_t vb[] = {9083066u};
      size_t l = 24;
      REQUIRE(dot_prod_cb_enc<int /* 32 */, int /* 32 */, uint32_t>(va, vb, l) == -201);
    }
    {
      int va[] =
          {106, 75, 211, 64, 81, 90, 215, 75, 144, 156, 218, 212, 47, 52, 152, 72, 78, 254, 3, 58, 45, 86, 84, 51};
      uint32_t vb[] = {12657426u};
      size_t l = 24;
      REQUIRE(dot_prod_cb_enc<int /* 32 */, int /* 32 */, uint32_t>(va, vb, l) == -949);
    }
    {
      int va[] =
          {104, 250, 39, 232, 30, 231, 13, 164, 251, 161, 164, 187, 252, 252, 200, 148, 108, 120, 1, 169, 219, 192, 79,
           91};
      uint32_t vb[] = {7170098u};
      size_t l = 24;
      REQUIRE(dot_prod_cb_enc<int /* 32 */, int /* 32 */, uint32_t>(va, vb, l) == -577);
    }
    {
      int va[] =
          {106, 133, 223, 64, 112, 242, 127, 46, 189, 161, 24, 55, 11, 248, 139, 11, 79, 235, 240, 135, 182, 2, 90,
           131};
      uint32_t vb[] = {4577381u};
      size_t l = 24;
      REQUIRE(dot_prod_cb_enc<int /* 32 */, int /* 32 */, uint32_t>(va, vb, l) == -95);
    }
    {
      int va[] =
          {243, 130, 138, 127, 165, 1, 136, 2, 157, 174, 34, 228, 124, 170, 113, 51, 129, 2, 169, 44, 152, 46, 83, 188};
      uint32_t vb[] = {3142631u};
      size_t l = 24;
      REQUIRE(dot_prod_cb_enc<int /* 32 */, int /* 32 */, uint32_t>(va, vb, l) == 826);
    }
  }

  SECTION("int dot_prod_cb_enc(const int*, const uint32_t*, size_t), dim=23") {
    {
      int va[] =
          {121, 125, 201, 235, 225, 232, 211, 88, 88, 83, 225, 187, 93, 140, 41, 181, 157, 202, 244, 204, 234, 191,
           170};
      uint32_t vb[] = {3048525u};
      size_t l = 23;
      REQUIRE(dot_prod_cb_enc<int /* 32 */, int /* 32 */, uint32_t>(va, vb, l) == -352);
    }
    {
      int va[] =
          {185, 152, 124, 185, 0, 60, 234, 164, 208, 165, 62, 69, 85, 150, 156, 190, 227, 119, 25, 184, 26, 0, 88};
      uint32_t vb[] = {6962239u};
      size_t l = 23;
      REQUIRE(dot_prod_cb_enc<int /* 32 */, int /* 32 */, uint32_t>(va, vb, l) == -48);
    }
    {
      int va[] =
          {181, 181, 234, 17, 175, 93, 187, 107, 87, 71, 158, 165, 11, 108, 185, 181, 52, 190, 52, 131, 195, 113, 110};
      uint32_t vb[] = {5925572u};
      size_t l = 23;
      REQUIRE(dot_prod_cb_enc<int /* 32 */, int /* 32 */, uint32_t>(va, vb, l) == -216);
    }
    {
      int va[] =
          {241, 178, 9, 236, 222, 53, 207, 158, 208, 108, 32, 212, 255, 235, 59, 215, 157, 235, 131, 194, 181, 88, 167};
      uint32_t vb[] = {1779277u};
      size_t l = 23;
      REQUIRE(dot_prod_cb_enc<int /* 32 */, int /* 32 */, uint32_t>(va, vb, l) == -177);
    }
    {
      int va[] =
          {231, 230, 91, 172, 189, 21, 34, 80, 23, 128, 107, 1, 28, 132, 180, 149, 187, 133, 200, 38, 165, 69, 168};
      uint32_t vb[] = {4692362u};
      size_t l = 23;
      REQUIRE(dot_prod_cb_enc<int /* 32 */, int /* 32 */, uint32_t>(va, vb, l) == -558);
    }
  }

  SECTION("int dot_prod_cb_enc(const int*, const uint32_t*, size_t), dim=150") {
    {
      int va[] =
          {217, 155, 141, 70, 59, 31, 36, 155, 154, 70, 155, 172, 237, 12, 189, 251, 212, 171, 242, 80, 156, 253, 4,
           233, 151, 120, 61, 22, 16, 161, 60, 100, 139, 207, 96, 188, 207, 162, 119, 211, 154, 39, 223, 169, 80, 6, 12,
           83, 15, 142, 151, 121, 245, 192, 128, 157, 169, 158, 181, 58, 122, 245, 154, 73, 65, 40, 121, 57, 100, 38,
           88, 199, 190, 3, 182, 56, 239, 199, 86, 77, 139, 78, 210, 80, 14, 131, 23, 94, 102, 68, 221, 154, 190, 78,
           219, 54, 79, 213, 50, 162, 92, 220, 107, 216, 52, 93, 189, 144, 135, 155, 133, 247, 113, 9, 69, 52, 155, 61,
           176, 108, 82, 42, 241, 18, 152, 218, 217, 196, 19, 40, 187, 0, 126, 255, 101, 13, 69, 186, 225, 134, 156,
           197, 5, 235, 86, 24, 154, 35, 146, 197};
      uint32_t vb[] = {1055124648u, 1723683712u, 3282758207u, 4182245594u, 3482846u};
      size_t l = 150;
      REQUIRE(dot_prod_cb_enc<int /* 32 */, int /* 32 */, uint32_t>(va, vb, l) == 207);
    }
    {
      int va[] =
          {41, 150, 149, 125, 251, 35, 96, 9, 25, 154, 125, 123, 103, 44, 41, 18, 115, 33, 43, 89, 126, 107, 217, 151,
           175, 221, 218, 199, 91, 173, 148, 251, 93, 59, 11, 238, 137, 128, 237, 161, 26, 73, 10, 201, 14, 34, 190,
           122, 246, 180, 191, 219, 24, 239, 39, 29, 95, 67, 191, 29, 60, 230, 229, 175, 90, 172, 116, 49, 66, 142, 97,
           167, 23, 121, 41, 218, 131, 218, 235, 128, 44, 22, 30, 199, 30, 214, 43, 192, 245, 193, 244, 177, 249, 64,
           60, 200, 53, 196, 71, 224, 37, 250, 123, 41, 79, 23, 223, 114, 112, 104, 152, 115, 36, 131, 1, 127, 246, 147,
           247, 48, 246, 82, 137, 231, 81, 133, 39, 97, 159, 210, 118, 48, 107, 93, 59, 209, 197, 243, 252, 4, 113, 127,
           134, 82, 128, 156, 177, 30, 150, 154};
      uint32_t vb[] = {123914038u, 711644825u, 3230820707u, 4093596481u, 1143830u};
      size_t l = 150;
      REQUIRE(dot_prod_cb_enc<int /* 32 */, int /* 32 */, uint32_t>(va, vb, l) == -663);
    }
    {
      int va[] =
          {91, 94, 169, 225, 83, 88, 254, 242, 74, 0, 251, 181, 146, 49, 202, 149, 48, 37, 185, 140, 186, 119, 110, 90,
           192, 86, 220, 89, 125, 233, 132, 109, 150, 90, 138, 185, 139, 22, 99, 134, 4, 83, 221, 31, 215, 200, 206,
           126, 4, 62, 212, 245, 184, 203, 5, 43, 191, 88, 86, 255, 6, 214, 65, 143, 135, 75, 139, 69, 114, 178, 229,
           191, 34, 202, 153, 167, 16, 226, 217, 220, 253, 53, 118, 188, 231, 17, 89, 114, 127, 161, 203, 226, 203, 53,
           163, 201, 169, 192, 133, 89, 129, 4, 246, 194, 115, 30, 24, 175, 72, 77, 142, 155, 14, 202, 138, 18, 193,
           221, 184, 235, 166, 156, 24, 61, 37, 30, 102, 193, 90, 40, 151, 62, 155, 103, 19, 76, 101, 150, 80, 125, 249,
           137, 204, 40, 34, 152, 233, 220, 47, 102};
      uint32_t vb[] = {669354145u, 2214562296u, 3063627492u, 3688608698u, 283686u};
      size_t l = 150;
      REQUIRE(dot_prod_cb_enc<int /* 32 */, int /* 32 */, uint32_t>(va, vb, l) == 995);
    }
    {
      int va[] =
          {136, 68, 185, 229, 12, 27, 117, 145, 117, 25, 246, 104, 176, 201, 140, 128, 110, 62, 228, 24, 60, 101, 14,
           186, 135, 225, 52, 166, 71, 145, 158, 164, 246, 78, 74, 111, 56, 231, 33, 223, 231, 165, 129, 26, 179, 167,
           81, 232, 132, 162, 98, 205, 233, 148, 125, 82, 99, 14, 92, 22, 91, 53, 130, 116, 224, 140, 220, 191, 178, 87,
           113, 90, 55, 95, 61, 228, 17, 32, 53, 157, 100, 58, 125, 140, 121, 48, 78, 252, 87, 137, 233, 176, 67, 227,
           44, 233, 38, 45, 0, 77, 33, 36, 48, 0, 166, 211, 116, 44, 205, 21, 41, 198, 0, 5, 165, 71, 199, 248, 208, 97,
           33, 166, 1, 193, 191, 20, 249, 12, 15, 166, 206, 140, 136, 186, 43, 196, 214, 251, 209, 49, 200, 241, 212,
           14, 18, 112, 202, 12, 147, 187};
      uint32_t vb[] = {3272744423u, 1475571192u, 4215987950u, 1190280500u, 2671461u};
      size_t l = 150;
      REQUIRE(dot_prod_cb_enc<int /* 32 */, int /* 32 */, uint32_t>(va, vb, l) == 1689);
    }
    {
      int va[] =
          {234, 115, 14, 16, 211, 229, 121, 240, 152, 133, 208, 89, 114, 157, 72, 163, 190, 160, 152, 14, 0, 43, 133,
           188, 253, 247, 28, 21, 36, 49, 176, 131, 67, 3, 3, 166, 100, 7, 41, 71, 233, 20, 36, 62, 245, 81, 253, 236,
           122, 200, 131, 181, 199, 226, 128, 253, 164, 160, 182, 43, 2, 159, 118, 192, 214, 103, 15, 107, 43, 229, 254,
           169, 181, 94, 234, 48, 194, 16, 34, 125, 170, 173, 146, 238, 60, 187, 54, 135, 127, 189, 48, 18, 72, 154,
           147, 71, 65, 7, 152, 2, 176, 124, 35, 231, 46, 227, 193, 123, 185, 34, 47, 46, 114, 188, 174, 242, 226, 109,
           240, 36, 161, 108, 8, 54, 92, 128, 74, 140, 175, 181, 152, 27, 238, 202, 156, 229, 28, 164, 216, 77, 231, 57,
           208, 37, 233, 12, 221, 49, 165, 121};
      uint32_t vb[] = {2173046911u, 4132655511u, 3123753508u, 241309521u, 767010u};
      size_t l = 150;
      REQUIRE(dot_prod_cb_enc<int /* 32 */, int /* 32 */, uint32_t>(va, vb, l) == -1996);
    }
  }

  SECTION("float dot_prod_cb_enc(const float*, const uint32_t*, size_t), dim=64") {
    {
      float va[] =
          {-0.3017165958881378, 1.2877434492111206, -1.3439369201660156, -1.1396783590316772, 0.6277461647987366,
           2.2520930767059326, -0.4432230293750763, 1.2864043712615967, -0.06499914079904556, -3.312680244445801,
           -1.0985122919082642, 1.376583218574524, 1.261198878288269, -0.8655004501342773, -0.8199629187583923,
           -0.8914445638656616, 0.8401696085929871, -0.6034888029098511, 0.3651961386203766, 0.3103346526622772,
           0.36064499616622925, 1.1304336786270142, 1.7893097400665283, 1.384562611579895, 0.511960506439209,
           -0.2675211429595947, 0.9811009764671326, -0.1402520090341568, 0.4478563964366913, -1.1795167922973633,
           -0.0026976694352924824, -0.3897639811038971, 0.4515530467033386, 0.7806046009063721, 0.4321971535682678,
           1.2596838474273682, 0.985791027545929, 0.5352210402488708, 0.07264299690723419, 0.681404709815979,
           0.88580322265625, 2.059954881668091, -1.0213348865509033, 1.364598035812378, -0.42060229182243347,
           -0.8118451237678528, -0.26752373576164246, -1.6808043718338013, -1.3115648031234741, 0.9464862942695618,
           0.7637090086936951, -0.002788504585623741, 0.8937628269195557, -1.2128081321716309, -0.8329523801803589,
           0.4576723277568817, -1.1946938037872314, -1.4674499034881592, -1.394714593887329, 0.29151448607444763,
           0.15750400722026825, -0.2578887939453125, -0.9012559652328491, 0.2237870842218399};
      uint32_t vb[] = {2295203231u, 2847768798u};
      size_t l = 64;
      REQUIRE(
          dot_prod_cb_enc<float /* 32 */, float /* 32 */, uint32_t>(va, vb, l) == Approx(-14.8749185004).epsilon(0.01));
    }
    {
      float va[] =
          {-0.9281025528907776, -1.5144723653793335, 0.40555539727211, -0.4792179763317108, 0.18826547265052795,
           -0.17238518595695496, -0.2684502899646759, 1.095937967300415, -1.258060336112976, -0.33304542303085327,
           -0.24718891084194183, -0.004400786943733692, 0.2096129208803177, -1.7225090265274048, -1.0636799335479736,
           -0.186427503824234, 0.26394423842430115, 0.7212647199630737, -1.442602276802063, -0.4379432201385498,
           -0.7277638912200928, -0.6788904070854187, 1.182552456855774, -1.2956371307373047, -0.870238721370697,
           1.1690400838851929, -0.6329737305641174, 0.5466157793998718, -1.0263720750808716, -0.3193202018737793,
           -0.7338250279426575, -1.5660440921783447, -1.1124190092086792, 0.705195426940918, 0.9667443037033081,
           -0.6644781231880188, -1.1202884912490845, 0.3053954541683197, 0.9841607213020325, 0.39198780059814453,
           -0.6837551593780518, 0.28156450390815735, -0.8080304265022278, -0.12355715781450272, -0.9022470712661743,
           0.031876157969236374, -1.3477386236190796, -0.7093628644943237, 0.8709821105003357, 1.1320037841796875,
           -1.3430960178375244, -0.7108030319213867, 1.2899014949798584, -0.7463822960853577, 0.5585569143295288,
           -0.7628465890884399, -0.27068689465522766, -0.8371193408966064, 0.24848522245883942, -0.08399586379528046,
           1.1131075620651245, -1.8935805559158325, -1.3946774005889893, -1.2247647047042847};
      uint32_t vb[] = {2155256552u, 3859728654u};
      size_t l = 64;
      REQUIRE(
          dot_prod_cb_enc<float /* 32 */, float /* 32 */, uint32_t>(va, vb, l) == Approx(9.20098274108).epsilon(0.01));
    }
    {
      float va[] =
          {0.8737874031066895, -0.8291603326797485, 0.48644161224365234, 1.1198978424072266, 1.0889997482299805,
           0.331659197807312, 0.41343754529953003, 1.4245959520339966, -0.9692367315292358, -1.741952896118164,
           1.4268734455108643, 0.33357375860214233, 1.4999035596847534, 0.20442478358745575, 0.21397443115711212,
           -0.1597927361726761, -0.2122606486082077, 0.31042829155921936, -0.49623996019363403, -0.8935195207595825,
           0.12927554547786713, -0.9551018476486206, 2.5465338230133057, 0.4116586148738861, 1.4557708501815796,
           -0.6162452101707458, -0.8170903325080872, -0.11793819069862366, 0.026613445952534676, -0.27880018949508667,
           -1.5160789489746094, -0.9170413613319397, 1.9830185174942017, -0.5629480481147766, 0.6477062106132507,
           -0.7638916969299316, 1.04057776927948, -1.3599644899368286, 0.6272192597389221, 0.5437395572662354,
           -1.1929742097854614, -1.1333779096603394, -3.856550931930542, -1.817350149154663, -0.5293035507202148,
           0.9764061570167542, 0.2947213351726532, 1.1513440608978271, 0.6811031699180603, -0.4831739068031311,
           -1.453299880027771, -0.34658610820770264, -0.6556495428085327, -0.5215294361114502, -0.6599212288856506,
           -1.162554383277893, -0.912956178188324, -0.6489630937576294, -0.5580773949623108, -0.6592276692390442,
           0.06136583909392357, 0.48277103900909424, -0.06235763803124428, -0.2521054744720459};
      uint32_t vb[] = {4135644429u, 684028301u};
      size_t l = 64;
      REQUIRE(
          dot_prod_cb_enc<float /* 32 */, float /* 32 */, uint32_t>(va, vb, l) == Approx(1.06240196712).epsilon(0.01));
    }
    {
      float va[] =
          {-1.2255923748016357, 0.13532176613807678, 1.4853733777999878, -0.3613286316394806, 0.5357820391654968,
           0.7207647562026978, 0.8923858404159546, -0.6689815521240234, 0.15308287739753723, -0.4441528916358948,
           0.2848457098007202, -1.1159542798995972, 0.07661302387714386, -0.11078555881977081, -0.8187427520751953,
           0.2697296738624573, 0.8790276050567627, 0.05829406902194023, -0.8302642107009888, -0.013872917741537094,
           0.1678193211555481, -1.6411373615264893, 1.5376204252243042, 0.4701773524284363, 0.09678903967142105,
           -0.8260622620582581, 0.74078369140625, 1.8642866611480713, 1.4057685136795044, 1.8199232816696167,
           -0.23397555947303772, 1.0098133087158203, 0.7339346408843994, -0.5661455392837524, 1.7926617860794067,
           0.9789963364601135, -0.46795544028282166, 0.4965463876724243, 0.5974287390708923, -0.9899500012397766,
           0.4218802750110626, -0.8602491021156311, -0.168277308344841, -0.4300328195095062, -0.39925000071525574,
           -0.1618354171514511, 0.23840613663196564, -0.20774072408676147, 1.3716577291488647, -0.23137244582176208,
           1.0836950540542603, 0.3889031410217285, 0.5140535831451416, 1.1219232082366943, 0.578012228012085,
           -1.2640968561172485, -0.5263295769691467, 0.9197407364845276, -0.33786147832870483, -1.4956804513931274,
           -0.5868903398513794, -1.6395717859268188, 0.1738031953573227, -0.16007684171199799};
      uint32_t vb[] = {1990574941u, 862846781u};
      size_t l = 64;
      REQUIRE(
          dot_prod_cb_enc<float /* 32 */, float /* 32 */, uint32_t>(va, vb, l) == Approx(15.9937566072).epsilon(0.01));
    }
    {
      float va[] =
          {0.2026318609714508, 0.5011277794837952, -0.2884308397769928, -1.2447052001953125, -1.9041662216186523,
           1.1093950271606445, 0.09935418516397476, 0.5588523149490356, -0.5305165648460388, -1.7873648405075073,
           0.5059483051300049, 0.6841646432876587, -0.218138188123703, -0.41794392466545105, 0.9380704760551453,
           1.6648966073989868, -0.805757462978363, 0.5247005820274353, 0.09980258345603943, 1.3990395069122314,
           0.0726579800248146, 0.5490904450416565, 0.41185104846954346, -0.046130381524562836, 1.2726376056671143,
           -1.8444128036499023, -1.2962605953216553, 0.6053289175033569, 1.0913132429122925, 0.8367183208465576,
           0.31948813796043396, -1.0665738582611084, -0.6474494338035583, 0.01478874683380127, -0.5853323936462402,
           1.9673830270767212, 1.2179712057113647, 1.017413854598999, 0.06049444526433945, -0.32590198516845703,
           -0.25712138414382935, -1.3966230154037476, -0.08504366129636765, 0.5757442712783813, 0.44316330552101135,
           1.090685486793518, -1.2462908029556274, 0.512762188911438, 0.449654757976532, -0.0022432843688875437,
           -0.43360644578933716, 0.7422803640365601, 0.5466258525848389, 2.1289751529693604, -1.4222296476364136,
           0.3346000611782074, -2.614132881164551, -2.0186564922332764, -1.1312323808670044, 0.3787252604961395,
           1.316758632659912, -0.5140126347541809, -1.662317156791687, 0.0801616832613945};
      uint32_t vb[] = {1758364385u, 3470174359u};
      size_t l = 64;
      REQUIRE(
          dot_prod_cb_enc<float /* 32 */, float /* 32 */, uint32_t>(va, vb, l) == Approx(-21.2829965462).epsilon(0.01));
    }
  }

  SECTION("float dot_prod_cb_enc(const float*, const uint32_t*, size_t), dim=128") {
    {
      float va[] =
          {-0.2250467985868454, 0.5493142008781433, 1.6054309606552124, 0.9049183130264282, 0.04638294875621796,
           -0.07573916018009186, 1.8351552486419678, -1.2289555072784424, 1.7756401300430298, 0.43930765986442566,
           -0.7411492466926575, -0.5402703881263733, 0.6036537885665894, -0.532114565372467, -0.7735621333122253,
           0.9521888494491577, 0.7542522549629211, 0.3481181561946869, 1.2642191648483276, 3.611663818359375,
           -0.8740065097808838, -1.1380592584609985, -0.862768292427063, -1.3826751708984375, -0.7577031850814819,
           2.878800630569458, -0.2760425806045532, 1.7162683010101318, -0.3023524284362793, 0.4721727967262268,
           0.7012437582015991, -0.293191522359848, 0.24515977501869202, 0.1638474315404892, 0.43664127588272095,
           1.988342046737671, 0.02210739254951477, -0.22326521575450897, -1.25144624710083, -0.5802789926528931,
           -0.5102184414863586, 0.9729691743850708, -1.027523159980774, 1.644435167312622, 1.7262835502624512,
           -0.5314341187477112, -0.4256020784378052, 0.8060553669929504, -0.7328502535820007, 0.6123055219650269,
           -0.4266667068004608, -0.27379757165908813, -1.5054584741592407, 0.019137604162096977, 1.5174566507339478,
           -0.29775872826576233, 1.1383209228515625, -0.2878826856613159, -1.7570797204971313, -0.3828172981739044,
           -0.6003196239471436, 0.35710635781288147, -0.4117177724838257, -0.5516492128372192, 0.8729956150054932,
           1.3430429697036743, -0.16604679822921753, -0.19171041250228882, -0.26398766040802, -1.1318994760513306,
           -0.35787782073020935, -1.609395980834961, -0.31746983528137207, -0.11595507711172104, 1.1428916454315186,
           1.9753128290176392, -0.3218725323677063, 0.052326299250125885, -0.3931531608104706, 0.26639270782470703,
           0.4547867178916931, -2.361731767654419, -1.2092456817626953, -1.9090014696121216, 1.4561394453048706,
           2.369197130203247, -1.1125986576080322, 1.5031371116638184, 0.364427387714386, 0.48634159564971924,
           1.1700825691223145, 1.9610713720321655, 0.2536104619503021, 0.9328623414039612, -0.7108883857727051,
           0.30086132884025574, 0.7231963276863098, -0.751221776008606, 1.4316415786743164, -1.1622685194015503,
           -0.2991761267185211, 0.9901516437530518, 0.1564786583185196, 2.2816550731658936, -0.0056911855936050415,
           -0.2723647654056549, -0.5388251543045044, -0.9301449656486511, 0.3120284974575043, 0.5223487615585327,
           -1.0797754526138306, 1.3010042905807495, 1.4459739923477173, -0.43022939562797546, -3.7322640419006348,
           -1.5363160371780396, 1.120436668395996, 0.48415127396583557, -1.8217731714248657, -0.4014368951320648,
           -0.6570758819580078, -1.9956427812576294, 1.1270287036895752, -1.2104436159133911, -0.4147227108478546,
           -0.11147905886173248, 0.023465480655431747, -0.23879629373550415};
      uint32_t vb[] = {16746675u, 80055616u, 3294758555u, 1043907224u};
      size_t l = 128;
      REQUIRE(
          dot_prod_cb_enc<float /* 32 */, float /* 32 */, uint32_t>(va, vb, l) == Approx(-5.63200045936).epsilon(0.01));
    }
    {
      float va[] =
          {-1.12337064743042, 0.31058087944984436, 0.49342450499534607, 0.3804238736629486, -0.9516182541847229,
           0.1661314070224762, 0.02652016095817089, 1.527301549911499, 0.4742293953895569, 0.03836507722735405,
           -0.5137630701065063, -2.474747896194458, 1.5957728624343872, 0.5857385993003845, 0.6604901552200317,
           -2.80399227142334, 1.8308855295181274, 0.6626052856445312, -0.5612944960594177, 0.10556066036224365,
           -2.064126968383789, -1.4787242412567139, -0.8490373492240906, 0.8581210374832153, -1.008223295211792,
           0.7238296270370483, -0.9897273182868958, 0.1913912296295166, 0.7523174285888672, 0.013059151358902454,
           0.6059198379516602, 1.8846129179000854, -0.45044779777526855, -0.6865564584732056, -0.34161505103111267,
           -1.271454095840454, 1.1762378215789795, -0.85194331407547, -2.1398043632507324, 1.2414872646331787,
           0.0984267070889473, 1.5288509130477905, -0.14967221021652222, -0.008304502815008163, 0.013287653215229511,
           0.6552754640579224, -0.809376060962677, -1.3914724588394165, -0.5824381113052368, -0.19395935535430908,
           1.138168215751648, 1.1964491605758667, -0.5541133880615234, -0.6440334320068359, 0.14092284440994263,
           0.3498993217945099, -1.9647276401519775, 0.7091295123100281, -0.503693699836731, 0.44372954964637756,
           -0.310822457075119, 1.070674180984497, 0.05223042145371437, 0.35237154364585876, 0.9753732085227966,
           2.1295998096466064, -0.2714187800884247, 0.4134037494659424, 0.8642150163650513, -0.6176261305809021,
           -0.6874037981033325, 0.2532329857349396, 0.6455241441726685, 0.9678040146827698, 0.6065128445625305,
           -0.29974597692489624, 1.236177682876587, -0.30413079261779785, -1.3285000324249268, 1.2672256231307983,
           0.09095074236392975, 1.054458498954773, -0.889154851436615, -0.25678008794784546, -0.4889123737812042,
           1.644700050354004, -0.31983575224876404, -1.548443078994751, 0.3880256712436676, 0.025963041931390762,
           -0.17716212570667267, 0.11317113041877747, 1.3235284090042114, -1.954190969467163, 2.1553080081939697,
           -0.05780846253037453, 1.8135179281234741, -0.17497962713241577, 0.4148270785808563, -0.009481387212872505,
           -0.795037567615509, -0.10955821722745895, 1.6228007078170776, 0.47584083676338196, -1.517309546470642,
           0.32448914647102356, -0.5273138284683228, -0.5192810297012329, -1.6600803136825562, 0.8682699203491211,
           -0.18012171983718872, -0.994683027267456, -1.636345386505127, -0.2274448573589325, -1.0026360750198364,
           0.2408711314201355, -1.06119704246521, -0.9285728335380554, 1.1279361248016357, 2.6300158500671387,
           0.029013194143772125, -0.654302179813385, 1.0718621015548706, 0.3660690188407898, 0.7295839190483093,
           -0.062402836978435516, 1.3205643892288208, -0.45503416657447815};
      uint32_t vb[] = {2795605920u, 1949964146u, 4119667025u, 2847752398u};
      size_t l = 128;
      REQUIRE(
          dot_prod_cb_enc<float /* 32 */, float /* 32 */, uint32_t>(va, vb, l) == Approx(-18.4109069221).epsilon(0.01));
    }
    {
      float va[] =
          {1.0847065448760986, -0.29714328050613403, -0.7769732475280762, 0.9891706109046936, 1.8276461362838745,
           -0.49829670786857605, 0.24261131882667542, 0.20923158526420593, 1.7447376251220703, -0.14360037446022034,
           -0.9889018535614014, 1.5440452098846436, 0.09387844055891037, 0.02451501600444317, -0.11342310160398483,
           1.3756239414215088, 0.10166382044553757, -1.0149394273757935, 0.732082188129425, -0.9717156887054443,
           -0.9411123991012573, 1.6429204940795898, -0.8686501979827881, -0.8159244656562805, 0.33323726058006287,
           1.285200834274292, -1.0467885732650757, -1.6886060237884521, 0.5144856572151184, 0.44591742753982544,
           0.21269555389881134, 0.08689950406551361, 2.53739595413208, -0.6971738934516907, -0.6315047144889832,
           0.008382422849535942, 0.34754228591918945, 1.1635242700576782, 0.04037918522953987, 0.1875169426202774,
           0.5916091203689575, -0.5965589284896851, -1.153848648071289, -0.35699647665023804, 2.2928290367126465,
           1.2053757905960083, -0.5584262609481812, 0.22095899283885956, -0.6220638155937195, 0.5167534947395325,
           -1.2844657897949219, -1.8643232583999634, -0.03215312957763672, 0.14244404435157776, 1.6630358695983887,
           1.1217572689056396, 0.11843884736299515, -0.9397937059402466, 0.13838806748390198, 0.06256233900785446,
           1.0008974075317383, 1.6356643438339233, -0.4704050123691559, -0.35966846346855164, 0.8396197557449341,
           -0.6423702239990234, -0.8146369457244873, -1.299937129020691, -0.4297773838043213, -1.8524236679077148,
           -0.05302947387099266, -0.39216312766075134, -0.15451757609844208, -0.03642347827553749, 0.6097534894943237,
           0.2919889986515045, 0.3703088164329529, 0.3274102509021759, 0.2286355048418045, 0.07400721311569214,
           1.0891441106796265, -2.0292651653289795, -0.7402058243751526, 0.04231737181544304, -0.25835761427879333,
           1.6525793075561523, 0.21916359663009644, -1.0391522645950317, -0.7194941639900208, 0.2914564907550812,
           0.04179538041353226, 1.6927464008331299, -1.0912964344024658, 0.37734439969062805, -0.0062551540322601795,
           -1.131716251373291, -1.9960147142410278, -1.0988552570343018, 0.3892495334148407, 0.24190305173397064,
           0.06226937472820282, 0.00861708726733923, 0.5875407457351685, -1.4768521785736084, 0.5197526216506958,
           -1.2200627326965332, 1.1916182041168213, 2.0416953563690186, -0.012112508527934551, -0.8700406551361084,
           -0.3830234408378601, -1.1756001710891724, 2.3281490802764893, 1.1578913927078247, -0.46718838810920715,
           -1.1294071674346924, 0.43570807576179504, -0.8282817602157593, 1.8429819345474243, 0.9288715124130249,
           0.664204478263855, -1.741607904434204, 1.31541907787323, -1.514916181564331, -1.072642207145691,
           -0.5135305523872375, 0.34555843472480774, 0.3631191849708557};
      uint32_t vb[] = {2682412345u, 17157496u, 3561330913u, 227733382u};
      size_t l = 128;
      REQUIRE(
          dot_prod_cb_enc<float /* 32 */, float /* 32 */, uint32_t>(va, vb, l) == Approx(8.97226131195).epsilon(0.01));
    }
    {
      float va[] =
          {0.8116756081581116, -1.1109992265701294, 1.2713744640350342, -0.039597030729055405, -0.44717392325401306,
           0.588719367980957, -0.6357454657554626, -0.2503443658351898, -0.5968795418739319, -0.4134269952774048,
           -0.06234462559223175, 0.9476044178009033, 0.4841296374797821, 1.1051201820373535, -1.100154161453247,
           -1.1705890893936157, 0.41118356585502625, 1.2711488008499146, -1.1403210163116455, -1.3075289726257324,
           -1.4985113143920898, 0.71404629945755, -0.030322276055812836, 1.2931996583938599, 0.21580545604228973,
           -1.380129337310791, -0.09182319790124893, 0.16138900816440582, 0.049990735948085785, 0.593652606010437,
           -0.8379119634628296, -1.0786681175231934, 1.063757300376892, 0.4228447377681732, 0.2792183458805084,
           -0.6807141900062561, -1.279196858406067, -0.8349387049674988, -0.48419374227523804, 2.205012083053589,
           -0.28660276532173157, 1.3876519203186035, -0.7691366672515869, -0.17896297574043274, -0.422393262386322,
           0.4545685648918152, -0.5787263512611389, 0.7570905685424805, -1.7917027473449707, 0.03211711719632149,
           0.7587401866912842, 1.6247656345367432, 0.08330942690372467, -2.0925285816192627, 0.47456738352775574,
           0.6558343172073364, -0.8787935972213745, -0.2242356240749359, 1.2917242050170898, -0.2882404923439026,
           0.5059309601783752, -0.8874126076698303, 0.4737498462200165, -1.6476069688796997, -1.2400320768356323,
           -0.08006546646356583, 0.6346045732498169, 0.17577923834323883, 2.266974925994873, -0.3501737713813782,
           0.31678566336631775, 0.9535654783248901, 0.27530592679977417, 0.15170660614967346, -0.27147427201271057,
           -0.49281400442123413, -0.11577767878770828, 0.538817822933197, 0.7308645844459534, 0.02832684852182865,
           0.019493674859404564, 0.7022799849510193, 1.469530701637268, -1.201496958732605, -0.419754296541214,
           -0.605281412601471, 0.4970243275165558, -0.25299960374832153, -0.24842502176761627, -1.1133657693862915,
           0.7014535069465637, -0.02439207024872303, 0.12509532272815704, -0.29616865515708923, 0.5907848477363586,
           -0.7589552998542786, 1.4519479274749756, 0.9316824674606323, -1.4003167152404785, 1.5050806999206543,
           -1.2017767429351807, -0.12680862843990326, -0.22892478108406067, -1.2007684707641602, 1.2753289937973022,
           -0.3238770365715027, -0.7156834602355957, -0.289593905210495, -0.3342840075492859, -0.5155128240585327,
           -0.13338488340377808, -0.5582968592643738, -1.2966080904006958, -1.3396515846252441, -0.7620463371276855,
           -0.45614710450172424, 0.06949125975370407, -0.6101941466331482, 0.27863770723342896, 1.0241997241973877,
           0.6200863718986511, 1.042192816734314, -0.15542015433311462, -0.7991394996643066, -0.7680040001869202,
           -0.5042136311531067, 0.5606683492660522, -0.4382259249687195};
      uint32_t vb[] = {3947931648u, 2576407681u, 1326874344u, 1275647155u};
      size_t l = 128;
      REQUIRE(
          dot_prod_cb_enc<float /* 32 */, float /* 32 */, uint32_t>(va, vb, l) == Approx(-6.65298975818).epsilon(0.01));
    }
    {
      float va[] =
          {0.2838062644004822, -1.4784951210021973, 0.38446247577667236, -0.8019546866416931, -0.47523972392082214,
           -0.0980130136013031, 0.3712519705295563, -1.29645836353302, -1.1642787456512451, -0.43550267815589905,
           -0.3819824457168579, 1.0845130681991577, -1.2532744407653809, -0.49401116371154785, 0.047535818070173264,
           0.3103713095188141, -1.1741231679916382, 1.256470799446106, -0.6422004699707031, 1.979235053062439,
           -0.7713613510131836, 0.20813284814357758, 0.8279327154159546, -0.47804000973701477, 2.1119658946990967,
           -0.12699005007743835, -2.116718053817749, -0.03666453808546066, -0.3333422541618347, 0.03350265696644783,
           0.07261396944522858, -0.0487712062895298, 0.3226681053638458, 0.7242492437362671, -0.24446600675582886,
           1.3047195672988892, 0.7732535004615784, -2.3182408809661865, -1.3833158016204834, -0.6006073951721191,
           0.3884560465812683, -0.12470640242099762, -0.9724177718162537, 0.06838136911392212, 1.0996464490890503,
           1.0447046756744385, -0.6287193894386292, 0.45975303649902344, 2.7070651054382324, -0.2176542729139328,
           0.1599218249320984, -0.4748731553554535, -1.8283510208129883, 0.546983003616333, -0.12879544496536255,
           0.5763228535652161, -1.6646080017089844, 0.5101830959320068, -0.23710903525352478, -1.0114696025848389,
           -0.5629701614379883, 0.0008678729645907879, -0.46991515159606934, 1.5385980606079102, -2.348189115524292,
           -1.1738576889038086, -0.16590258479118347, -2.386831283569336, 1.1150304079055786, -0.5891202092170715,
           0.05693582445383072, -0.6006075739860535, -1.3767893314361572, 1.0911753177642822, 0.8432326912879944,
           0.15226449072360992, -0.918991208076477, -0.07764139026403427, 0.9333711862564087, 0.467906653881073,
           0.4704720079898834, -0.629005491733551, -0.15523187816143036, 0.6926366090774536, 0.9352046251296997,
           0.15573319792747498, -0.23068328201770782, -2.550220489501953, -0.0032996097579598427, -0.9852979183197021,
           0.0100282346829772, 0.13687430322170258, 1.2402749061584473, -0.11668146401643753, 0.012190593406558037,
           0.09640684723854065, -0.172073632478714, -0.7304257750511169, -0.5030316710472107, -0.11119242757558823,
           -0.9109860062599182, -0.7289689183235168, 0.4603951871395111, -0.906028687953949, 0.13041925430297852,
           -1.8522212505340576, -1.033983826637268, -1.4553076028823853, -0.34471529722213745, -0.279167115688324,
           -0.5371893048286438, 0.04391205683350563, 0.11978442966938019, 0.3388271927833557, -1.8045990467071533,
           0.27482256293296814, 0.7479100823402405, 1.4489808082580566, 0.5042632222175598, -1.9539635181427002,
           0.8237465023994446, -1.255743384361267, -0.6273460984230042, -0.5201919078826904, -0.612050473690033,
           -0.13687564432621002, -1.6264010667800903, -1.1589351892471313};
      uint32_t vb[] = {2469906287u, 2192277151u, 887185490u, 375421525u};
      size_t l = 128;
      REQUIRE(
          dot_prod_cb_enc<float /* 32 */, float /* 32 */, uint32_t>(va, vb, l) == Approx(-9.64647419052).epsilon(0.01));
    }
  }

  SECTION("float dot_prod_cb_enc(const float*, const uint32_t*, size_t), dim=256") {
    {
      float va[] =
          {-0.5863229632377625, -1.5882971286773682, -0.7342769503593445, -2.0337135791778564, 0.5599032044410706,
           -0.6742669343948364, 0.0848255380988121, 0.19305308163166046, 1.6179176568984985, -1.7557469606399536,
           1.0006738901138306, -1.62350332736969, 0.8441118597984314, -1.5709900856018066, -0.4481513202190399,
           -0.7394475936889648, -0.36277639865875244, 0.010572988539934158, 0.6494655609130859, -1.431022047996521,
           -0.22077904641628265, 0.20761477947235107, -1.664476990699768, 1.5340648889541626, -1.8922626972198486,
           -0.35330113768577576, 0.38778138160705566, 0.022193536162376404, 1.9672083854675293, 0.6013628244400024,
           -0.07713013142347336, 1.9284117221832275, 0.040349993854761124, -1.6549642086029053, 0.5936973094940186,
           -0.5932142734527588, 0.04107420891523361, 0.2687498927116394, -0.6368778347969055, -0.8483911752700806,
           0.6188820600509644, 0.8150423765182495, -0.6245004534721375, 0.7502728700637817, 0.2676142454147339,
           -0.2587544620037079, 0.897717297077179, -1.0919042825698853, 0.1358090490102768, 1.845594048500061,
           1.7750184535980225, -0.43588918447494507, -1.1442252397537231, 0.35640719532966614, 0.3196585178375244,
           0.9414429664611816, -1.2631512880325317, 1.313393473625183, 0.345806747674942, 1.3255248069763184,
           1.5377014875411987, -0.7338196635246277, -0.26061752438545227, 1.3264199495315552, -0.45502111315727234,
           -1.091454267501831, -0.5335254669189453, -0.08439366519451141, -2.2584564685821533, -0.3500882387161255,
           0.254858136177063, -0.0930723175406456, 0.017941709607839584, -0.02200246788561344, 1.3865351676940918,
           -1.7128912210464478, -1.0251504182815552, 1.2951982021331787, 0.4623602032661438, -0.39138856530189514,
           -0.29292038083076477, -1.700381875038147, -0.6369978785514832, -0.06721572577953339, -0.4189198613166809,
           -0.7892627120018005, 0.7540776133537292, 0.551417887210846, 1.0959734916687012, -0.9971147775650024,
           -1.3163361549377441, -0.960532546043396, -1.1590335369110107, 0.9621801972389221, -0.13204093277454376,
           0.27893608808517456, -2.017418146133423, -1.6258307695388794, -0.1982191503047943, -0.6311177015304565,
           -0.19958674907684326, -0.599147617816925, 1.7851637601852417, -0.25426405668258667, 0.4039045572280884,
           0.66636723279953, -0.34583142399787903, -0.5170904397964478, -0.1969195008277893, 0.4212833642959595,
           -0.54410719871521, 0.9997555017471313, -0.2828972041606903, -0.9103460311889648, 0.9836125373840332,
           1.1382241249084473, 0.9273074865341187, 0.8620418310165405, 0.2413499504327774, 0.8905025124549866,
           -0.05606361851096153, 1.4773668050765991, -0.3439115583896637, -1.4710482358932495, 0.6833253502845764,
           -2.5861918926239014, 0.8514540791511536, -0.3458020091056824, -1.005409598350525, 0.9744350910186768,
           1.3666805028915405, -1.1245367527008057, 0.3171063959598541, 0.341385155916214, -0.616827666759491,
           -2.089486598968506, -0.9437687397003174, 1.6573777198791504, -0.7051003575325012, 1.116520643234253,
           -0.968695342540741, -1.3052031993865967, 0.7394840121269226, -0.220256507396698, 0.522575855255127,
           0.30219337344169617, -0.6035295128822327, -0.8264554142951965, 1.1896270513534546, -0.833621621131897,
           -0.6736318469047546, -0.3390875458717346, -1.197628140449524, -1.0757629871368408, 0.2702116370201111,
           -0.2937440574169159, 0.191920667886734, 1.2619611024856567, -0.5934105515480042, 0.7542614340782166,
           -0.09045352786779404, 0.6943359971046448, 0.09569457918405533, 0.01663237065076828, 0.9286993145942688,
           -0.3418881297111511, -1.1441038846969604, 1.4794265031814575, 0.8869433999061584, -0.003457004902884364,
           1.2909996509552002, 0.8835062384605408, 0.25569525361061096, 1.5757094621658325, 1.1753346920013428,
           1.3795017004013062, -1.1430613994598389, -1.8971030712127686, -0.1599542647600174, 0.5059270262718201,
           0.5483922362327576, 0.002576043363660574, -0.1432875692844391, -0.7531465888023376, -0.8474323749542236,
           0.5135191679000854, -0.5126591920852661, 0.01935841329395771, -1.000002145767212, 1.1033415794372559,
           -1.5148862600326538, 0.7058066129684448, 0.8442462682723999, -2.376985549926758, 0.2071545422077179,
           -1.0573261976242065, 0.12488049268722534, 0.6723362803459167, 1.0946074724197388, -1.389164924621582,
           -0.6827841997146606, -1.3115692138671875, -0.5781159400939941, -1.3095264434814453, 0.34229788184165955,
           -0.17698566615581512, 0.12001385539770126, -0.3494319021701813, -0.2778684198856354, -0.12209052592515945,
           -0.531396746635437, 0.4040757417678833, -2.9958949089050293, -0.08148607611656189, -0.5667230486869812,
           -0.51041179895401, 1.5204411745071411, 1.0531995296478271, 0.7603699564933777, 0.12198532372713089,
           -0.26931899785995483, -0.0281972736120224, 2.1494619846343994, -0.26747044920921326, 0.4286620616912842,
           -0.7410561442375183, 0.8955785036087036, 1.5782811641693115, 0.14864613115787506, -0.42815569043159485,
           0.477877140045166, -0.5385567545890808, -1.0259203910827637, 0.11751013994216919, -1.7390741109848022,
           1.4822447299957275, 0.10060315579175949, 1.5564287900924683, -0.7648424506187439, 1.8745813369750977,
           1.1075643301010132, -1.5214523077011108, -0.4675862193107605, 1.0482290983200073, 1.488761305809021,
           0.36407339572906494, -0.10628198832273483, 0.03295562043786049, 0.4676840007305145, -0.5451699495315552,
           -0.008025042712688446, -1.1829967498779297, 0.9103025197982788, 0.16062678396701813, 0.31226491928100586,
           -0.4072374403476715};
      uint32_t vb[] =
          {1374431047u, 1167613967u, 2273343331u, 1138030891u, 3081918533u, 243875500u, 4279584954u, 2582044480u};
      size_t l = 256;
      REQUIRE(
          dot_prod_cb_enc<float /* 32 */, float /* 32 */, uint32_t>(va, vb, l) == Approx(17.5744414965).epsilon(0.01));
    }
    {
      float va[] = {0.32178911566734314, 0.70819091796875, -0.735564112663269, 0.3998103737831116, 1.271429181098938,
                    1.2977946996688843, 1.6024160385131836, 0.1703513264656067, -1.3186514377593994, 1.1557221412658691,
                    -0.21458882093429565, -0.011258955113589764, -1.534501314163208, 0.7153664827346802,
                    -3.097691774368286, 0.46849364042282104, -0.25378522276878357, -0.030081376433372498,
                    0.7887567281723022, 1.088168740272522, -2.2729272842407227, 0.2432073950767517, 0.6953850984573364,
                    -0.9524236917495728, -0.7507994174957275, -0.7804784774780273, 1.5567536354064941,
                    0.6158187389373779, 0.30377301573753357, -2.084730863571167, -0.25109049677848816,
                    0.6643261313438416, -1.0386096239089966, 0.9459466338157654, -1.0082274675369263,
                    1.2943400144577026, -0.5007404685020447, -0.47367075085639954, -0.1389293372631073,
                    -2.546546220779419, -3.1325366497039795, 0.02744552306830883, 0.8620198369026184,
                    -0.17014646530151367, 0.6980168223381042, 0.7657046318054199, 0.03924666345119476,
                    -0.14549505710601807, -2.5724966526031494, 0.13364586234092712, 0.16042472422122955,
                    0.20508067309856415, 0.7953193783760071, 1.3251971006393433, -1.2657824754714966,
                    -1.5505179166793823, -0.4927563965320587, 0.5656291246414185, -1.65325129032135, 0.6647503972053528,
                    -1.6767072677612305, 1.2576643228530884, 0.9672114849090576, -2.567335844039917, 0.4861813485622406,
                    -1.7917838096618652, 0.5478607416152954, -1.1283215284347534, -0.010679548606276512,
                    -1.1002528667449951, -1.4089304208755493, -1.2865242958068848, 0.4924662411212921,
                    0.3341091275215149, 1.6038668155670166, -0.6288037300109863, -0.01771140657365322,
                    -0.029891612008213997, -0.267909437417984, 0.6811299920082092, 0.33174410462379456,
                    -0.09083833545446396, 0.25896087288856506, -0.0713697075843811, -0.3336673974990845,
                    1.078597068786621, 0.1676989495754242, 1.5270134210586548, -1.3108009099960327, -1.3087772130966187,
                    -0.6710302233695984, -1.6845605373382568, 0.5259919166564941, -1.6044597625732422,
                    0.7204900979995728, -0.4207141101360321, 0.2731133997440338, 1.3400015830993652,
                    -1.5784573554992676, 0.4922108054161072, 1.8948382139205933, 0.42786192893981934,
                    0.46220865845680237, 1.1113094091415405, 1.174203872680664, 0.5424007773399353, 0.2687146067619324,
                    1.9364261627197266, -0.6451562643051147, -0.6425113081932068, 0.28889137506484985,
                    0.048137057572603226, -0.30619925260543823, 1.4280495643615723, 0.8227588534355164,
                    1.642214059829712, -0.05802163481712341, -0.13833220303058624, -1.0221960544586182,
                    0.11223547160625458, -0.6022641062736511, -1.5666077136993408, -0.7012324333190918,
                    0.3118228316307068, 2.3093421459198, -2.8427658081054688, 1.7302944660186768, -0.8101067543029785,
                    -0.5106362104415894, -1.3741651773452759, 0.7840607762336731, 0.4461042582988739,
                    -0.5224422216415405, -0.07579155266284943, -0.08637674152851105, -1.1022045612335205,
                    0.8220512270927429, 0.162267804145813, -1.355877161026001, -0.9708423018455505, 0.39928895235061646,
                    -0.6194162368774414, 0.6003149151802063, -0.06424575299024582, 1.4244270324707031,
                    -1.5701909065246582, 0.3685491383075714, -0.5350053310394287, -0.5128931999206543,
                    -1.0081521272659302, -0.9333019852638245, -0.3168067932128906, -1.838931918144226,
                    -0.449387788772583, -1.3807847499847412, -0.6346078515052795, -0.6020789742469788,
                    2.4858853816986084, -1.6975082159042358, -1.4560108184814453, -0.02330855093896389,
                    0.5803991556167603, 0.14585301280021667, -0.801169216632843, 0.7711830139160156,
                    -0.03132499009370804, -0.11347373574972153, -1.1948461532592773, -0.7401406764984131,
                    0.49754223227500916, 0.44649285078048706, 0.21438325941562653, -1.6030161380767822,
                    0.45834609866142273, 0.15861919522285461, -0.7764189839363098, 0.1547582894563675,
                    0.9139220118522644, -0.3437405526638031, -1.3002912998199463, -0.5804913640022278,
                    -0.3364623785018921, 0.8741201162338257, 2.047696113586426, -0.1662527471780777, 0.2333747148513794,
                    -0.7197902202606201, -0.17493993043899536, 2.086106300354004, 0.7504127621650696, 0.700358510017395,
                    1.0974454879760742, -2.3937625885009766, 0.5277071595191956, -0.8126003742218018,
                    1.1219947338104248, -0.28717800974845886, -2.056370973587036, 0.19245083630084991,
                    0.5103264451026917, -1.887396216392517, 0.25174421072006226, 0.1725357323884964, 1.5014526844024658,
                    0.04274589940905571, -0.0709666907787323, 0.6931107640266418, 0.26659461855888367,
                    0.896075963973999, -1.528812050819397, 0.5747231841087341, 0.10358380526304245, -0.3586762547492981,
                    1.8796888589859009, -2.336834669113159, 0.7283443808555603, -1.4496177434921265, 1.6762146949768066,
                    0.5594156384468079, 0.6393848657608032, 0.5719801187515259, 1.6746748685836792, 1.0923802852630615,
                    1.002409815788269, 0.9662790894508362, 0.9218775629997253, 1.0783671140670776, 1.9377652406692505,
                    -1.2202109098434448, 0.9638833999633789, -0.8065692186355591, 0.38877934217453003,
                    0.8582863211631775, -1.6703617572784424, -0.9085838198661804, 2.2621188163757324,
                    -1.2510080337524414, -0.03907715156674385, 0.035841695964336395, 0.41629236936569214,
                    2.1803669929504395, 1.0771193504333496, 1.9444410800933838, -0.1982519030570984, 1.0179216861724854,
                    -0.020142411813139915, -0.8426428437232971, 0.45747774839401245, 0.9766230583190918,
                    0.8230769038200378, 0.15277281403541565, -2.163257360458374, -1.2112432718276978,
                    -1.1321806907653809, 0.259564071893692, 0.7145496010780334};
      uint32_t
          vb[] = {405240191u, 2701977719u, 3300971054u, 520361391u, 1857405261u, 2735083038u, 26915284u, 2664595947u};
      size_t l = 256;
      REQUIRE(
          dot_prod_cb_enc<float /* 32 */, float /* 32 */, uint32_t>(va, vb, l) == Approx(20.9305488085).epsilon(0.01));
    }
    {
      float va[] =
          {-0.10621096938848495, -0.3744957447052002, 0.24504375457763672, 1.7379086017608643, -0.5366466045379639,
           0.4611828029155731, -0.20504918694496155, 0.5257676243782043, -0.6701395511627197, 0.8853450417518616,
           -1.7661124467849731, 0.9531311988830566, 0.14745086431503296, 0.11952117830514908, 0.3043875992298126,
           0.5476656556129456, 0.49696508049964905, -0.5579918026924133, 1.3056559562683105, -0.5705429911613464,
           -0.7476860880851746, 0.31114035844802856, 0.20361268520355225, -0.6044805645942688, 0.8439277410507202,
           -0.9737437963485718, -0.2116708904504776, 0.02082712948322296, -0.5289379954338074, -1.914366602897644,
           -0.5253173112869263, 0.021586187183856964, 0.9102267026901245, -0.18211016058921814, 0.8604713082313538,
           -2.071432590484619, -1.5539313554763794, -0.09415163099765778, 0.3007715940475464, 0.17470501363277435,
           0.0148038100451231, -0.8012881875038147, -0.9392791986465454, 0.5629441738128662, -1.4467377662658691,
           1.7327553033828735, -0.5605202913284302, -1.410410761833191, 0.8025012016296387, -1.7019174098968506,
           0.46457627415657043, -0.888790488243103, -1.1076186895370483, 0.8377524614334106, -0.9486393928527832,
           1.086065411567688, 2.4968245029449463, 0.4682134687900543, -1.230839490890503, 0.27119553089141846,
           -0.3463827967643738, -0.94423508644104, -0.253867506980896, 0.8864057660102844, -0.4232398569583893,
           0.4644703269004822, 0.3663322627544403, -1.199654459953308, -1.42396080493927, -0.4617668092250824,
           -1.064177393913269, 0.39105990529060364, -0.7935311198234558, -0.7016265988349915, 1.076414704322815,
           -0.08132705837488174, 1.710251808166504, -0.016190750524401665, -0.4873608350753784, -0.4128148555755615,
           0.6566111445426941, 0.7621906995773315, -1.0368316173553467, 0.032270919531583786, -1.2232671976089478,
           -0.5422935485839844, 1.095649003982544, -0.756534218788147, 0.0983864963054657, 0.5140823125839233,
           0.4162083566188812, 0.8528764843940735, 0.929500937461853, -0.16956371068954468, 0.3775748610496521,
           -0.7539986968040466, 0.4103708863258362, -0.9138132929801941, -0.9843868613243103, 2.172927141189575,
           -0.2375410497188568, -1.0459187030792236, 0.15545779466629028, 0.009387664496898651, 0.11870118975639343,
           -0.45053020119667053, -0.8052991628646851, -0.0884283035993576, -1.2581582069396973, -1.138069748878479,
           1.7284542322158813, 0.4525568187236786, -1.0048952102661133, 1.326833963394165, -1.0677158832550049,
           0.30133408308029175, -0.36178359389305115, 1.5563881397247314, 0.3512599766254425, -0.5045838356018066,
           0.3741320073604584, 1.534774661064148, 0.175418421626091, -0.8731741905212402, -1.0646015405654907,
           -1.721897006034851, -1.0653526782989502, -0.2841697037220001, -0.6019508242607117, 0.03950417414307594,
           -0.35603296756744385, -0.1955089122056961, 0.3837936222553253, -1.3452177047729492, 0.2802852988243103,
           0.8588861227035522, -0.03649449720978737, -1.5437403917312622, -0.5531278252601624, 1.6497234106063843,
           -1.150582194328308, -1.0268816947937012, -0.7492146492004395, -1.2940200567245483, -1.082762360572815,
           -0.7799561023712158, -0.8126058578491211, 0.34150198101997375, 0.43687188625335693, 1.466268539428711,
           -0.2809130549430847, 0.43678298592567444, 0.37648487091064453, -1.5794233083724976, 0.007058825809508562,
           0.21194303035736084, 1.8688485622406006, -0.11203397065401077, -0.4839182198047638, 1.543308138847351,
           -0.07699313759803772, -0.8082190155982971, 1.8541253805160522, 1.3910105228424072, 0.2659817934036255,
           -0.3875058591365814, -0.6401512622833252, 0.5118220448493958, -1.6243376731872559, -1.0235387086868286,
           1.2018446922302246, 0.6508016586303711, 0.06406240165233612, -0.13190148770809174, 1.2345668077468872,
           0.5252001285552979, -0.17001818120479584, 0.6270065903663635, -0.6137192845344543, -0.10679338127374649,
           -0.03464387729763985, 1.646691083908081, 0.4447082281112671, -1.1966214179992676, 0.3147384226322174,
           1.2701263427734375, 1.0375807285308838, -0.523430585861206, -0.5580611228942871, -0.662158191204071,
           0.3659783601760864, -0.39158231019973755, -0.2510431408882141, -1.1841652393341064, -0.0008726910455152392,
           -0.19159014523029327, -1.1766082048416138, -0.5654624700546265, 1.2190310955047607, 2.7684969902038574,
           -2.345583438873291, -1.2692036628723145, -0.267915815114975, -1.0858917236328125, -0.42545080184936523,
           -0.48498183488845825, -1.0794036388397217, 1.2735735177993774, 0.5090047121047974, -0.260537713766098,
           1.7353404760360718, -0.47221940755844116, 0.007614500354975462, 1.7026164531707764, 0.9753756523132324,
           -1.2046481370925903, 0.355461448431015, -0.37242212891578674, 0.7034044861793518, 0.9935857653617859,
           -0.9651962518692017, 0.4465789198875427, -1.3213773965835571, -0.1820123791694641, -0.7625914812088013,
           1.8946887254714966, -0.5393139123916626, -2.959932327270508, -0.1628628522157669, -1.3586273193359375,
           1.5166847705841064, 0.9698545932769775, -1.2485263347625732, -0.3823826014995575, -0.22945894300937653,
           -1.1629420518875122, 0.13936501741409302, -0.11456785351037979, -0.5213830471038818, -0.6057531237602234,
           1.0343722105026245, -0.011359283700585365, 0.8294883966445923, 2.4603271484375, 0.8633520007133484,
           -1.0309507846832275, 0.5034458041191101, -1.9617080688476562, -0.7655411958694458, 0.5611361265182495,
           0.13420900702476501, 0.06346338242292404, -0.4400313198566437, 1.8117356300354004, 0.24627865850925446,
           0.2865416407585144};
      uint32_t vb[] =
          {1291747671u, 1359915642u, 1912701643u, 3987360114u, 3746005332u, 1118799300u, 2052770298u, 2726908830u};
      size_t l = 256;
      REQUIRE(
          dot_prod_cb_enc<float /* 32 */, float /* 32 */, uint32_t>(va, vb, l) == Approx(-30.2366442344).epsilon(0.01));
    }
    {
      float va[] =
          {-0.2632569670677185, 0.08306773006916046, 1.677295446395874, 1.5243427753448486, -1.3625422716140747,
           0.1379295289516449, -0.6082535982131958, 0.8993309736251831, 0.28535595536231995, 0.45069363713264465,
           0.6840368509292603, -0.6623603701591492, -0.4817616641521454, 1.085896372795105, -1.1233049631118774,
           0.48215994238853455, 1.1582218408584595, -0.19302715361118317, -0.571750819683075, 0.3758603036403656,
           0.6549895405769348, 0.03869692608714104, 0.12705986201763153, 1.1312648057937622, -1.0080230236053467,
           0.9994085431098938, 2.2359323501586914, -0.4567084312438965, -1.0528942346572876, -0.4477311372756958,
           0.37181127071380615, -0.2936357855796814, 1.177534818649292, -0.35620689392089844, -1.1170350313186646,
           1.9328546524047852, 0.9633864164352417, 1.0720313787460327, -1.8544659614562988, 2.1587798595428467,
           -1.7915716171264648, 0.7281603217124939, -1.2936705350875854, 1.4544756412506104, 0.9041163921356201,
           0.9774054884910583, -0.4575165808200836, 0.15818487107753754, 1.6852360963821411, -0.1924309879541397,
           0.4796057939529419, -0.3660098910331726, -0.5720945596694946, 1.0646657943725586, 0.12556114792823792,
           1.4805501699447632, -0.44624295830726624, -0.2554580867290497, -1.8105775117874146, 0.6010982394218445,
           0.2900892198085785, 0.13468137383460999, -2.106552839279175, 1.1165554523468018, -0.13290970027446747,
           -0.2422845959663391, -1.6892472505569458, 0.113847516477108, 0.7035998106002808, 0.5818209052085876,
           -0.15498900413513184, 0.972016453742981, 0.43400225043296814, -0.16106559336185455, -1.7398825883865356,
           1.8827182054519653, -0.10227895528078079, 1.1323034763336182, 0.8096423745155334, 1.456863522529602,
           0.6237356066703796, -0.7420869469642639, 0.5208515524864197, -1.9623830318450928, -1.125203013420105,
           -1.888250708580017, -0.2612159848213196, -0.7448102235794067, -0.5849494934082031, 2.3526461124420166,
           -0.15998336672782898, 0.5214217305183411, -0.05843253433704376, 1.784265398979187, -1.9072712659835815,
           -0.23191873729228973, -1.4610607624053955, 1.464320421218872, -0.07442360371351242, 0.03376861661672592,
           -0.1166844516992569, 1.4226810932159424, -0.042322345077991486, 0.18025024235248566, -1.1713883876800537,
           -0.38285160064697266, -0.39212527871131897, 1.7257884740829468, -2.447265625, 0.7686079144477844,
           -0.1092338114976883, 0.0757220983505249, -0.15789592266082764, 1.2086573839187622, 0.5218689441680908,
           0.7236741781234741, -0.8535696268081665, 1.4023747444152832, -0.08422666043043137, 0.5882831811904907,
           -1.2018914222717285, 0.07892997562885284, 1.6172374486923218, 0.15592102706432343, 0.6775309443473816,
           0.20832297205924988, 0.19020164012908936, -0.508987545967102, -1.122606873512268, -1.6841459274291992,
           1.0772706270217896, -0.4913178086280823, -0.6883636713027954, -0.783104419708252, 0.3085653781890869,
           0.3353714346885681, -1.191723108291626, 2.1583845615386963, 0.41103389859199524, 0.3766465187072754,
           -1.1633222103118896, 0.04707003012299538, 0.09964880347251892, -1.2990162372589111, -0.8344910144805908,
           0.9966939687728882, 0.05503762513399124, -0.9339169263839722, 0.9185503721237183, -0.8562114834785461,
           1.4460515975952148, -1.427406907081604, -0.6139423847198486, -0.5485047698020935, -0.7180820107460022,
           1.0708638429641724, 3.082963228225708, -1.78586745262146, 0.19957172870635986, 0.35514384508132935,
           0.020167386159300804, 1.005934715270996, 0.7435812950134277, 0.018628312274813652, 0.43544846773147583,
           0.40831005573272705, -0.1561269313097, 1.576853632926941, -1.6358120441436768, 0.01401061937212944,
           0.46271875500679016, -1.1078224182128906, 0.6371760368347168, 0.7108091115951538, -0.705064594745636,
           -0.8723692893981934, 0.856546938419342, -0.8093207478523254, 0.6924693584442139, -0.5503485798835754,
           -0.17412236332893372, -0.7422628402709961, 0.23501704633235931, -1.6814309358596802, -0.6840890049934387,
           -0.06926009804010391, -0.1299603432416916, 1.2362056970596313, 0.2050054967403412, -0.5216721296310425,
           -0.7944516539573669, 0.7445815801620483, 0.37038862705230713, 0.26618584990501404, -1.0329656600952148,
           2.7308361530303955, -0.659076452255249, -0.50194251537323, 1.0406290292739868, 1.1898572444915771,
           0.007218087092041969, -1.3978936672210693, 0.06244586408138275, -0.47257986664772034, 0.24153485894203186,
           0.7144547700881958, 0.5316378474235535, -0.5020161271095276, -2.279426336288452, 0.0859951302409172,
           -1.4822272062301636, -0.5854783654212952, 0.7122523188591003, 0.44066810607910156, 0.1425463706254959,
           -1.5200060606002808, -0.8693090677261353, 1.7584527730941772, 0.008828711695969105, 0.2784581780433655,
           1.4216605424880981, -3.0162534713745117, -1.1820553541183472, -1.595388650894165, 1.5351005792617798,
           2.069173812866211, 0.3938780426979065, -1.124741792678833, 1.8946853876113892, -2.2859628200531006,
           0.28686457872390747, 0.5029772520065308, -0.2219507098197937, 0.14818473160266876, -0.126511350274086,
           0.30622825026512146, -0.34619060158729553, 0.6754022240638733, -0.6599825024604797, -1.7162606716156006,
           0.14363016188144684, -0.030873948708176613, -3.0786383152008057, 0.4185466170310974, -1.8000818490982056,
           -0.4110768139362335, 0.41949301958084106, -1.7140798568725586, -0.6723344326019287, 0.36820024251937866,
           0.17891407012939453, -0.3454810678958893, 0.9761935472488403, -0.168502539396286, -0.8054289221763611,
           -0.3068266808986664};
      uint32_t
          vb[] = {3125570325u, 1653053522u, 2292362565u, 67599716u, 3940700595u, 403985845u, 3595326119u, 115632353u};
      size_t l = 256;
      REQUIRE(
          dot_prod_cb_enc<float /* 32 */, float /* 32 */, uint32_t>(va, vb, l) == Approx(-20.6993408976).epsilon(0.01));
    }
    {
      float va[] =
          {0.8531352877616882, -1.168851375579834, -1.669082522392273, 2.1912572383880615, -0.08945401012897491,
           0.19441089034080505, -0.9976553320884705, 0.9978808164596558, -0.1891094446182251, -1.1745706796646118,
           1.1845371723175049, 0.46690991520881653, -0.2901645302772522, 0.5283411145210266, -0.08418118208646774,
           -1.227860689163208, -1.5646352767944336, -1.627332091331482, 2.3071482181549072, 0.03369000554084778,
           -0.7170861959457397, -0.3079386055469513, -0.10508032888174057, 1.85280442237854, -0.4734310507774353,
           0.3244898021221161, 0.1247410923242569, -0.017784390598535538, -0.13602177798748016, 2.003795623779297,
           0.11838487535715103, 0.024363800883293152, 0.21567648649215698, 1.3792775869369507, 0.7627568244934082,
           0.43484196066856384, -0.3636152744293213, -0.27747049927711487, 0.0017936878139153123, 1.197288155555725,
           -2.0207080841064453, -1.424211859703064, 1.0312891006469727, 0.26907092332839966, 0.24464458227157593,
           -1.4490152597427368, 0.9772776961326599, -0.5483412742614746, -0.032175809144973755, -0.041916005313396454,
           -0.9806708097457886, 0.48088476061820984, -0.8795056939125061, 0.3821572959423065, -0.7652525305747986,
           -0.12007105350494385, 1.766621708869934, 0.13621221482753754, 1.7252496480941772, -2.360461950302124,
           0.61774742603302, -0.6193118095397949, 1.3188834190368652, 0.5185492634773254, -0.13781878352165222,
           0.8894245624542236, -1.4480944871902466, 0.06919331848621368, 1.4113667011260986, 0.7432790398597717,
           -0.08852073550224304, 0.3173779249191284, 2.2089290618896484, -0.5336236953735352, -0.7382767200469971,
           0.9020795822143555, -0.19602473080158234, -1.5728871822357178, -0.7735245227813721, 0.982257068157196,
           0.20679323375225067, -0.704082727432251, -0.5918028354644775, -1.5364344120025635, -0.0021650376729667187,
           -0.347788542509079, -1.1337755918502808, 1.6338363885879517, -0.14673276245594025, 0.7366535067558289,
           -1.198929786682129, -1.9350146055221558, 0.12024809420108795, -0.7060936689376831, -0.10493041574954987,
           0.491089791059494, -0.9707839488983154, -0.3825360834598541, 0.5601964592933655, 0.5819270610809326,
           -0.7231872081756592, 0.7974062561988831, 0.06404666602611542, -1.6444237232208252, -0.4920716881752014,
           0.4175412058830261, -0.4445602297782898, 1.4138931035995483, 0.06624051928520203, 0.5866488814353943,
           -0.9084926843643188, 0.9119137525558472, 1.2119172811508179, -0.4938523471355438, 0.6740625500679016,
           1.0373189449310303, -0.795971691608429, 0.056535277515649796, -0.038176994770765305, 0.2312099188566208,
           -2.554349660873413, -0.11212413012981415, -0.36298301815986633, -0.5977714657783508, -1.6660710573196411,
           -0.3265966475009918, -0.6073596477508545, 1.3052529096603394, -1.5403631925582886, 0.27265670895576477,
           0.7929306030273438, 0.47521722316741943, -1.529765009880066, -0.24919262528419495, 0.27045437693595886,
           -0.017753321677446365, 0.6003628373146057, -1.1269630193710327, -0.47892752289772034, -0.10402891784906387,
           -0.32579541206359863, -0.951378345489502, 0.29301220178604126, -0.6714963316917419, 0.23026414215564728,
           0.9269792437553406, 0.9695586562156677, 0.5905705094337463, -1.0601691007614136, 1.0406279563903809,
           -0.1526361107826233, 0.06990213692188263, 2.622274160385132, 0.0110273826867342, -0.1272796392440796,
           0.7317293882369995, 0.17495733499526978, 0.9299279451370239, -0.4019799828529358, -0.7603737115859985,
           0.16322121024131775, 0.2713952958583832, 0.46971744298934937, -1.185185432434082, 1.3187299966812134,
           -0.7600970268249512, -1.0212757587432861, 0.4353457987308502, 2.119499444961548, 0.2008141726255417,
           -0.3382771611213684, 0.4098438620567322, -0.6190580129623413, -1.0337762832641602, -0.1901373416185379,
           0.6759742498397827, -0.7872308492660522, -0.824647068977356, -0.6287215948104858, -1.1103483438491821,
           0.004303775727748871, -0.6340974569320679, -2.028949499130249, 1.968588948249817, 0.49620214104652405,
           -0.19846327602863312, -0.6424044370651245, 0.6330868005752563, 0.25013864040374756, 0.9750834107398987,
           0.930118203163147, -1.2538058757781982, 0.01865094155073166, 0.524364173412323, -0.2658255696296692,
           -0.0983426496386528, 2.0821990966796875, 1.986377239227295, -0.16638334095478058, 0.278043270111084,
           -0.025398844853043556, 0.8754045963287354, 0.10256121307611465, 0.6808252334594727, 0.20569156110286713,
           1.3569022417068481, -1.8716394901275635, 0.20712274312973022, -0.8285480737686157, -0.862549364566803,
           -0.43126824498176575, -0.02493954449892044, -1.356579065322876, 0.7849864959716797, -0.8856061100959778,
           -1.373986840248108, 0.3869999647140503, 0.271737277507782, -0.8917790055274963, 0.3704497516155243,
           1.6061421632766724, -0.759841799736023, 0.09274468570947647, -0.23998460173606873, 1.0382654666900635,
           1.2125061750411987, 0.6991152763366699, -0.5273007154464722, 1.4288759231567383, 0.46317803859710693,
           1.2330363988876343, 0.8844238519668579, -0.7392174005508423, 1.4544787406921387, -0.42710253596305847,
           1.390782117843628, 0.02788248285651207, -1.1144284009933472, -1.0863869190216064, 1.4328994750976562,
           -1.6517996788024902, -1.2217202186584473, -0.8089738488197327, -1.8488428592681885, 2.200338125228882,
           0.41752344369888306, -1.5355708599090576, -0.4387257695198059, 0.3825729787349701, 0.8907514214515686,
           0.9591548442840576, -0.5039389133453369, -0.4843308925628662, 0.45945289731025696, 0.18263906240463257,
           -1.3049976825714111};
      uint32_t
          vb[] = {3803985050u, 1227355490u, 1838621563u, 725053079u, 3734535909u, 2730162315u, 913492994u, 1184912884u};
      size_t l = 256;
      REQUIRE(
          dot_prod_cb_enc<float /* 32 */, float /* 32 */, uint32_t>(va, vb, l) == Approx(7.64597601991).epsilon(0.01));
    }
  }

  SECTION("float dot_prod_cb_enc(const float*, const uint32_t*, size_t), dim=60") {
    {
      float va[] =
          {-0.5330921411514282, 0.5437424182891846, -0.4165688753128052, 1.2617498636245728, -1.0208650827407837,
           -0.34049808979034424, -1.514129400253296, -2.974543571472168, 0.6366413831710815, -0.4655555486679077,
           1.2542840242385864, -2.243042230606079, 1.290395736694336, -0.5367324948310852, 1.9768407344818115,
           1.2313432693481445, -0.143622487783432, -0.02821497805416584, 0.6209408044815063, -2.0987045764923096,
           -0.5971742868423462, 1.459529995918274, 0.12424387037754059, 0.81728595495224, -0.4046781659126282,
           -1.1442489624023438, -2.3991777896881104, -0.1525285392999649, 0.10540124028921127, -0.07056063413619995,
           0.706188976764679, 0.9635664224624634, -1.709041714668274, -2.383751630783081, 0.8958412408828735,
           -0.09132222086191177, 0.06652748584747314, -0.9313287734985352, -2.0408201217651367, 1.9321948289871216,
           -0.6664313077926636, 1.3409559726715088, 1.23336923122406, -1.4604716300964355, 0.684432327747345,
           -1.2823543548583984, 0.3603888154029846, 0.9267708659172058, 0.09444363415241241, -0.09296875447034836,
           1.1339844465255737, 2.1025338172912598, -0.49926847219467163, 0.500669538974762, -0.6344728469848633,
           0.19312778115272522, 1.2347426414489746, 0.928463339805603, 0.7972068786621094, -0.6070388555526733};
      uint32_t vb[] = {233604555u, 75012272u};
      size_t l = 60;
      REQUIRE(
          dot_prod_cb_enc<float /* 32 */, float /* 32 */, uint32_t>(va, vb, l) == Approx(-4.17970777117).epsilon(0.01));
    }
    {
      float va[] = {-1.210968017578125, -0.1440928876399994, -2.3486340045928955, 1.5978760719299316, 1.265156865119934,
                    -0.24202503263950348, 2.0825226306915283, 0.8953256607055664, 1.193824052810669,
                    -0.6400551199913025, 1.1029715538024902, 0.04288306087255478, -0.3843570053577423,
                    0.3136962056159973, 0.815484344959259, 2.335503578186035, -1.145251989364624, -0.23332543671131134,
                    -0.7593850493431091, -0.7109693884849548, -0.8754521608352661, -0.5466523766517639,
                    -0.5243000984191895, -0.18468670547008514, 1.442196249961853, -0.8959143757820129,
                    -0.7552903294563293, 0.06787322461605072, -1.966194748878479, 0.4908997118473053, 1.573588490486145,
                    -0.04419281706213951, 0.45428696274757385, -0.6612504124641418, -0.30306994915008545,
                    -0.3695482611656189, 0.7900890707969666, 0.8949053883552551, -1.1146986484527588,
                    0.08191300928592682, -0.9289942979812622, 4.050822734832764, -0.34316113591194153,
                    -0.5482982397079468, -2.4640212059020996, 1.907261848449707, -0.1437007188796997, 1.445878505706787,
                    -0.25960245728492737, 1.835456371307373, 0.06395233422517776, -0.5016013383865356,
                    0.5731834769248962, -0.36028388142585754, -3.6556358337402344, -0.5725488066673279,
                    0.6799907684326172, 0.29598283767700195, 0.7748379707336426, -0.1696643829345703};
      uint32_t vb[] = {3511109519u, 109358374u};
      size_t l = 60;
      REQUIRE(
          dot_prod_cb_enc<float /* 32 */, float /* 32 */, uint32_t>(va, vb, l) == Approx(4.39628248289).epsilon(0.01));
    }
    {
      float va[] =
          {-1.5217849016189575, -1.3009400367736816, -1.5641016960144043, 1.0788720846176147, 2.5156567096710205,
           0.5063081979751587, -1.7647631168365479, 0.9298470616340637, -0.6148372888565063, 0.10167856514453888,
           -0.3591976463794708, -0.38695409893989563, 0.26582881808280945, -0.9745956063270569, 0.8464171886444092,
           -0.6668297052383423, 0.3919299840927124, 0.43163660168647766, 0.10727284848690033, -0.3964793086051941,
           -1.5047093629837036, 1.731048583984375, -1.2779406309127808, 0.7841566801071167, 0.6025773882865906,
           -0.43944457173347473, 0.5283722877502441, -1.282052993774414, 1.2702269554138184, -1.6740074157714844,
           -0.26963475346565247, 1.558666706085205, 0.6359844207763672, -1.1648738384246826, 0.45752301812171936,
           0.43143850564956665, 0.1492927223443985, 1.4020299911499023, 0.09836973994970322, -0.006075648125261068,
           0.983733057975769, 0.17839904129505157, 0.08436714857816696, 0.9529972672462463, 0.3828343152999878,
           0.18310336768627167, -0.17207886278629303, -2.673304557800293, 0.3203965723514557, 0.3818172216415405,
           1.0415949821472168, -2.039294958114624, 0.37420108914375305, 1.037909746170044, 1.1235852241516113,
           1.671316146850586, 0.3444841206073761, -0.6027280688285828, -0.7799139618873596, 0.8598352670669556};
      uint32_t vb[] = {2711173129u, 55734680u};
      size_t l = 60;
      REQUIRE(
          dot_prod_cb_enc<float /* 32 */, float /* 32 */, uint32_t>(va, vb, l) == Approx(-8.24145582085).epsilon(0.01));
    }
    {
      float va[] =
          {0.3015207350254059, -0.45786887407302856, -0.5634327530860901, -1.1755783557891846, -1.4772143363952637,
           0.22666437923908234, -0.007765217684209347, -1.8978235721588135, 0.5825728178024292, 0.8440811038017273,
           -1.6093758344650269, -1.2759158611297607, -1.6293104887008667, -0.2907944619655609, 0.395354688167572,
           2.1450562477111816, -2.223938465118408, 1.4536746740341187, -0.16763952374458313, 0.31975802779197693,
           0.6205230355262756, 0.08878748118877411, 0.06021794304251671, 0.9942644238471985, 0.23304562270641327,
           -0.6704683303833008, 1.3889708518981934, 0.6649762988090515, -1.0353509187698364, 0.4505872130393982,
           0.11348038166761398, -0.16927975416183472, -0.3014881908893585, 1.1810641288757324, -0.502251386642456,
           0.751464307308197, 0.16115863621234894, 1.4203274250030518, -0.7064366340637207, 0.5715569853782654,
           -0.9404436349868774, -0.056656233966350555, -0.3942645192146301, -0.2863612174987793, 1.9205353260040283,
           0.6879910230636597, -0.21391066908836365, -0.48608604073524475, 0.3144055902957916, 1.4123071432113647,
           1.53014075756073, -0.7425631284713745, -1.3139855861663818, 0.34052959084510803, 0.5863886475563049,
           0.9212777614593506, 0.38013193011283875, -1.326758623123169, -0.6286463737487793, -0.9272328615188599};
      uint32_t vb[] = {3001943217u, 57756627u};
      size_t l = 60;
      REQUIRE(
          dot_prod_cb_enc<float /* 32 */, float /* 32 */, uint32_t>(va, vb, l) == Approx(1.38400464226).epsilon(0.01));
    }
    {
      float va[] =
          {0.6553124189376831, -0.005382513627409935, -0.48460647463798523, -0.7864704132080078, 0.5757056474685669,
           1.227831482887268, -0.21247021853923798, -0.5525078177452087, 0.1421130895614624, 0.854434072971344,
           0.33429256081581116, -0.6512699127197266, -0.7960764169692993, -0.0480705127120018, 0.9397915601730347,
           0.6589366793632507, -0.7185739278793335, 0.8717671036720276, -0.38506630063056946, 0.06143658235669136,
           -0.004351436160504818, -0.5905193090438843, 1.0631659030914307, -1.000974178314209, 1.024520754814148,
           0.8893530964851379, -0.8268871307373047, -0.9100298285484314, -0.9357351064682007, 0.08686061948537827,
           -0.20980603992938995, 1.0525259971618652, 0.010937320999801159, 0.14855198562145233, -0.03294150531291962,
           0.7724457383155823, -0.4182327389717102, -0.6162782311439514, 1.316980004310608, -0.24317757785320282,
           -0.27324822545051575, 0.6154953241348267, -1.2803126573562622, -0.12530328333377838, -1.002792239189148,
           -0.06472328305244446, -1.7144652605056763, 0.08887798339128494, 0.026280658319592476, 0.3393992483615875,
           -0.186586394906044, 0.3901906907558441, -0.9294121265411377, 0.4709988236427307, -1.647969126701355,
           2.4329662322998047, -0.4826914370059967, -2.27767014503479, 1.209925889968872, 1.175114631652832};
      uint32_t vb[] = {2250286770u, 63684220u};
      size_t l = 60;
      REQUIRE(
          dot_prod_cb_enc<float /* 32 */, float /* 32 */, uint32_t>(va, vb, l) == Approx(-9.97311472148).epsilon(0.01));
    }
  }

  SECTION("float dot_prod_cb_enc(const float*, const uint32_t*, size_t), dim=59") {
    {
      float va[] =
          {-0.07637288421392441, 0.31300580501556396, 1.144892930984497, 0.21329402923583984, -1.1798590421676636,
           -0.2428877353668213, 2.1752779483795166, -1.0689551830291748, -2.026538372039795, 0.9988159537315369,
           -1.3861826658248901, -0.11838433146476746, -0.8239375948905945, 0.32562732696533203, 0.15059281885623932,
           -1.1749608516693115, -2.173835515975952, -1.321860671043396, 0.22110949456691742, 0.12857802212238312,
           -0.40596315264701843, -0.8452123999595642, 0.45971497893333435, -1.911936640739441, -0.7476987838745117,
           0.769662082195282, -0.3621312379837036, 1.4558703899383545, 1.2839789390563965, 0.6950920820236206,
           -0.8910530805587769, 0.07826126366853714, -0.049058329313993454, 0.5078203082084656, 0.7584868669509888,
           -0.14505866169929504, -2.219341278076172, 0.7799006104469299, -0.036312036216259, 0.7765070796012878,
           1.7208104133605957, -0.9723382592201233, -2.064183473587036, 1.201872706413269, -2.080831527709961,
           0.933224618434906, 1.3072363138198853, 0.22162263095378876, 0.3414151668548584, 0.36111748218536377,
           -0.5801030397415161, -1.6777187585830688, 1.4959814548492432, 0.4745880365371704, 1.8248159885406494,
           1.5597652196884155, 2.1767690181732178, -0.9584931135177612, 0.8613196015357971};
      uint32_t vb[] = {3595741631u, 35110749u};
      size_t l = 59;
      REQUIRE(
          dot_prod_cb_enc<float /* 32 */, float /* 32 */, uint32_t>(va, vb, l) == Approx(22.8559199907).epsilon(0.01));
    }
    {
      float va[] =
          {0.1287812739610672, -0.09814302623271942, 0.6313658952713013, 1.1062012910842896, -0.3633035719394684,
           -0.5565665364265442, -1.6501028537750244, -2.020871639251709, -1.705307126045227, 0.45683273673057556,
           -1.8430802822113037, -2.6206071376800537, 1.9487937688827515, 0.5386749505996704, 0.7634240388870239,
           -0.3150564730167389, 1.490517020225525, -1.5916434526443481, 1.0472267866134644, -0.403538316488266,
           -0.27110710740089417, -1.9907066822052002, 0.14401401579380035, 1.7391775846481323, -0.32585030794143677,
           0.9668793678283691, 0.25104087591171265, 1.1705620288848877, 1.1180444955825806, -1.3405312299728394,
           2.288902997970581, 0.10541675984859467, -1.2681583166122437, -0.24145840108394623, 0.5799280405044556,
           0.13436366617679596, -0.10802099108695984, 0.5781753659248352, -1.1861637830734253, -0.3680833876132965,
           -0.7294240593910217, 1.057205080986023, -0.11048529297113419, 0.8773070573806763, -0.6552585363388062,
           0.3401467204093933, 0.18513821065425873, -1.0218586921691895, 0.565692126750946, -0.5280605554580688,
           -0.9003301858901978, 2.68912935256958, 0.4230562150478363, 0.13550275564193726, -0.8924800157546997,
           0.06187111511826515, 0.530120313167572, -0.087342269718647, -1.175525188446045};
      uint32_t vb[] = {1909122697u, 3870972u};
      size_t l = 59;
      REQUIRE(
          dot_prod_cb_enc<float /* 32 */, float /* 32 */, uint32_t>(va, vb, l) == Approx(10.6801745184).epsilon(0.01));
    }
    {
      float va[] =
          {0.6190701127052307, 1.6753919124603271, 0.9748021364212036, 0.40669822692871094, -0.019107794389128685,
           0.41107410192489624, 0.6102832555770874, 0.23093223571777344, -0.17099900543689728, -0.8370743989944458,
           -1.5659950971603394, 1.7483117580413818, -1.6490733623504639, -0.2892119884490967, 1.8487205505371094,
           -1.1376184225082397, -0.8376539945602417, 0.5272558331489563, 0.7411988973617554, 0.9175726771354675,
           -0.20677004754543304, -1.3853124380111694, -1.4213906526565552, 0.7474640607833862, 1.915596604347229,
           1.172066569328308, -0.8457328081130981, -1.2943179607391357, -0.17147183418273926, 0.4828695058822632,
           0.5846258997917175, 2.3978185653686523, -0.39746803045272827, -0.7094528079032898, 0.5342022776603699,
           0.3880419135093689, -0.34504324197769165, -0.1510767638683319, -0.13464169204235077, -0.7430106997489929,
           -1.1374884843826294, -0.12483470141887665, 0.2608310282230377, 1.898132562637329, 0.6521636247634888,
           -0.8820372819900513, -0.9228836894035339, 0.3785586953163147, -0.3523828983306885, 0.8406687378883362,
           -0.41287171840667725, 0.6162914037704468, -1.4957116842269897, -1.2339074611663818, 1.4145289659500122,
           1.1914433240890503, 0.6231389045715332, 1.2211376428604126, 0.18150614202022552};
      uint32_t vb[] = {1849416594u, 81778753u};
      size_t l = 59;
      REQUIRE(
          dot_prod_cb_enc<float /* 32 */, float /* 32 */, uint32_t>(va, vb, l) == Approx(-2.76321076415).epsilon(0.01));
    }
    {
      float va[] =
          {0.2894023060798645, 0.15669529139995575, -0.4226543605327606, -1.4809911251068115, 1.4715683460235596,
           1.5704288482666016, 1.0560274124145508, -2.6742398738861084, 2.2171318531036377, -0.512769877910614,
           -1.0465238094329834, -1.2515461444854736, 1.1592328548431396, -1.6133601665496826, -0.04445485398173332,
           0.883978545665741, -1.2760043144226074, -1.0857657194137573, 0.9084765315055847, 0.8620424270629883,
           0.7084468007087708, -1.2756832838058472, 0.19658459722995758, 1.0777605772018433, -0.0004996846546418965,
           -0.07326158881187439, -1.158745527267456, -0.8054271340370178, 0.8825435042381287, 0.8500824570655823,
           -0.870634913444519, -1.9851841926574707, -0.19540715217590332, 0.19693057239055634, -0.6248805522918701,
           1.1919665336608887, -1.2670586109161377, -0.06725791841745377, 0.4948592483997345, -1.7957212924957275,
           0.25512614846229553, -0.6739751100540161, 0.05131954699754715, 1.0523957014083862, 0.514835774898529,
           -0.5513147711753845, -0.032743677496910095, 0.3368571400642395, -0.6224711537361145, -0.36973991990089417,
           -0.5183069109916687, -1.6710506677627563, -0.25998640060424805, -0.6349977254867554, 1.5071163177490234,
           2.165318012237549, -0.8694690465927124, -0.9577571749687195, 0.18839308619499207};
      uint32_t vb[] = {2429229077u, 39683872u};
      size_t l = 59;
      REQUIRE(
          dot_prod_cb_enc<float /* 32 */, float /* 32 */, uint32_t>(va, vb, l) == Approx(4.41201555013).epsilon(0.01));
    }
    {
      float va[] =
          {0.12366684526205063, 0.6860346794128418, -1.3731440305709839, -0.31958261132240295, -0.7460930347442627,
           2.0414793491363525, -0.036005519330501556, -0.2202286571264267, 0.6646791696548462, 0.08397272974252701,
           -0.8160451054573059, -0.8485720157623291, 0.22398242354393005, 0.500263512134552, 0.10196619480848312,
           -0.11326181143522263, 1.2086405754089355, -0.376777708530426, -0.8054822087287903, 1.6949084997177124,
           0.7036839723587036, -1.0972145795822144, -0.7225015163421631, 0.18644817173480988, 0.06965520977973938,
           -0.2272311896085739, -0.007743198890239, -1.5801345109939575, 1.5541752576828003, -1.3070709705352783,
           -1.9489699602127075, -0.5006210207939148, -1.0412911176681519, 1.8628075122833252, 1.2165577411651611,
           0.2491762936115265, 0.20993900299072266, -1.0691883563995361, 0.49613019824028015, 0.6703547835350037,
           1.3258527517318726, 0.8332037329673767, 0.47096097469329834, -1.1341893672943115, 0.2635672688484192,
           0.7019824981689453, 1.5846410989761353, 0.8565614819526672, -1.9767605066299438, -0.5642412304878235,
           0.6093945503234863, 0.12220628559589386, -0.5904346704483032, -0.6539230346679688, 0.7077247500419617,
           0.331195592880249, -0.9370479583740234, 0.9024398326873779, -0.09493901580572128};
      uint32_t vb[] = {2832709571u, 106629103u};
      size_t l = 59;
      REQUIRE(
          dot_prod_cb_enc<float /* 32 */, float /* 32 */, uint32_t>(va, vb, l) == Approx(-8.34734908817).epsilon(0.01));
    }
  }

  SECTION("float dot_prod_cb_enc(const float*, const uint32_t*, size_t), dim=100") {
    {
      float va[] =
          {-0.5739485025405884, -0.03768047317862511, 0.07732665538787842, -0.12314675003290176, 0.7765005230903625,
           -0.6749900579452515, -0.8316817879676819, -0.25404101610183716, -0.14590232074260712, 1.4283826351165771,
           -0.7881897687911987, 1.1921002864837646, -0.8782846331596375, -0.27323952317237854, 0.4881845712661743,
           0.4077098071575165, -0.18741337954998016, 0.1109536811709404, 1.2187352180480957, 1.3441890478134155,
           -0.07317861169576645, -0.9663074016571045, 0.023965096101164818, -0.9675322771072388, 0.8735054731369019,
           -2.2135825157165527, 0.12904779613018036, -1.2025399208068848, 1.0779732465744019, 0.07096700370311737,
           -0.8580191731452942, -0.9540565609931946, 0.29897549748420715, 0.00708456477150321, 0.38428330421447754,
           1.1444883346557617, 0.8255736231803894, 0.9343529343605042, 0.010992779396474361, -0.8604027032852173,
           -0.95466548204422, -0.9961625337600708, 0.20587393641471863, -0.5357251167297363, 0.26044943928718567,
           0.01735827699303627, 1.029874324798584, -1.29496169090271, -0.12618866562843323, -1.6806902885437012,
           -0.14080044627189636, 0.6085057258605957, -2.3487722873687744, -0.14086931943893433, 1.4909909963607788,
           0.66359543800354, 0.30778613686561584, 0.26065129041671753, 1.6621559858322144, 0.7268463969230652,
           -0.7151807546615601, -0.825833797454834, 0.8466342687606812, -0.4257911443710327, -0.17005793750286102,
           0.0509413406252861, -1.1662973165512085, 2.0862977504730225, 0.33889955282211304, -0.4910152852535248,
           -1.1564165353775024, -1.1942695379257202, 0.5200449824333191, 0.5668812990188599, -1.282476544380188,
           -0.5795053243637085, -1.6132090091705322, -0.037552814930677414, 0.5721904635429382, 1.7511359453201294,
           -0.5147806406021118, -1.6048680543899536, -0.3779385983943939, 0.401547908782959, -0.6262327432632446,
           -2.1867308616638184, -0.19272974133491516, -0.8909568786621094, 0.107669897377491, 1.3084408044815063,
           -0.3302551507949829, 0.19423922896385193, 1.6775864362716675, 2.353191375732422, 0.9705067873001099,
           -0.6172316670417786, 1.5381392240524292, -1.152706265449524, -1.3134304285049438, 1.1529276371002197};
      uint32_t vb[] = {604116282u, 2180239832u, 1533839509u, 6u};
      size_t l = 100;
      REQUIRE(
          dot_prod_cb_enc<float /* 32 */, float /* 32 */, uint32_t>(va, vb, l) == Approx(-12.7976581776).epsilon(0.01));
    }
    {
      float va[] =
          {0.5251714587211609, 0.12003044784069061, 0.9907482266426086, -0.28645509481430054, -1.8540143966674805,
           -0.1559515744447708, 0.06553924828767776, 0.13447163999080658, -1.4761948585510254, -1.0248243808746338,
           0.8116220235824585, -0.24769392609596252, -1.1038025617599487, 0.5351191759109497, 0.38548728823661804,
           0.6379376649856567, -0.7560051083564758, 1.8112399578094482, 0.07683496177196503, -0.6972588896751404,
           -1.3849526643753052, 0.5725557804107666, -0.917147696018219, 1.7784959077835083, 0.2958012819290161,
           -0.02068001590669155, -1.4010002613067627, -1.600723385810852, 0.4902151823043823, -0.9452319741249084,
           0.32928267121315, 0.2843485176563263, 0.5160577297210693, 0.7518383860588074, -0.5195170044898987,
           -0.7421097159385681, 0.5589028000831604, -1.7688727378845215, -0.23367467522621155, 0.420577734708786,
           0.7778056859970093, -0.12888559699058533, 0.27613499760627747, -1.3306587934494019, 0.4622747600078583,
           1.6901530027389526, -0.6016786694526672, -1.2687029838562012, -0.4560840427875519, 0.6008260250091553,
           -0.9990274310112, 0.08866702020168304, 1.7835243940353394, -0.2882373631000519, 2.418285369873047,
           -0.25668931007385254, -0.029627475887537003, 0.8199385404586792, 1.1488467454910278, 0.7987335920333862,
           0.8445647358894348, -0.973143994808197, 1.889367699623108, -1.7377055883407593, 1.013694167137146,
           0.11296180635690689, 0.9284588098526001, 0.5524741411209106, -0.31884291768074036, -0.9332312345504761,
           -0.08105402439832687, -0.21266433596611023, 1.0852220058441162, 0.8386973142623901, -0.0062722377479076385,
           -0.7014470100402832, -0.30001357197761536, 1.6994305849075317, 0.8090317845344543, -0.22553309798240662,
           -0.40455275774002075, -0.11851225048303604, -0.2705141603946686, 1.0453124046325684, -0.8182846307754517,
           -1.726926326751709, 0.14718550443649292, 0.606065034866333, -0.20067141950130463, 0.8763493299484253,
           -1.541006088256836, 1.4357755184173584, -0.21934527158737183, -1.2641664743423462, 0.8051854372024536,
           0.5391567349433899, 0.7105528712272644, -0.2154824286699295, 1.177836537361145, 0.28496864438056946};
      uint32_t vb[] = {108731214u, 3708251926u, 631251395u, 6u};
      size_t l = 100;
      REQUIRE(
          dot_prod_cb_enc<float /* 32 */, float /* 32 */, uint32_t>(va, vb, l) == Approx(7.82587093301).epsilon(0.01));
    }
    {
      float va[] =
          {0.9068914651870728, 0.6335898637771606, 0.6339687705039978, -0.06564877182245255, -2.0458154678344727,
           1.1848902702331543, -0.3273927569389343, 0.9080362319946289, 0.8924511075019836, -0.2786155045032501,
           0.06833221763372421, -0.08702892065048218, 0.12553167343139648, 1.6130955219268799, -0.06222370266914368,
           0.6357623338699341, -0.27206656336784363, -0.7275959253311157, -0.8346546292304993, -0.15902473032474518,
           0.8206995725631714, 0.049769025295972824, 0.17234861850738525, 0.5730978846549988, -0.7959117889404297,
           -0.1781645566225052, -0.8099091053009033, -0.692384660243988, -0.36948761343955994, -0.7801199555397034,
           2.065389394760132, -1.3845176696777344, 0.6040593385696411, -2.264514923095703, -0.9596681594848633,
           0.417346328496933, 0.005414203274995089, 0.565287172794342, -1.836261510848999, -1.2021054029464722,
           -1.4679933786392212, -1.8722895383834839, 0.34565722942352295, 1.0323349237442017, 0.4108540415763855,
           -0.04228879138827324, 0.7293970584869385, 0.28230154514312744, 0.4909554421901703, 0.33355405926704407,
           -0.46823379397392273, 0.057239461690187454, -0.8785455822944641, 1.3863122463226318, -1.4606115818023682,
           -0.3480168879032135, 2.574740409851074, -0.03422154486179352, -0.7744542360305786, -1.1113710403442383,
           -1.15586256980896, 0.5559200048446655, 1.045135736465454, -0.9611766338348389, 1.0677711963653564,
           1.7041956186294556, 0.38878265023231506, 1.478478193283081, -0.4411514401435852, 0.4314497113227844,
           -0.9121795892715454, 1.3216304779052734, -2.5769031047821045, -1.2715975046157837, 1.1225941181182861,
           -0.061031095683574677, 1.5964809656143188, -1.0559781789779663, 0.7518838047981262, -0.9584617018699646,
           0.8749467730522156, -0.2593443691730499, -0.9089394211769104, -0.22222599387168884, -0.30778589844703674,
           -0.5129155516624451, -0.24926292896270752, -0.6106327772140503, -1.485252857208252, 1.0520291328430176,
           3.0675930976867676, -0.5442807078361511, -1.5083503723144531, -0.8626818656921387, -1.4691741466522217,
           -0.34133508801460266, 0.7096415162086487, 0.37893274426460266, 0.07847394794225693, -1.2030844688415527};
      uint32_t vb[] = {945725474u, 3628837317u, 2914895895u, 6u};
      size_t l = 100;
      REQUIRE(
          dot_prod_cb_enc<float /* 32 */, float /* 32 */, uint32_t>(va, vb, l) == Approx(1.54339415999).epsilon(0.01));
    }
    {
      float va[] =
          {1.0317072868347168, 1.0385524034500122, -0.22387580573558807, 0.46240538358688354, -0.6583145260810852,
           1.9974400997161865, -0.757063090801239, 1.5701206922531128, -0.7724660038948059, 0.19222448766231537,
           -1.0713392496109009, -2.182560920715332, -0.7198019623756409, 0.8951385617256165, 1.149086833000183,
           -0.49707528948783875, -0.396808922290802, -0.49572890996932983, -1.082040786743164, -0.7812169790267944,
           -0.9938828945159912, 0.5581477284431458, -0.11046082526445389, -0.47820210456848145, -1.3726773262023926,
           -0.572467565536499, 0.12674197554588318, -2.2018370628356934, -0.5961737632751465, -0.4326375424861908,
           -0.07722373306751251, 1.2219680547714233, 1.725632905960083, -1.584696650505066, 0.007123987656086683,
           0.7540987730026245, 0.8346315622329712, -0.6552672386169434, 1.0704525709152222, 1.3736940622329712,
           -0.2881360650062561, -0.15653492510318756, -1.0421597957611084, -0.47734975814819336, 0.3072197735309601,
           1.1878008842468262, 0.8210564255714417, -0.33435487747192383, -0.297050416469574, 1.682214617729187,
           1.6321157217025757, 1.9588695764541626, 0.25021451711654663, -0.5490489602088928, 0.10094335675239563,
           -0.7294080853462219, 1.0653561353683472, 1.1390118598937988, 0.13714322447776794, -0.885572612285614,
           -0.0027359542436897755, -0.22083090245723724, 1.1091760396957397, 1.0797697305679321, -1.2430641651153564,
           -0.1298399269580841, -0.44086065888404846, 0.8091499209403992, -0.3196876645088196, 0.5332816243171692,
           -0.6614891290664673, 0.3138466477394104, -2.4476940631866455, 0.7555550336837769, -0.06831663846969604,
           1.117428183555603, 0.5668519735336304, -0.16867230832576752, -1.6565375328063965, 1.661021113395691,
           -0.10260627418756485, -1.7314270734786987, 0.2686176300048828, -0.3623511791229248, 0.7843260765075684,
           -0.7260904312133789, 0.07435820251703262, 0.2672775685787201, -0.15555396676063538, 0.480904757976532,
           0.7085503935813904, -0.4780358076095581, -0.9252075552940369, -0.9118016958236694, 0.2839835286140442,
           0.1884547770023346, 1.6810109615325928, 1.6473506689071655, -0.16205564141273499, -2.9109890460968018};
      uint32_t vb[] = {2532561322u, 27754567u, 4195868315u, 8u};
      size_t l = 100;
      REQUIRE(
          dot_prod_cb_enc<float /* 32 */, float /* 32 */, uint32_t>(va, vb, l) == Approx(-6.30803441163).epsilon(0.01));
    }
    {
      float va[] =
          {-0.20504964888095856, 0.15602591633796692, -1.6197826862335205, 0.7593600153923035, -0.7339916825294495,
           2.3751380443573, -1.303157091140747, -0.40061160922050476, 0.8527277708053589, -1.081410527229309,
           1.5283005237579346, 1.1830955743789673, 0.1442517340183258, 1.1159169673919678, 1.137006163597107,
           0.6395372748374939, -0.8854701519012451, 1.4330973625183105, 1.9568462371826172, 0.8041906356811523,
           -0.05390183627605438, 0.48692718148231506, -0.12322723120450974, -0.727582573890686, -0.4912337064743042,
           -0.8742363452911377, -0.20319025218486786, -0.8322369456291199, -0.5190578103065491, -1.1539736986160278,
           0.07061765342950821, 0.36671435832977295, 0.2585187554359436, -0.5267571806907654, 2.179323673248291,
           1.6935783624649048, -0.14990442991256714, 0.6892443299293518, 1.7401846647262573, -1.2121362686157227,
           1.91897451877594, -0.9114303588867188, -0.33166804909706116, -0.762020468711853, -2.0882747173309326,
           0.8817620873451233, -1.2499470710754395, 1.0086736679077148, -2.690140724182129, 1.8847836256027222,
           -0.8139929175376892, 0.41902080178260803, 0.2474856972694397, 0.9634578227996826, -0.3574995994567871,
           0.6067079901695251, 0.3179904818534851, 0.3059961497783661, -0.9772555828094482, -0.9652887582778931,
           1.1207215785980225, 0.10618725419044495, 0.6414196491241455, 0.2479429841041565, -0.7609981894493103,
           0.8544101715087891, 1.8814069032669067, -0.04603055864572525, -0.7414406538009644, -0.39672642946243286,
           -1.631199598312378, 0.22626253962516785, -1.4822839498519897, -0.580546498298645, -0.6325106024742126,
           -0.5966516137123108, -0.9369153380393982, -0.9284783601760864, 1.4200458526611328, -1.0939607620239258,
           -0.5378289818763733, 2.4497551918029785, -1.4743449687957764, 0.28675347566604614, 1.4145002365112305,
           -0.4012965261936188, -0.7965025305747986, -0.4537109434604645, -0.20147061347961426, -2.4772121906280518,
           -0.2065032571554184, 1.191607117652893, 0.5158941745758057, -0.04245668649673462, 0.3864828944206238,
           -1.1103456020355225, -2.1226673126220703, 2.2209672927856445, 0.6476854085922241, 0.3542978763580322};
      uint32_t vb[] = {2392322949u, 1025663382u, 1448295279u, 11u};
      size_t l = 100;
      REQUIRE(
          dot_prod_cb_enc<float /* 32 */, float /* 32 */, uint32_t>(va, vb, l) == Approx(2.78090267628).epsilon(0.01));
    }
  }

  SECTION("float dot_prod_cb_enc(const float*, const uint32_t*, size_t), dim=119") {
    {
      float va[] =
          {-0.3081425130367279, 0.1210935041308403, -0.2573941946029663, -1.9741530418395996, -1.047473430633545,
           0.7984191179275513, -0.09580514580011368, 3.141428232192993, 0.567673921585083, -0.11495985090732574,
           0.5251308679580688, -1.3101271390914917, 0.8175626397132874, 0.566935658454895, -0.9263321161270142,
           -0.061622533947229385, 0.2552698254585266, -2.1186232566833496, 0.10636138916015625, 0.265421062707901,
           -0.5396169424057007, -1.5294981002807617, 0.8607000112533569, -1.4241422414779663, 0.19747574627399445,
           0.08240190893411636, 1.4093592166900635, -0.30017030239105225, 0.3056321442127228, 0.4734242856502533,
           2.5832509994506836, 0.9704989194869995, -1.1480711698532104, -0.23330621421337128, 1.5479223728179932,
           0.45509904623031616, 0.32577869296073914, 0.05445884168148041, -0.34862884879112244, 1.0281201601028442,
           1.1591050624847412, 1.6960586309432983, -0.6673367023468018, -0.9620069861412048, 0.7975454926490784,
           -0.7572385668754578, -1.1333025693893433, 0.3996466100215912, 0.07144244760274887, 0.21688377857208252,
           -0.6795529723167419, -1.2649352550506592, -2.150662899017334, -0.8169651627540588, -1.3536224365234375,
           0.713706374168396, 0.7118489146232605, -0.845636785030365, -0.623284637928009, 0.4559152126312256,
           1.5312355756759644, -0.10544665157794952, 0.9814768433570862, -0.8970208168029785, 0.20618626475334167,
           -0.43598082661628723, -0.4126172661781311, -0.7785567045211792, -1.0724914073944092, 0.36253538727760315,
           0.450661838054657, 0.6190186738967896, 0.5575020909309387, 0.3232242166996002, -0.24041150510311127,
           -0.7334216237068176, -1.9320286512374878, 1.5339057445526123, -1.027337908744812, 1.0918357372283936,
           0.4113837778568268, -0.7507932782173157, -0.4749201238155365, -1.5293123722076416, -0.9431573152542114,
           0.6970340609550476, -0.2201794534921646, 0.5823736786842346, -0.5437340140342712, 0.048712484538555145,
           -1.1612080335617065, -0.16447420418262482, -2.1549153327941895, 0.4766821563243866, 0.24487775564193726,
           0.3829508125782013, 0.11045029759407043, 0.9980239272117615, 0.339690238237381, -0.49787983298301697,
           0.014104703441262245, 0.5077034831047058, -0.1778430938720703, -0.44661766290664673, -0.09211842715740204,
           0.5948063731193542, 0.17622393369674683, -0.2740147113800049, 0.8451613783836365, 1.1016466617584229,
           -1.0445303916931152, 1.704895257949829, -0.31377843022346497, -0.2582974135875702, 0.5440692901611328,
           1.1061186790466309, 1.0642950534820557, 1.3555878400802612, 0.7088340520858765};
      uint32_t vb[] = {817909461u, 3631975382u, 614268200u, 2797484u};
      size_t l = 119;
      REQUIRE(
          dot_prod_cb_enc<float /* 32 */, float /* 32 */, uint32_t>(va, vb, l) == Approx(-14.1179668885).epsilon(0.01));
    }
    {
      float va[] = {0.06590933352708817, -0.11793835461139679, 1.3082234859466553, -0.5711944699287415, 1.5328369140625,
                    0.4282475709915161, 1.2397737503051758, -0.2739517092704773, -1.4766207933425903,
                    0.15348012745380402, -0.04465173929929733, 0.000851876218803227, 2.0143275260925293,
                    -1.3184396028518677, 1.5215764045715332, 1.1132571697235107, 0.2678544521331787, 0.4469301104545593,
                    0.025739137083292007, 0.9491094350814819, 0.3463687598705292, -0.16466210782527924,
                    -0.2397017776966095, 0.5352751612663269, 0.47964683175086975, 1.3718898296356201,
                    -0.24157710373401642, 0.02518041990697384, 0.7044121026992798, 1.232383131980896,
                    0.021768392994999886, -1.2540050745010376, -0.9169370532035828, -1.0079028606414795,
                    -0.9559712409973145, -1.3423134088516235, -1.2139475345611572, 0.41967689990997314,
                    1.7474781274795532, 0.17910097539424896, 1.1871706247329712, -1.754089593887329,
                    -1.3080780506134033, 1.9559537172317505, 1.1017686128616333, -1.786658525466919,
                    -0.5919878482818604, 1.1850790977478027, 0.9923552870750427, 0.2843628227710724, 0.3628852069377899,
                    1.2235935926437378, -0.11920196563005447, 0.3786192238330841, -0.5063541531562805,
                    -0.4331068694591522, 1.241414189338684, 1.102955937385559, 0.8204702734947205, 1.1502596139907837,
                    -2.120466947555542, -0.16581818461418152, -1.082039475440979, -0.7910463213920593,
                    -0.05228682979941368, 0.5949618220329285, 0.20532658696174622, -0.15616470575332642,
                    -1.051360845565796, 2.1988563537597656, -0.8494027256965637, -0.14587530493736267,
                    0.761456310749054, 1.4193828105926514, -1.3339115381240845, -1.4990181922912598,
                    0.0025706549640744925, -0.02804543636739254, -0.9353140592575073, -1.4514753818511963,
                    -0.4358077943325043, -1.1346300840377808, -0.7405672669410706, 1.025791883468628,
                    1.3040964603424072, 0.26291951537132263, 1.8879095315933228, -0.5521101355552673,
                    1.1687839031219482, 0.8318445682525635, -0.7907344102859497, -0.07646927982568741,
                    0.8965030312538147, -0.6275154948234558, -0.2403557449579239, -1.0278599262237549,
                    1.353875994682312, -0.2423882931470871, 0.6041750311851501, -0.11813703179359436,
                    -1.3020776510238647, -0.07766380906105042, 1.0932906866073608, 0.4815295934677124,
                    -1.6511197090148926, -0.5515444874763489, 1.807317852973938, -0.15507514774799347,
                    -0.693795382976532, 1.6875889301300049, 0.6711944937705994, 0.08803678303956985,
                    -0.0058542946353554726, -0.05362013727426529, 0.06766151636838913, -0.32220757007598877,
                    -0.9358881115913391, -0.9672328233718872, 0.22740373015403748};
      uint32_t vb[] = {2987611618u, 2841660819u, 1087394170u, 4744231u};
      size_t l = 119;
      REQUIRE(
          dot_prod_cb_enc<float /* 32 */, float /* 32 */, uint32_t>(va, vb, l) == Approx(-8.59112891706).epsilon(0.01));
    }
    {
      float va[] =
          {-1.8520804643630981, 1.5230299234390259, -0.9213069081306458, 0.35759449005126953, -1.8649486303329468,
           0.25177499651908875, 0.009940245188772678, -1.4754326343536377, -0.720372200012207, 2.1827163696289062,
           1.5910602807998657, 0.046309694647789, 0.2638843059539795, -0.26155605912208557, 1.567528486251831,
           1.169859528541565, -0.3338378667831421, -0.6050412058830261, 1.7021936178207397, -0.150469571352005,
           -1.2379485368728638, 0.8427218198776245, 0.3723057806491852, 0.784359872341156, 0.42860350012779236,
           0.5396344661712646, 0.8454647064208984, -1.9811497926712036, 1.4179093837738037, -1.0928168296813965,
           -0.35246574878692627, -0.7965699434280396, 0.5642663836479187, 0.41412273049354553, -1.0954132080078125,
           0.7019438147544861, -0.8331552743911743, -0.7821924686431885, 1.8432234525680542, 0.20556531846523285,
           -0.2979333996772766, -0.028113240376114845, -0.15059173107147217, 0.5840155482292175, -0.5536121129989624,
           0.5214849710464478, 1.2853575944900513, 0.09471768140792847, 0.22805839776992798, -0.43860507011413574,
           -1.0553292036056519, -1.5071980953216553, 0.606159508228302, -2.6106433868408203, 0.20549523830413818,
           1.5389158725738525, 0.690862238407135, 0.5770898461341858, -0.4740482568740845, -0.6062705516815186,
           0.8469957709312439, -0.012522628530859947, 0.0164346843957901, 0.8220149874687195, -0.03693566843867302,
           -0.26142236590385437, 0.9157869219779968, 0.6758122444152832, 0.24397435784339905, -1.0401443243026733,
           -2.6833081245422363, 0.7489833831787109, -0.022084040567278862, -1.4056098461151123, 0.715948760509491,
           -2.215437173843384, -0.6080669164657593, 0.4433748722076416, -0.5414727330207825, -0.5889638066291809,
           -0.11802612245082855, -1.3374420404434204, 1.1630363464355469, -0.6565758585929871, 0.019428327679634094,
           -0.17928728461265564, -1.6575971841812134, -0.16934984922409058, -0.9439555406570435, 1.508795976638794,
           -1.3460259437561035, 0.7075684070587158, 0.46587681770324707, 0.3603666126728058, 0.6047036051750183,
           -0.1397981345653534, -0.8012001514434814, -0.6709663271903992, -0.020341254770755768, 0.0789734423160553,
           0.9952115416526794, -0.2559205889701843, 0.5707272291183472, 1.0845932960510254, 1.1322872638702393,
           1.5273947715759277, 2.423229455947876, -0.7011750936508179, -0.531663179397583, 0.7328665852546692,
           -0.6782570481300354, -1.5179944038391113, 0.46121838688850403, -1.1402106285095215, -0.48770514130592346,
           0.2745680809020996, 1.0373674631118774, 1.69120192527771, -2.159705877304077};
      uint32_t vb[] = {2133806726u, 590342154u, 5596886u, 970105u};
      size_t l = 119;
      REQUIRE(
          dot_prod_cb_enc<float /* 32 */, float /* 32 */, uint32_t>(va, vb, l) == Approx(-4.31264339853).epsilon(0.01));
    }
    {
      float va[] =
          {1.9465049505233765, -1.2612980604171753, -0.5265774726867676, -0.8553239703178406, 1.3408204317092896,
           -0.4784869849681854, 0.7820418477058411, -1.7780107259750366, -0.6129813194274902, 1.2893537282943726,
           1.6848876476287842, 0.4581122100353241, 1.3957394361495972, 0.7164029479026794, 2.804514169692993,
           0.3385590612888336, 0.5958349108695984, 0.5062608122825623, -1.5681300163269043, -1.2597339153289795,
           -1.883230209350586, -0.6990839838981628, 0.2424488514661789, -1.4375778436660767, 0.7307997345924377,
           0.5243001580238342, -0.5264290571212769, -0.7270711064338684, 0.7433318495750427, 0.8579296469688416,
           -0.07843625545501709, -1.3953512907028198, -0.6502730846405029, 1.0045241117477417, -0.44609126448631287,
           0.13097752630710602, -0.9624770283699036, 0.7561044692993164, -0.2170042246580124, -0.1490222066640854,
           -0.7185596227645874, -0.11460574716329575, 1.617210030555725, 1.7259724140167236, -0.5341300368309021,
           0.03480976074934006, -0.17250680923461914, -0.22501210868358612, 2.3529794216156006, -0.6243478059768677,
           -0.013494283892214298, -0.6643846035003662, 1.3546303510665894, 0.06729093939065933, -0.878951370716095,
           0.5137941241264343, -2.2080819606781006, 0.39216378331184387, 0.5879108309745789, -1.9731444120407104,
           0.7596021294593811, 1.871351718902588, -0.6881008148193359, -0.6233593821525574, -0.1893790066242218,
           -1.1546337604522705, 0.8432695269584656, -0.38102346658706665, -0.19559043645858765, -0.04276251420378685,
           0.20027431845664978, -0.05862387269735336, 2.570416212081909, 0.6069974303245544, 0.14678357541561127,
           -0.06034627556800842, 0.7019602656364441, -0.08298283070325851, -0.6119556427001953, -0.7295024394989014,
           -0.1538235992193222, -1.1131510734558105, -0.9016972780227661, -0.41767027974128723, -0.20024949312210083,
           -1.1695488691329956, 2.035327672958374, 0.783309280872345, -0.9120088219642639, -0.21271851658821106,
           -0.6935851573944092, -1.9763747453689575, 1.2418545484542847, -0.3116225302219391, -0.5952741503715515,
           2.0278444290161133, -0.40387219190597534, -1.4787144660949707, -0.9889007210731506, 0.41094252467155457,
           0.8239091038703918, 0.3063828945159912, 0.3153766095638275, 0.9277400374412537, 1.0204981565475464,
           -1.499215841293335, -0.8316325545310974, 1.7032217979431152, -1.2484773397445679, -1.3775893449783325,
           -0.49035993218421936, 0.7213049530982971, -0.32158318161964417, -1.4138659238815308, 0.739617645740509,
           0.9650056958198547, 1.387364149093628, 0.88548344373703, 0.017592215910553932};
      uint32_t vb[] = {1536661635u, 1501627721u, 1665211418u, 2545492u};
      size_t l = 119;
      REQUIRE(
          dot_prod_cb_enc<float /* 32 */, float /* 32 */, uint32_t>(va, vb, l) == Approx(-12.5790048288).epsilon(0.01));
    }
    {
      float va[] =
          {-0.9234270453453064, -1.140058159828186, -1.1697806119918823, -0.4286547899246216, 0.05806611478328705,
           1.0503528118133545, -2.2073233127593994, 1.5382739305496216, -1.118579626083374, -0.6144139170646667,
           1.042339563369751, -0.46746134757995605, 0.35145825147628784, 0.4232533574104309, -0.07581775635480881,
           0.6967482566833496, -0.5560720562934875, 1.1276233196258545, 0.03200023993849754, 0.6345544457435608,
           -1.3604449033737183, 0.8654434084892273, 2.2776970863342285, 0.0896511971950531, 0.22909368574619293,
           1.687130093574524, 0.6931242346763611, -0.7574666738510132, -0.09676145762205124, -0.47322797775268555,
           -0.552312970161438, -0.8858534097671509, 0.23118363320827484, -1.9719222784042358, 0.9228086471557617,
           0.8334598541259766, 1.2288223505020142, 0.24564442038536072, 3.3677420616149902, 0.28935474157333374,
           -1.5739480257034302, 1.2219867706298828, -0.9558864831924438, -0.5351508855819702, 0.3018059730529785,
           -0.6351597309112549, 1.0684295892715454, -1.44878089427948, 0.37499508261680603, -0.38132384419441223,
           0.10331806540489197, 0.2737029492855072, -0.6737505197525024, -1.8172047138214111, 0.2897358238697052,
           0.2576856017112732, 1.4417699575424194, -0.03999563306570053, 0.6344612836837769, -0.5086897611618042,
           -0.4443107545375824, 0.1338849514722824, -1.1593883037567139, -0.10826756060123444, 0.9991831183433533,
           0.10924743115901947, -1.0384453535079956, -1.3742858171463013, 1.2280442714691162, 0.599229097366333,
           0.5572973489761353, 0.3079172670841217, -0.19587628543376923, -0.7680485248565674, -0.9683347344398499,
           0.31313371658325195, -0.8446202278137207, -0.24671562016010284, 0.958316445350647, -0.6278232932090759,
           -1.5789071321487427, 0.43842142820358276, -1.358122706413269, 1.4023888111114502, -0.442815363407135,
           1.1226990222930908, -0.06214306876063347, -1.758711814880371, 0.18614089488983154, 1.7712591886520386,
           -0.9722023010253906, 1.5435173511505127, -0.6957352757453918, -0.9008638262748718, 0.8147476315498352,
           -1.0307804346084595, 2.075831174850464, 0.30239349603652954, -0.755045473575592, -0.5370483994483948,
           -1.1968271732330322, -0.44884157180786133, -0.4045569598674774, -0.751213014125824, 1.138594150543213,
           -0.6934695839881897, -0.13926994800567627, -0.26492342352867126, -0.3370780050754547, 0.45920392870903015,
           0.4824572205543518, 1.7046177387237549, 0.6079882383346558, -1.6334284543991089, -0.8224579095840454,
           -1.6928486824035645, 0.9447140693664551, -1.5273948907852173, -1.1511458158493042};
      uint32_t vb[] = {1181965266u, 789306367u, 1842117856u, 4382321u};
      size_t l = 119;
      REQUIRE(
          dot_prod_cb_enc<float /* 32 */, float /* 32 */, uint32_t>(va, vb, l) == Approx(21.7324476168).epsilon(0.01));
    }
  }

  SECTION("float dot_prod_cb_enc(const float*, const uint32_t*, size_t), dim=24") {
    {
      float va[] = {0.6317664384841919, 1.1157801151275635, -0.5533815622329712, 1.5542677640914917, 1.0078628063201904,
                    -0.2674504220485687, -0.4264565408229828, -1.4488896131515503, 1.865062952041626,
                    -1.2932064533233643, 0.4231175184249878, -1.5734280347824097, -0.35135456919670105,
                    -0.35348865389823914, 1.6750699281692505, -1.1093910932540894, -1.4398245811462402,
                    0.28786835074424744, 0.5568207502365112, 1.6275415420532227, 0.13906019926071167, 1.264695644378662,
                    -0.3960282802581787, -0.2779533863067627};
      uint32_t vb[] = {9865621u};
      size_t l = 24;
      REQUIRE(
          dot_prod_cb_enc<float /* 32 */, float /* 32 */, uint32_t>(va, vb, l) == Approx(3.48374667764).epsilon(0.01));
    }
    {
      float va[] =
          {1.7416741847991943, 1.1156102418899536, -0.5908052325248718, 0.44941556453704834, 0.6584514379501343,
           1.095813274383545, -0.210114985704422, 0.30386555194854736, 0.6011647582054138, -0.023951930925250053,
           0.1195630431175232, -0.8114047646522522, -2.2319979667663574, -1.713979959487915, -1.748778223991394,
           0.10866022109985352, -0.9805725812911987, 1.2717605829238892, 0.3553582429885864, 1.210588812828064,
           1.4960429668426514, 0.039657898247241974, -0.8981233239173889, -0.5928723812103271};
      uint32_t vb[] = {14397287u};
      size_t l = 24;
      REQUIRE(
          dot_prod_cb_enc<float /* 32 */, float /* 32 */, uint32_t>(va, vb, l) == Approx(-2.02639565803).epsilon(0.01));
    }
    {
      float va[] =
          {0.006933965720236301, -0.4819890856742859, 0.7384538650512695, 0.4409184753894806, 0.6261924505233765,
           0.23609448969364166, 1.1908347606658936, -0.5763556957244873, 1.0612688064575195, -0.2856217622756958,
           -0.7797057032585144, 2.5025429725646973, 1.1692471504211426, -0.0005022356053814292, 0.33644482493400574,
           -2.503873825073242, -0.8867718577384949, 0.6089246869087219, 1.4732688665390015, -1.040399432182312,
           0.5404030084609985, 0.030741218477487564, 0.47976383566856384, -1.118676781654358};
      uint32_t vb[] = {12453200u};
      size_t l = 24;
      REQUIRE(
          dot_prod_cb_enc<float /* 32 */, float /* 32 */, uint32_t>(va, vb, l) == Approx(-3.16098259611).epsilon(0.01));
    }
    {
      float va[] = {-0.4539456069469452, 3.0042200088500977, 1.332159399986267, -0.4056096076965332, 1.443374514579773,
                    0.5392798781394958, -0.9945712089538574, 0.6474406719207764, 0.47793737053871155,
                    -0.06740039587020874, 0.21372845768928528, -1.7565816640853882, -0.6072108745574951,
                    2.5444259643554688, -0.462861567735672, 0.4263170063495636, 0.6716035604476929, 2.166170120239258,
                    -0.11299551278352737, -0.29143431782722473, -0.8092330098152161, 0.04454321041703224,
                    -1.7293225526809692, -2.3160488605499268};
      uint32_t vb[] = {13900359u};
      size_t l = 24;
      REQUIRE(
          dot_prod_cb_enc<float /* 32 */, float /* 32 */, uint32_t>(va, vb, l) == Approx(-7.45872001722).epsilon(0.01));
    }
    {
      float va[] =
          {-0.2903525233268738, -0.2418232560157776, -0.3225390911102295, -0.6878889203071594, 0.5230062007904053,
           -0.022275082767009735, -1.086390733718872, -0.05828947201371193, -0.10578799247741699, 0.10014171898365021,
           -0.03627665340900421, -0.719635009765625, -0.632828414440155, -0.13708218932151794, 0.32093334197998047,
           0.3448968827724457, -0.2763729691505432, -1.693633794784546, 0.3060203492641449, 0.7933070659637451,
           0.6831026673316956, -0.12384026497602463, 0.19651545584201813, 0.013882411643862724};
      uint32_t vb[] = {15195567u};
      size_t l = 24;
      REQUIRE(
          dot_prod_cb_enc<float /* 32 */, float /* 32 */, uint32_t>(va, vb, l) == Approx(-1.59210475348).epsilon(0.01));
    }
  }

  SECTION("float dot_prod_cb_enc(const float*, const uint32_t*, size_t), dim=23") {
    {
      float va[] =
          {0.3737236261367798, -0.8656110167503357, 0.7949312329292297, 0.3382227420806885, -1.4111794233322144,
           0.09869534522294998, 0.41633331775665283, -0.9790328145027161, -1.4862741231918335, 0.7499125599861145,
           0.5114309191703796, 0.5630267262458801, -0.9085888266563416, -0.9264006018638611, -1.0615127086639404,
           1.2518906593322754, -1.3783212900161743, 1.4572798013687134, 0.2192256897687912, -0.3785877823829651,
           -0.3736993074417114, -0.16498351097106934, -2.5114083290100098};
      uint32_t vb[] = {6683908u};
      size_t l = 23;
      REQUIRE(
          dot_prod_cb_enc<float /* 32 */, float /* 32 */, uint32_t>(va, vb, l) == Approx(-3.2720150277).epsilon(0.01));
    }
    {
      float va[] =
          {-1.4609742164611816, 0.24916695058345795, -1.385602355003357, 1.4743722677230835, -0.4531380534172058,
           -1.598147988319397, 0.270452082157135, 1.838645577430725, -1.5651222467422485, -1.3930555582046509,
           1.0839381217956543, 0.8868696093559265, -1.0460808277130127, 2.775970935821533, 1.0970134735107422,
           1.995437741279602, -1.3081403970718384, 0.49671414494514465, 0.3711108863353729, 0.12835991382598877,
           -0.36084645986557007, 0.15252025425434113, -0.799403965473175};
      uint32_t vb[] = {5376336u};
      size_t l = 23;
      REQUIRE(
          dot_prod_cb_enc<float /* 32 */, float /* 32 */, uint32_t>(va, vb, l) == Approx(-8.24580186605).epsilon(0.01));
    }
    {
      float va[] =
          {-0.3294978737831116, -0.033442478626966476, 0.9430258274078369, 0.2508290112018585, 1.2037713527679443,
           -1.6006226539611816, -0.49383053183555603, 1.9814151525497437, 0.01777717098593712, -0.0819304957985878,
           0.5104203820228577, -0.28477755188941956, -1.5553412437438965, -0.822797954082489, 0.18189649283885956,
           -1.4814057350158691, 0.2578217089176178, 0.09527941793203354, 0.4446532726287842, -1.7038434743881226,
           0.31674477458000183, 1.1135609149932861, 0.34939175844192505};
      uint32_t vb[] = {7982801u};
      size_t l = 23;
      REQUIRE(dot_prod_cb_enc<float /* 32 */, float /* 32 */, uint32_t>(va, vb, l)
                  == Approx(-0.791456177831).epsilon(0.01));
    }
    {
      float va[] =
          {0.11178577691316605, -0.5557457804679871, -0.1422743797302246, -1.01259183883667, 1.1019947528839111,
           1.9428133964538574, -1.0298320055007935, -0.26543909311294556, 0.7262241244316101, 2.0282912254333496,
           -0.7673221826553345, -1.8955070972442627, -0.3475058078765869, -0.20589838922023773, 1.1685328483581543,
           0.5433350205421448, 1.607998251914978, -0.05350584536790848, -0.4347492456436157, 0.9978793859481812,
           -1.147314190864563, -0.4762387275695801, 1.8475837707519531};
      uint32_t vb[] = {3667912u};
      size_t l = 23;
      REQUIRE(
          dot_prod_cb_enc<float /* 32 */, float /* 32 */, uint32_t>(va, vb, l) == Approx(9.86358876526).epsilon(0.01));
    }
    {
      float va[] =
          {0.4604934751987457, -0.2683086097240448, -0.39405664801597595, 0.0466768741607666, 0.9255277514457703,
           -0.4225739538669586, 1.0225034952163696, 1.0474340915679932, -0.5355981588363647, 0.6775047183036804,
           -0.06295162439346313, 1.7295284271240234, -0.27384406328201294, 0.3818938136100769, -0.7067394256591797,
           -1.0591380596160889, -3.2919795513153076, -0.08516236394643784, 0.10851787775754929, 0.09827326238155365,
           -0.3273999094963074, -1.0683878660202026, 1.1751158237457275};
      uint32_t vb[] = {1196875u};
      size_t l = 23;
      REQUIRE(
          dot_prod_cb_enc<float /* 32 */, float /* 32 */, uint32_t>(va, vb, l) == Approx(-8.70543478429).epsilon(0.01));
    }
  }

  SECTION("float dot_prod_cb_enc(const float*, const uint32_t*, size_t), dim=150") {
    {
      float va[] =
          {1.212300419807434, 0.07192505896091461, -0.18772661685943604, -1.1753504276275635, -0.6556609869003296,
           -0.830699622631073, 0.08808308839797974, 1.0677703619003296, 1.46647047996521, -1.0236338376998901,
           -0.0690746158361435, -0.8107620477676392, -1.6463871002197266, -0.2399556040763855, 0.6631342172622681,
           0.44362306594848633, 0.7726876735687256, -0.6219781041145325, 1.5624059438705444, 0.7642450928688049,
           -0.49238571524620056, -0.28083646297454834, 0.5560213923454285, -0.46059650182724, -0.48516231775283813,
           -0.5954067707061768, 0.7137013077735901, -1.431862711906433, 0.25577041506767273, -0.12594379484653473,
           -1.5752665996551514, 0.0620756633579731, 0.5881884694099426, -0.2292267382144928, -0.4920179545879364,
           -1.1986490488052368, -1.3228580951690674, 0.06409686803817749, -1.241400957107544, -0.640629768371582,
           -0.8372498154640198, 0.8899884223937988, -1.1272145509719849, 0.5389597415924072, -1.8703866004943848,
           0.06575838476419449, -0.1584271490573883, 2.4052813053131104, -0.019920047372579575, -0.465132474899292,
           2.0648183822631836, -0.5919443368911743, 0.8763787150382996, -0.8161205649375916, -0.5900179147720337,
           -1.5283282995224, -0.9501939415931702, -2.4695913791656494, 1.8943709135055542, 0.4066821336746216,
           -2.4200565814971924, 1.523829460144043, 1.660575032234192, 0.38507625460624695, -1.757825255393982,
           -1.6783013343811035, 0.28436118364334106, -1.3775008916854858, 0.3347674310207367, -0.6381964683532715,
           0.7848567366600037, -0.9014673829078674, -1.7909364700317383, 0.6754924654960632, 1.713829517364502,
           0.8130753636360168, -0.3680477440357208, 1.2272769212722778, 0.8744205832481384, 1.7998498678207397,
           -1.1612155437469482, 0.052970170974731445, 1.4190340042114258, -0.863776445388794, -2.116030216217041,
           -0.4876578748226166, -1.2254055738449097, 1.2605866193771362, 0.6039904356002808, 0.7469522953033447,
           -1.149826169013977, 0.9879430532455444, -0.7388683557510376, -0.9862432479858398, -0.28326985239982605,
           -0.1543772965669632, 1.406888723373413, 0.5499476790428162, 0.6629598736763, 0.008160628378391266,
           1.1315652132034302, -0.09682313352823257, -0.7379975318908691, -0.47918829321861267, -0.6348602175712585,
           0.8539155721664429, -0.3796868324279785, -0.4886149764060974, 0.036986224353313446, 0.25776001811027527,
           -1.0038280487060547, 1.939399003982544, -0.03494131565093994, 1.0814577341079712, -0.45671346783638,
           0.3744440972805023, -1.8873335123062134, -1.1623902320861816, -0.6598474979400635, -0.005262402351945639,
           0.4442838132381439, -1.5508553981781006, 1.4603424072265625, -0.5268082022666931, 0.444683313369751,
           -1.2642446756362915, 0.02176046557724476, -2.080782651901245, -1.3852344751358032, 0.45080357789993286,
           -1.498164176940918, 0.4800260365009308, -0.07872679084539413, 1.4995282888412476, -2.6583237648010254,
           -0.04566967114806175, -0.5232121348381042, 0.7863665223121643, -1.4162713289260864, -0.9068817496299744,
           -0.39358749985694885, -0.1033983826637268, -0.4426826238632202, -0.3701987564563751, 0.46484071016311646,
           -1.1592304706573486, 1.089310884475708, 0.6503917574882507, 0.048166222870349884, -0.721057653427124};
      uint32_t vb[] = {3323534022u, 4045796544u, 1678510828u, 14055089u, 3152009u};
      size_t l = 150;
      REQUIRE(
          dot_prod_cb_enc<float /* 32 */, float /* 32 */, uint32_t>(va, vb, l) == Approx(-13.3201039066).epsilon(0.01));
    }
    {
      float va[] =
          {0.10723704099655151, 0.21919956803321838, 1.3659807443618774, -0.4488418996334076, -0.7682499289512634,
           0.2203424870967865, -1.577205777168274, -0.6966962814331055, 0.19614627957344055, 0.49097469449043274,
           0.10523717105388641, 1.3533318042755127, -1.9584176540374756, 0.7279053330421448, -0.9823160171508789,
           -0.5679135322570801, -1.4590407609939575, 0.5246896743774414, -0.38441726565361023, 2.9148945808410645,
           -0.29173508286476135, 0.673121452331543, 0.11291151493787766, -0.6329772472381592, 0.19057656824588776,
           -1.9342503547668457, -0.6753173470497131, -1.2086673974990845, 0.6019557118415833, 1.2262444496154785,
           0.3270740807056427, -0.2517622411251068, 0.8091893196105957, 0.6855369806289673, -0.5728387236595154,
           -0.406761109828949, -0.13758467137813568, 0.2016659528017044, 1.184880018234253, -0.7479353547096252,
           -0.9652087688446045, 0.5821967124938965, -0.04746372625231743, -0.6537209749221802, -0.3595612347126007,
           -0.3993404507637024, -1.6370717287063599, 0.15281888842582703, -0.3876846134662628, 0.8125661015510559,
           0.6708086133003235, -1.0776283740997314, 0.8359202742576599, 0.9457500576972961, 0.280070424079895,
           0.23459868133068085, 2.4086248874664307, -2.1688082218170166, 0.6812596917152405, 1.5479270219802856,
           -0.6749936938285828, 0.5289198756217957, 1.073970079421997, -2.102306604385376, -0.7934229969978333,
           -2.3928120136260986, -0.15885187685489655, 0.8691652417182922, -1.6431301832199097, 0.49231356382369995,
           -1.6364822387695312, -1.1940568685531616, 0.0354229137301445, 0.8654366731643677, -0.9805410504341125,
           -0.7922255396842957, -0.850202739238739, 0.5548660755157471, 1.539826512336731, -0.17765456438064575,
           0.44459956884384155, -1.1200200319290161, 0.6149035692214966, 0.13541488349437714, -0.7949910759925842,
           0.8568826913833618, 1.3336193561553955, 1.0850642919540405, 0.2953215539455414, 1.0185295343399048,
           -2.9070355892181396, 0.44938135147094727, -0.19568714499473572, -0.3234714865684509, -0.4777369499206543,
           0.33968010544776917, -0.8763520121574402, 0.3823929727077484, -1.4051055908203125, -0.4093177020549774,
           -0.30935022234916687, -0.5601223707199097, 0.5625602006912231, -0.6327877044677734, 0.7620760798454285,
           -0.42343559861183167, -0.6142889857292175, -0.7652859091758728, -0.11251621693372726, -1.693777322769165,
           -0.7746118307113647, 0.862370491027832, 0.2001972496509552, 0.5631580352783203, -1.6455391645431519,
           1.446468710899353, 1.4439516067504883, -1.1472653150558472, -0.8088603615760803, 1.3589820861816406,
           0.8902811408042908, 1.4635632038116455, 0.9127230048179626, -0.07228027284145355, 0.4661336839199066,
           1.2916908264160156, 1.368262529373169, -0.639879047870636, 1.0746098756790161, -1.1106353998184204,
           0.3080291748046875, -0.6161314249038696, -0.1002584770321846, 0.1739335060119629, -1.5104341506958008,
           -0.8870946168899536, 0.17513594031333923, -0.35011419653892517, -0.5154630541801453, -0.2677958905696869,
           -0.852888286113739, -1.327895998954773, -0.4121900498867035, 0.002615569857880473, -0.8657854199409485,
           0.4545370936393738, 0.0280538909137249, -0.7174674272537231, 0.14418940246105194, 0.32483091950416565};
      uint32_t vb[] = {278048412u, 1891184315u, 3888891710u, 2465480412u, 2620135u};
      size_t l = 150;
      REQUIRE(
          dot_prod_cb_enc<float /* 32 */, float /* 32 */, uint32_t>(va, vb, l) == Approx(-1.76168284682).epsilon(0.01));
    }
    {
      float va[] = {0.8246645331382751, -1.179986834526062, 1.6068605184555054, 1.0171163082122803, 0.8379333019256592,
                    -1.0298324823379517, -0.30224326252937317, 0.5123561024665833, 0.7174791693687439,
                    -0.5593371987342834, -1.0401722192764282, -0.42587020993232727, 0.44588741660118103,
                    0.6398097276687622, 0.14052295684814453, -0.5271514654159546, 0.38583773374557495,
                    0.6718323826789856, 1.6285468339920044, -0.703476071357727, 2.816124200820923, 0.8112891912460327,
                    1.4252450466156006, -1.4881038665771484, -2.4714598655700684, -1.5847774744033813,
                    0.0347665511071682, 0.7710974812507629, -0.3615211248397827, -0.15763655304908752,
                    0.07407459616661072, -0.8397436738014221, -1.240949034690857, -1.8911839723587036,
                    -0.07814602553844452, -1.3270933628082275, 0.6500844955444336, -0.8774845004081726,
                    -0.5866708159446716, -0.6438934803009033, -0.8238891959190369, -1.094407320022583,
                    -0.0555509589612484, -0.9133744239807129, -0.17069201171398163, 1.0405408143997192,
                    0.8276091814041138, -1.3795133829116821, 1.42295503616333, 0.4187866449356079, -1.1755121946334839,
                    -0.170963853597641, -1.24355947971344, 0.2387188971042633, 0.013406740501523018,
                    -0.09660705924034119, 0.9222248196601868, -0.5174229741096497, -0.15298107266426086,
                    -3.0359435081481934, 1.801347255706787, -0.2231457382440567, 0.4598968029022217, 1.0030574798583984,
                    0.9348678588867188, -0.9297111630439758, 0.7648716568946838, -1.0585005283355713,
                    0.2602502107620239, 0.8685921430587769, 0.6836794018745422, -0.3365696370601654, 0.8779500722885132,
                    0.4890923798084259, -0.360872358083725, -1.2938129901885986, -0.4129185974597931,
                    0.6612756252288818, -0.44045689702033997, 0.17971664667129517, -0.997698962688446,
                    1.7936733961105347, -2.269150495529175, -0.1529116928577423, -0.9026036858558655,
                    0.8230612277984619, 0.9713935852050781, -1.3648589849472046, -1.1418591737747192,
                    0.2568815350532532, -0.3025955259799957, -0.6638737916946411, -1.2813150882720947,
                    -0.9050002098083496, -0.37578222155570984, 0.30357667803764343, 1.1407161951065063,
                    -1.5308738946914673, -0.1038101390004158, -0.4794650971889496, -0.3983706831932068,
                    -1.2123934030532837, -0.027208857238292694, -0.5643746256828308, -1.5764975547790527,
                    -1.0246219635009766, 0.6487569808959961, 0.5817334651947021, 0.6191843152046204, 1.1372336149215698,
                    -1.2165566682815552, 1.1686931848526, 0.9681940078735352, 1.1255367994308472, -0.6580715775489807,
                    -0.3027190566062927, -0.7578690648078918, -0.7944903373718262, -1.5499370098114014,
                    -2.8432328701019287, -0.8536653518676758, 0.35726794600486755, -1.9653455018997192,
                    0.6911667585372925, 0.015039174817502499, -1.5416686534881592, -0.17405936121940613,
                    -0.5297228097915649, -0.2681019902229309, 1.0038342475891113, 0.7561191916465759,
                    -1.1164016723632812, 0.0886591449379921, -0.41157254576683044, 1.587242841720581,
                    1.6719380617141724, -0.7662686109542847, -0.5268591642379761, -0.38855209946632385,
                    0.5248019099235535, -1.0592700242996216, -1.7902958393096924, -1.4935662746429443,
                    2.3140041828155518, -1.4268884658813477, -1.254218578338623, -0.1722390502691269,
                    0.29391932487487793, -1.24201500415802, 0.6076359748840332};
      uint32_t vb[] = {4132816672u, 805752206u, 421755786u, 589048202u, 1628859u};
      size_t l = 150;
      REQUIRE(
          dot_prod_cb_enc<float /* 32 */, float /* 32 */, uint32_t>(va, vb, l) == Approx(14.2966363402).epsilon(0.01));
    }
    {
      float va[] =
          {-1.131658911705017, -0.26176539063453674, 1.7646689414978027, 1.568030595779419, -2.1811203956604004,
           -0.5100618004798889, 1.496334195137024, -0.7367172241210938, -0.11739837378263474, -1.3327387571334839,
           1.3426647186279297, 1.7924082279205322, 0.6971101760864258, 0.6719527244567871, -1.490140438079834,
           -0.016760114580392838, 0.8748282790184021, 0.5499153733253479, -1.2207783460617065, 0.4827461540699005,
           0.4077860713005066, -0.038748737424612045, -0.5756181478500366, 1.7215142250061035, -1.139754295349121,
           -1.3701361417770386, 0.7998844385147095, 2.239285707473755, 1.7115248441696167, 0.14025449752807617,
           0.25729843974113464, 0.20174311101436615, -0.5782992839813232, -1.4244904518127441, -0.08002111315727234,
           -0.40929844975471497, 0.4943775236606598, 2.129408836364746, 1.12091064453125, -1.0410524606704712,
           0.03323633223772049, -0.4634748101234436, -2.504390239715576, 0.19922006130218506, 2.4074461460113525,
           0.6295297741889954, -0.6340453624725342, -0.9532930850982666, 0.22476814687252045, -1.5400850772857666,
           -0.5632570385932922, 1.552486777305603, 0.551037073135376, 0.607683002948761, 0.8304253816604614,
           0.7543855309486389, 0.21590648591518402, 1.8189431428909302, 1.4852722883224487, -1.087419033050537,
           0.27359306812286377, -1.422135829925537, 0.3724251687526703, 2.225583076477051, -0.6961445808410645,
           -0.16042964160442352, 1.8667325973510742, -0.11331945657730103, 0.498150497674942, 0.4998320937156677,
           0.3852827548980713, 0.040819428861141205, -0.021996309980750084, 0.20835648477077484, -1.5694860219955444,
           0.16697749495506287, -0.6146028637886047, 0.25170502066612244, 0.9667471647262573, 1.3290871381759644,
           1.098606824874878, 0.4187690317630768, 0.6426644921302795, 0.7473685145378113, 0.6270793676376343,
           -0.3376079797744751, -0.7190769910812378, 0.0968770831823349, 0.884354829788208, -0.3081660270690918,
           -1.9621481895446777, 0.8788872957229614, 0.0179063081741333, 1.9786673784255981, 1.1261894702911377,
           -1.2308330535888672, -0.35923147201538086, -0.8666198253631592, -1.2524964809417725, -0.6229848861694336,
           -0.3179458677768707, 0.581775963306427, 0.6560372114181519, -0.07631038874387741, 0.5644214153289795,
           0.7197768092155457, 0.4209522008895874, -1.1301130056381226, -0.14558543264865875, 0.6383594870567322,
           -0.6542640924453735, 0.5391662120819092, 1.4584156274795532, -0.5472113490104675, 0.8274761438369751,
           1.2060093879699707, -0.6168203353881836, -0.9440392255783081, -1.7135692834854126, -0.3983902633190155,
           -1.8610479831695557, -0.9957407712936401, -0.2637765407562256, 1.091200351715088, -0.4549557864665985,
           0.7109982371330261, -1.4261752367019653, -2.1938750743865967, 1.3956204652786255, -1.119404673576355,
           1.3137617111206055, -0.9750045537948608, 0.6255135536193848, 0.6523202061653137, -0.11869915574789047,
           -0.14813734591007233, -0.368918240070343, -0.2876967489719391, 2.9303019046783447, -0.7009007334709167,
           0.04295765981078148, -0.10327759385108948, -0.2151138335466385, -0.7963290214538574, -0.6266170144081116,
           -1.146530270576477, 0.2911098897457123, 2.1718907356262207, 1.376017689704895, -1.4555022716522217};
      uint32_t vb[] = {4039466346u, 422006235u, 2978244804u, 1724031314u, 3251412u};
      size_t l = 150;
      REQUIRE(
          dot_prod_cb_enc<float /* 32 */, float /* 32 */, uint32_t>(va, vb, l) == Approx(14.0340959039).epsilon(0.01));
    }
    {
      float va[] =
          {-1.1972301006317139, 0.41284310817718506, -0.059574827551841736, -2.0432558059692383, -0.7582989931106567,
           0.19906401634216309, -0.8682848811149597, -2.2597806453704834, 0.9187836647033691, -1.0153460502624512,
           2.9833028316497803, 0.7242887616157532, -0.7155631184577942, 0.6627376675605774, 1.1429377794265747,
           -0.4306202828884125, 0.9698147773742676, 0.27937284111976624, 0.8201689720153809, -0.27522945404052734,
           0.8969979882240295, 0.4218517541885376, -2.52537202835083, 1.2705563306808472, -1.6004562377929688,
           0.9480574131011963, -0.20295946300029755, 1.689017415046692, -1.4634735584259033, 0.9336466789245605,
           2.129857063293457, 1.0153989791870117, 0.8584898114204407, -0.739649772644043, -0.117390476167202,
           1.0722812414169312, -0.06878712773323059, 0.5445242524147034, 0.505374550819397, 1.2590349912643433,
           -1.8205034732818604, -1.4504032135009766, 0.018839865922927856, -0.1193256601691246, -1.6705204248428345,
           -1.0677515268325806, 0.022739527747035027, -0.7581007480621338, 0.4829615652561188, 1.6532206535339355,
           2.0125937461853027, 0.927068293094635, -0.45384156703948975, 0.42746976017951965, 0.001390026998706162,
           1.3394372463226318, 2.0699172019958496, 0.22842973470687866, -1.5872035026550293, 0.5588769912719727,
           -1.2386959791183472, 1.177111029624939, -1.537903904914856, 1.291603922843933, -0.8689050078392029,
           1.2453606128692627, -1.0483784675598145, -1.3352619409561157, 0.651691734790802, -1.072668194770813,
           0.3841768503189087, 0.7608089447021484, -0.37826311588287354, 0.2320936918258667, -0.503849446773529,
           1.0846656560897827, -1.0755568742752075, 0.020430177450180054, 1.8351428508758545, -0.23214474320411682,
           -1.542525053024292, -0.920435905456543, -0.16439546644687653, -0.4813672602176666, -0.6891330480575562,
           -0.26847657561302185, 1.096042513847351, -1.7674510478973389, -0.33115246891975403, -0.5210577249526978,
           -0.7080449461936951, 0.5042480826377869, 0.8194389343261719, -0.7707656621932983, -0.013441251590847969,
           -1.5862557888031006, 1.3586682081222534, 1.1299585103988647, 0.6494468450546265, -1.3268201351165771,
           -0.4683401882648468, 2.198051691055298, 0.12238007038831711, -1.0335124731063843, -0.5324190855026245,
           0.07671569287776947, 0.7099124193191528, -0.8714156150817871, 0.3380340039730072, -0.7973141670227051,
           1.948678970336914, -2.309000253677368, 0.020788617432117462, 0.18098564445972443, -0.23934756219387054,
           0.39644405245780945, -0.06704980880022049, 0.790886640548706, 0.09070303291082382, -0.4187922775745392,
           0.10093163698911667, -1.6978646516799927, 0.11885736137628555, 0.012640668079257011, -0.8766210675239563,
           -1.1164207458496094, 0.7085944414138794, -0.9432826638221741, 0.3233964741230011, 1.7422984838485718,
           -0.20084747672080994, -1.3605998754501343, 0.19332477450370789, 1.6426409482955933, -1.907326340675354,
           -0.22893652319908142, -0.4862237572669983, -0.27084028720855713, 1.0999956130981445, 0.6286400556564331,
           -0.5244289636611938, -0.9632200598716736, 0.1639164239168167, 0.5586653351783752, -0.42037540674209595,
           -0.014582046307623386, 0.8588870167732239, -2.2565479278564453, 0.07718726992607117, 0.4183596670627594};
      uint32_t vb[] = {1889339501u, 878963564u, 3780695314u, 2938616663u, 4107299u};
      size_t l = 150;
      REQUIRE(
          dot_prod_cb_enc<float /* 32 */, float /* 32 */, uint32_t>(va, vb, l) == Approx(2.73113681853).epsilon(0.01));
    }
  }

  SECTION("int dot_prod_cb_enc(const int*, const uint64_t*, size_t), dim=64") {
    {
      int va[] =
          {255, 203, 8, 251, 0, 144, 182, 235, 191, 93, 212, 169, 219, 99, 246, 117, 216, 188, 203, 219, 189, 245, 251,
           223, 114, 113, 177, 25, 44, 38, 95, 87, 177, 97, 254, 25, 176, 16, 126, 29, 28, 155, 101, 19, 29, 110, 163,
           151, 245, 175, 111, 242, 82, 6, 5, 29, 233, 174, 169, 234, 235, 125, 94, 221};
      uint64_t vb[] = {11408127472356711137u};
      size_t l = 64;
      REQUIRE(dot_prod_cb_enc<int /* 64 */, int /* 64 */, uint64_t>(va, vb, l) == 589);
    }
    {
      int va[] =
          {13, 111, 239, 6, 190, 248, 99, 146, 32, 141, 247, 62, 32, 77, 156, 8, 97, 225, 190, 179, 180, 119, 156, 55,
           54, 167, 91, 164, 67, 96, 150, 44, 82, 151, 212, 233, 14, 211, 227, 238, 102, 183, 109, 185, 191, 158, 203,
           217, 119, 105, 206, 101, 21, 134, 22, 149, 235, 49, 156, 245, 154, 132, 87, 222};
      uint64_t vb[] = {1817233658141511938u};
      size_t l = 64;
      REQUIRE(dot_prod_cb_enc<int /* 64 */, int /* 64 */, uint64_t>(va, vb, l) == -2418);
    }
    {
      int va[] =
          {202, 249, 133, 168, 18, 25, 142, 143, 89, 234, 167, 133, 27, 165, 239, 218, 8, 208, 58, 224, 118, 144, 186,
           197, 248, 29, 214, 101, 23, 176, 70, 0, 90, 131, 193, 162, 133, 40, 25, 237, 199, 8, 38, 127, 131, 72, 16,
           139, 233, 223, 234, 254, 67, 2, 57, 12, 33, 140, 118, 60, 96, 208, 116, 14};
      uint64_t vb[] = {5330615772268672801u};
      size_t l = 64;
      REQUIRE(dot_prod_cb_enc<int /* 64 */, int /* 64 */, uint64_t>(va, vb, l) == -942);
    }
    {
      int va[] =
          {50, 199, 97, 57, 156, 22, 15, 240, 134, 42, 33, 79, 232, 226, 152, 183, 51, 169, 9, 234, 28, 238, 232, 182,
           108, 163, 160, 158, 213, 154, 255, 83, 245, 186, 120, 38, 180, 139, 118, 55, 182, 100, 213, 44, 37, 64, 89,
           136, 176, 25, 51, 24, 53, 244, 63, 41, 218, 17, 25, 245, 120, 122, 49, 91};
      uint64_t vb[] = {12837031649120177018u};
      size_t l = 64;
      REQUIRE(dot_prod_cb_enc<int /* 64 */, int /* 64 */, uint64_t>(va, vb, l) == -2138);
    }
    {
      int va[] =
          {207, 215, 142, 74, 18, 134, 113, 90, 182, 152, 39, 255, 115, 116, 234, 225, 25, 73, 100, 9, 181, 218, 25, 60,
           152, 207, 186, 62, 189, 194, 114, 168, 254, 160, 212, 157, 58, 192, 70, 53, 73, 207, 248, 91, 184, 1, 50,
           121, 155, 230, 248, 63, 57, 94, 119, 174, 99, 213, 255, 198, 99, 22, 117, 41};
      uint64_t vb[] = {15067231152069058743u};
      size_t l = 64;
      REQUIRE(dot_prod_cb_enc<int /* 64 */, int /* 64 */, uint64_t>(va, vb, l) == 1013);
    }
  }

  SECTION("int dot_prod_cb_enc(const int*, const uint64_t*, size_t), dim=128") {
    {
      int va[] =
          {187, 134, 161, 69, 103, 111, 206, 168, 165, 144, 196, 197, 11, 78, 77, 219, 28, 193, 123, 33, 30, 162, 186,
           63, 207, 188, 223, 12, 241, 193, 150, 112, 248, 155, 50, 61, 166, 180, 15, 208, 191, 240, 198, 143, 101, 94,
           215, 6, 141, 165, 235, 138, 47, 36, 198, 213, 61, 64, 233, 4, 190, 154, 53, 214, 243, 218, 46, 92, 61, 146,
           193, 15, 14, 207, 154, 190, 142, 131, 254, 129, 155, 198, 108, 186, 36, 176, 236, 1, 245, 172, 47, 43, 62,
           254, 118, 245, 139, 141, 47, 226, 73, 245, 232, 148, 226, 200, 56, 52, 60, 182, 55, 150, 213, 97, 14, 189,
           144, 136, 216, 251, 133, 214, 223, 103, 219, 253, 3, 110};
      uint64_t vb[] = {12161983576072729433u, 13828339732153667658u};
      size_t l = 128;
      REQUIRE(dot_prod_cb_enc<int /* 64 */, int /* 64 */, uint64_t>(va, vb, l) == -3128);
    }
    {
      int va[] =
          {84, 167, 178, 89, 185, 147, 155, 30, 210, 59, 153, 166, 255, 95, 226, 62, 63, 87, 181, 224, 235, 9, 157, 2,
           109, 24, 32, 192, 162, 227, 129, 126, 227, 84, 82, 159, 62, 121, 52, 138, 86, 77, 222, 46, 165, 219, 58, 181,
           223, 46, 122, 95, 56, 105, 113, 131, 202, 20, 163, 127, 171, 43, 45, 120, 48, 87, 182, 45, 103, 49, 120, 191,
           92, 250, 35, 62, 167, 183, 75, 192, 162, 222, 21, 218, 83, 134, 208, 245, 78, 195, 91, 103, 113, 36, 24, 207,
           244, 173, 39, 136, 194, 168, 13, 123, 221, 143, 59, 50, 196, 73, 11, 63, 211, 234, 242, 226, 186, 191, 128,
           50, 236, 43, 137, 225, 172, 87, 157, 92};
      uint64_t vb[] = {17857773965326133340u, 15264205846668360652u};
      size_t l = 128;
      REQUIRE(dot_prod_cb_enc<int /* 64 */, int /* 64 */, uint64_t>(va, vb, l) == 2035);
    }
    {
      int va[] =
          {131, 65, 30, 205, 184, 223, 16, 75, 176, 126, 6, 223, 42, 89, 137, 224, 127, 99, 97, 202, 222, 43, 142, 100,
           127, 35, 182, 84, 250, 221, 148, 27, 24, 105, 97, 129, 222, 179, 141, 222, 202, 250, 210, 238, 28, 202, 82,
           33, 237, 38, 7, 191, 15, 169, 224, 170, 179, 28, 100, 29, 124, 83, 25, 2, 14, 169, 84, 73, 215, 138, 190,
           219, 107, 211, 93, 85, 60, 148, 34, 17, 195, 202, 100, 255, 108, 164, 201, 42, 48, 77, 249, 29, 239, 80, 245,
           249, 38, 123, 83, 101, 231, 163, 243, 178, 226, 16, 184, 247, 120, 76, 150, 210, 109, 253, 58, 64, 75, 251,
           125, 178, 122, 154, 114, 229, 255, 109, 123, 8};
      uint64_t vb[] = {4317165962104745025u, 4118414988104515139u};
      size_t l = 128;
      REQUIRE(dot_prod_cb_enc<int /* 64 */, int /* 64 */, uint64_t>(va, vb, l) == -2481);
    }
    {
      int va[] =
          {223, 186, 118, 235, 228, 27, 55, 96, 98, 206, 120, 8, 14, 211, 79, 28, 156, 34, 109, 177, 46, 103, 166, 37,
           118, 100, 167, 96, 216, 200, 84, 86, 229, 148, 60, 96, 19, 10, 69, 59, 126, 161, 180, 178, 195, 198, 32, 232,
           3, 197, 38, 88, 63, 255, 8, 215, 28, 150, 228, 11, 180, 40, 200, 66, 105, 164, 226, 3, 223, 242, 107, 195,
           101, 186, 7, 40, 203, 166, 8, 216, 213, 82, 249, 136, 178, 177, 157, 74, 172, 134, 2, 197, 83, 90, 205, 7,
           206, 33, 60, 250, 98, 160, 147, 188, 207, 11, 194, 39, 52, 190, 181, 16, 156, 31, 32, 188, 189, 40, 160, 204,
           247, 248, 221, 128, 166, 234, 72, 217};
      uint64_t vb[] = {18231586577060337791u, 13264162014554120587u};
      size_t l = 128;
      REQUIRE(dot_prod_cb_enc<int /* 64 */, int /* 64 */, uint64_t>(va, vb, l) == -452);
    }
    {
      int va[] =
          {77, 118, 154, 5, 242, 212, 136, 221, 116, 194, 163, 116, 171, 144, 36, 217, 108, 104, 22, 216, 4, 180, 205,
           245, 33, 79, 243, 155, 219, 120, 134, 210, 92, 63, 67, 186, 190, 234, 192, 160, 198, 240, 158, 24, 27, 0, 42,
           71, 18, 221, 72, 110, 196, 211, 115, 57, 255, 85, 175, 155, 154, 80, 48, 199, 151, 122, 208, 75, 185, 176,
           10, 116, 154, 129, 91, 160, 54, 48, 240, 145, 206, 3, 88, 57, 142, 225, 248, 174, 225, 99, 13, 100, 165, 201,
           175, 101, 87, 172, 218, 86, 26, 12, 177, 145, 87, 218, 84, 130, 45, 156, 214, 110, 9, 194, 62, 63, 227, 69,
           64, 85, 209, 247, 173, 60, 31, 124, 49, 133};
      uint64_t vb[] = {3933016721879878495u, 7806903728060465946u};
      size_t l = 128;
      REQUIRE(dot_prod_cb_enc<int /* 64 */, int /* 64 */, uint64_t>(va, vb, l) == 1172);
    }
  }

  SECTION("int dot_prod_cb_enc(const int*, const uint64_t*, size_t), dim=256") {
    {
      int va[] =
          {127, 16, 235, 152, 191, 26, 178, 135, 57, 154, 25, 213, 146, 202, 104, 218, 213, 93, 217, 9, 23, 198, 66, 58,
           91, 242, 238, 12, 68, 14, 45, 25, 34, 38, 17, 217, 17, 177, 35, 255, 246, 69, 157, 107, 75, 155, 232, 137,
           158, 125, 102, 179, 127, 2, 11, 236, 54, 96, 136, 111, 57, 220, 44, 146, 83, 145, 230, 237, 160, 1, 113, 20,
           195, 100, 227, 241, 200, 3, 56, 231, 35, 191, 172, 197, 245, 240, 204, 130, 245, 152, 194, 130, 65, 88, 135,
           159, 145, 91, 178, 153, 68, 15, 206, 246, 198, 31, 114, 25, 149, 33, 120, 44, 106, 199, 38, 86, 23, 252, 217,
           247, 21, 83, 211, 112, 125, 231, 231, 81, 198, 53, 159, 0, 14, 65, 39, 22, 53, 185, 138, 68, 152, 3, 7, 36,
           88, 93, 58, 76, 104, 41, 96, 195, 16, 110, 164, 57, 20, 186, 227, 235, 119, 47, 56, 175, 197, 242, 2, 150,
           183, 132, 133, 15, 151, 191, 78, 233, 204, 120, 2, 42, 126, 140, 82, 88, 80, 231, 29, 45, 72, 170, 93, 51,
           54, 186, 141, 207, 134, 235, 24, 108, 245, 119, 255, 224, 173, 125, 101, 188, 97, 209, 92, 86, 235, 101, 13,
           157, 253, 64, 73, 137, 204, 212, 188, 147, 157, 23, 61, 34, 190, 132, 200, 139, 50, 233, 198, 215, 251, 18,
           50, 173, 219, 214, 150, 247, 250, 86, 163, 65, 137, 125, 128, 79, 9, 215, 250, 65};
      uint64_t vb[] = {5259828330856296302u, 6426346043380800474u, 2149738820351291196u, 3505686883187880100u};
      size_t l = 256;
      REQUIRE(dot_prod_cb_enc<int /* 64 */, int /* 64 */, uint64_t>(va, vb, l) == 2088);
    }
    {
      int va[] =
          {90, 65, 212, 95, 124, 144, 166, 120, 109, 161, 185, 105, 14, 155, 74, 146, 85, 137, 170, 17, 165, 63, 12,
           241, 226, 56, 185, 249, 105, 233, 84, 99, 176, 53, 28, 192, 35, 161, 189, 129, 70, 186, 8, 221, 57, 76, 127,
           140, 63, 251, 138, 140, 127, 180, 246, 131, 144, 180, 84, 34, 11, 153, 251, 113, 206, 118, 151, 72, 228, 11,
           229, 235, 158, 82, 198, 201, 227, 4, 143, 105, 1, 108, 238, 90, 10, 112, 20, 234, 131, 71, 69, 46, 244, 173,
           67, 114, 2, 102, 16, 22, 204, 155, 141, 184, 140, 231, 253, 107, 246, 61, 175, 179, 189, 115, 55, 110, 41,
           244, 115, 34, 155, 6, 232, 209, 31, 77, 212, 13, 36, 130, 28, 150, 5, 172, 223, 154, 48, 40, 119, 72, 5, 142,
           115, 80, 51, 167, 45, 213, 180, 168, 101, 105, 54, 226, 152, 166, 17, 167, 76, 125, 35, 236, 223, 218, 96,
           190, 170, 4, 254, 165, 198, 31, 254, 69, 38, 116, 247, 47, 120, 89, 6, 108, 37, 93, 144, 139, 254, 33, 181,
           57, 251, 38, 238, 63, 88, 225, 81, 26, 94, 15, 17, 158, 5, 159, 3, 242, 5, 99, 62, 83, 166, 108, 125, 203,
           37, 173, 199, 155, 28, 232, 198, 224, 232, 25, 139, 94, 109, 140, 144, 40, 174, 222, 26, 51, 102, 90, 165,
           228, 54, 7, 211, 234, 176, 184, 18, 99, 245, 242, 130, 51, 18, 131, 11, 19, 237, 49};
      uint64_t vb[] = {9813504320438323332u, 586930242190397994u, 7754964771092418836u, 3268176194956003928u};
      size_t l = 256;
      REQUIRE(dot_prod_cb_enc<int /* 64 */, int /* 64 */, uint64_t>(va, vb, l) == -3689);
    }
    {
      int va[] =
          {38, 115, 152, 220, 39, 91, 246, 165, 222, 7, 245, 220, 60, 209, 153, 105, 53, 129, 76, 70, 148, 86, 250, 170,
           49, 67, 208, 247, 110, 234, 32, 207, 189, 170, 165, 202, 12, 100, 85, 248, 176, 255, 57, 209, 249, 85, 189,
           197, 184, 0, 197, 195, 135, 122, 56, 54, 9, 116, 7, 158, 92, 67, 15, 142, 230, 151, 113, 216, 165, 147, 242,
           151, 160, 89, 131, 59, 108, 106, 239, 160, 224, 7, 154, 66, 4, 139, 201, 128, 28, 95, 38, 61, 26, 111, 200,
           238, 211, 109, 142, 116, 235, 183, 132, 178, 12, 29, 140, 110, 186, 9, 45, 25, 55, 148, 99, 116, 189, 224,
           129, 134, 117, 48, 99, 59, 233, 122, 208, 107, 96, 65, 214, 239, 77, 147, 74, 225, 77, 101, 21, 118, 55, 114,
           242, 35, 62, 243, 252, 22, 189, 229, 97, 148, 108, 197, 71, 238, 12, 164, 174, 206, 98, 87, 0, 113, 104, 74,
           179, 248, 76, 20, 194, 139, 169, 57, 90, 132, 154, 146, 131, 79, 205, 49, 190, 3, 225, 73, 208, 223, 206,
           143, 190, 165, 221, 28, 77, 222, 85, 157, 8, 174, 32, 16, 241, 78, 100, 37, 125, 68, 173, 62, 116, 50, 91,
           40, 220, 100, 110, 178, 65, 47, 16, 102, 209, 163, 215, 17, 12, 97, 28, 226, 202, 177, 117, 154, 24, 43, 228,
           184, 230, 112, 40, 226, 99, 247, 226, 71, 65, 45, 225, 101, 223, 92, 24, 81, 48, 140};
      uint64_t vb[] = {433923231983713492u, 15215421259794606393u, 14851787324779566874u, 17919817290315769025u};
      size_t l = 256;
      REQUIRE(dot_prod_cb_enc<int /* 64 */, int /* 64 */, uint64_t>(va, vb, l) == -646);
    }
    {
      int va[] =
          {104, 103, 98, 154, 193, 30, 70, 125, 107, 134, 108, 159, 200, 18, 95, 67, 164, 153, 122, 57, 234, 31, 98,
           177, 122, 207, 40, 119, 98, 31, 38, 130, 238, 110, 234, 103, 98, 172, 140, 241, 19, 145, 223, 64, 15, 208,
           72, 0, 128, 176, 35, 198, 224, 163, 131, 253, 201, 87, 71, 45, 87, 38, 12, 197, 223, 158, 52, 142, 93, 70,
           29, 35, 92, 136, 49, 57, 86, 239, 139, 232, 227, 48, 249, 207, 9, 127, 65, 28, 191, 222, 20, 171, 145, 247,
           207, 197, 185, 115, 84, 44, 19, 72, 26, 206, 0, 157, 171, 247, 206, 72, 205, 38, 42, 187, 79, 223, 81, 8, 29,
           122, 167, 83, 84, 203, 138, 130, 124, 182, 55, 73, 61, 14, 168, 184, 225, 201, 79, 244, 61, 160, 224, 90, 38,
           217, 206, 127, 76, 95, 98, 154, 115, 33, 18, 134, 83, 189, 162, 10, 169, 38, 36, 34, 103, 129, 219, 31, 27,
           146, 59, 100, 95, 238, 81, 95, 8, 64, 209, 252, 118, 226, 29, 192, 110, 109, 188, 222, 29, 67, 185, 167, 144,
           208, 88, 217, 109, 172, 94, 152, 9, 58, 185, 167, 222, 232, 118, 115, 196, 183, 129, 219, 23, 105, 60, 237,
           38, 33, 136, 226, 136, 57, 144, 144, 81, 58, 237, 67, 103, 159, 173, 213, 33, 168, 119, 21, 100, 123, 15,
           189, 95, 192, 152, 5, 195, 4, 118, 40, 187, 129, 26, 50, 12, 226, 236, 183, 77, 191};
      uint64_t vb[] = {2267923650610050059u, 8875384249731015938u, 34231571943180886u, 7013726407766552092u};
      size_t l = 256;
      REQUIRE(dot_prod_cb_enc<int /* 64 */, int /* 64 */, uint64_t>(va, vb, l) == 233);
    }
    {
      int va[] =
          {41, 83, 190, 234, 186, 193, 90, 100, 242, 196, 159, 234, 76, 38, 14, 96, 125, 98, 80, 150, 174, 234, 144,
           100, 94, 146, 1, 2, 46, 118, 37, 94, 253, 40, 179, 160, 146, 59, 82, 56, 37, 137, 204, 168, 210, 97, 172,
           165, 170, 120, 79, 192, 18, 207, 140, 50, 132, 105, 186, 163, 175, 171, 103, 85, 174, 111, 31, 45, 0, 102,
           82, 83, 7, 90, 180, 33, 147, 14, 209, 111, 175, 99, 230, 187, 146, 23, 158, 136, 206, 169, 197, 117, 208,
           229, 110, 40, 91, 131, 36, 81, 220, 77, 73, 41, 107, 127, 216, 100, 177, 94, 156, 35, 15, 166, 243, 171, 255,
           77, 226, 179, 96, 94, 58, 144, 232, 243, 74, 90, 125, 255, 145, 237, 18, 204, 184, 102, 44, 141, 60, 100, 14,
           18, 127, 63, 252, 46, 45, 186, 52, 9, 207, 71, 176, 71, 44, 102, 24, 102, 207, 232, 20, 98, 249, 208, 13, 66,
           181, 116, 109, 121, 207, 235, 184, 69, 63, 189, 51, 50, 251, 149, 53, 214, 24, 81, 186, 6, 65, 253, 227, 184,
           35, 228, 9, 62, 42, 250, 128, 180, 63, 69, 135, 15, 180, 15, 7, 215, 59, 107, 252, 150, 67, 190, 161, 218,
           146, 2, 109, 122, 50, 34, 37, 89, 88, 199, 34, 87, 137, 138, 209, 160, 29, 87, 10, 71, 24, 49, 122, 26, 65,
           251, 192, 36, 205, 1, 155, 199, 234, 123, 0, 159, 16, 8, 180, 84, 214, 161};
      uint64_t vb[] = {14211820112069809407u, 8522973371336727411u, 10522118542554415262u, 776612543923667077u};
      size_t l = 256;
      REQUIRE(dot_prod_cb_enc<int /* 64 */, int /* 64 */, uint64_t>(va, vb, l) == -1226);
    }
  }

  SECTION("int dot_prod_cb_enc(const int*, const uint64_t*, size_t), dim=60") {
    {
      int va[] =
          {150, 18, 254, 117, 195, 128, 33, 181, 73, 123, 81, 207, 62, 176, 48, 129, 78, 132, 253, 59, 160, 117, 67,
           160, 204, 187, 98, 127, 82, 27, 11, 35, 164, 132, 243, 34, 141, 114, 121, 197, 67, 141, 142, 159, 50, 141,
           97, 56, 14, 222, 188, 226, 118, 241, 198, 45, 4, 75, 212, 123};
      uint64_t vb[] = {949793339051044249u};
      size_t l = 60;
      REQUIRE(dot_prod_cb_enc<int /* 64 */, int /* 64 */, uint64_t>(va, vb, l) == -1853);
    }
    {
      int va[] =
          {49, 255, 32, 235, 245, 170, 19, 199, 245, 227, 48, 136, 88, 19, 1, 198, 169, 71, 141, 184, 244, 163, 2, 64,
           78, 75, 4, 233, 54, 206, 233, 145, 242, 183, 99, 95, 122, 14, 5, 245, 138, 69, 238, 41, 82, 179, 3, 233, 188,
           192, 77, 161, 153, 166, 71, 129, 41, 191, 160, 220};
      uint64_t vb[] = {391087898603073368u};
      size_t l = 60;
      REQUIRE(dot_prod_cb_enc<int /* 64 */, int /* 64 */, uint64_t>(va, vb, l) == -113);
    }
    {
      int va[] =
          {249, 189, 9, 254, 62, 124, 54, 166, 224, 160, 41, 123, 206, 77, 233, 199, 202, 45, 7, 34, 239, 179, 131, 51,
           162, 48, 241, 142, 181, 197, 141, 202, 124, 183, 169, 102, 81, 57, 98, 77, 65, 62, 223, 32, 81, 27, 160, 181,
           150, 53, 229, 171, 6, 48, 132, 72, 241, 71, 228, 3};
      uint64_t vb[] = {1023284350185794668u};
      size_t l = 60;
      REQUIRE(dot_prod_cb_enc<int /* 64 */, int /* 64 */, uint64_t>(va, vb, l) == 234);
    }
    {
      int va[] =
          {106, 186, 234, 216, 73, 31, 247, 223, 238, 20, 81, 119, 19, 72, 163, 128, 99, 213, 222, 250, 221, 184, 139,
           83, 56, 246, 155, 153, 83, 29, 32, 54, 187, 32, 199, 235, 20, 115, 161, 235, 147, 89, 46, 49, 18, 80, 88,
           135, 81, 246, 128, 5, 50, 50, 14, 90, 228, 251, 96, 45};
      uint64_t vb[] = {1067296921622790694u};
      size_t l = 60;
      REQUIRE(dot_prod_cb_enc<int /* 64 */, int /* 64 */, uint64_t>(va, vb, l) == 851);
    }
    {
      int va[] =
          {218, 127, 17, 22, 252, 231, 151, 234, 48, 177, 55, 15, 248, 232, 107, 40, 119, 13, 120, 223, 79, 229, 62,
           111, 233, 101, 35, 179, 12, 1, 221, 152, 7, 216, 22, 48, 86, 232, 220, 248, 7, 115, 210, 223, 181, 176, 65,
           92, 65, 58, 106, 4, 18, 230, 191, 218, 203, 0, 23, 226};
      uint64_t vb[] = {192891380097432044u};
      size_t l = 60;
      REQUIRE(dot_prod_cb_enc<int /* 64 */, int /* 64 */, uint64_t>(va, vb, l) == 104);
    }
  }

  SECTION("int dot_prod_cb_enc(const int*, const uint64_t*, size_t), dim=59") {
    {
      int va[] =
          {90, 167, 198, 168, 223, 93, 221, 247, 141, 145, 223, 92, 50, 86, 163, 203, 109, 45, 42, 87, 144, 83, 225,
           141, 10, 163, 228, 85, 99, 194, 77, 143, 236, 152, 49, 252, 10, 5, 50, 206, 209, 42, 162, 89, 237, 246, 251,
           43, 69, 142, 19, 254, 59, 152, 141, 230, 107, 181, 247};
      uint64_t vb[] = {435425736890824541u};
      size_t l = 59;
      REQUIRE(dot_prod_cb_enc<int /* 64 */, int /* 64 */, uint64_t>(va, vb, l) == -1037);
    }
    {
      int va[] =
          {86, 103, 251, 147, 24, 121, 223, 107, 34, 108, 239, 45, 125, 102, 168, 219, 0, 74, 170, 82, 82, 52, 229, 206,
           96, 185, 217, 7, 250, 53, 157, 209, 240, 233, 7, 148, 244, 199, 166, 200, 55, 158, 62, 185, 219, 33, 5, 126,
           38, 114, 235, 59, 219, 45, 49, 204, 204, 254, 9};
      uint64_t vb[] = {362623986687983570u};
      size_t l = 59;
      REQUIRE(dot_prod_cb_enc<int /* 64 */, int /* 64 */, uint64_t>(va, vb, l) == -841);
    }
    {
      int va[] =
          {14, 207, 214, 54, 66, 212, 224, 0, 37, 174, 17, 10, 232, 79, 250, 147, 172, 235, 181, 204, 199, 154, 216, 19,
           164, 123, 196, 215, 70, 224, 76, 7, 205, 169, 89, 185, 167, 122, 193, 76, 246, 199, 62, 89, 140, 187, 55,
           116, 154, 123, 222, 128, 113, 83, 40, 19, 81, 140, 77};
      uint64_t vb[] = {160239272148695813u};
      size_t l = 59;
      REQUIRE(dot_prod_cb_enc<int /* 64 */, int /* 64 */, uint64_t>(va, vb, l) == 736);
    }
    {
      int va[] =
          {44, 76, 91, 144, 225, 64, 10, 239, 245, 138, 174, 149, 185, 45, 243, 185, 65, 162, 156, 108, 165, 73, 159,
           26, 194, 118, 247, 89, 220, 36, 8, 222, 3, 223, 129, 165, 117, 148, 123, 49, 88, 0, 250, 76, 190, 162, 96,
           48, 207, 143, 109, 159, 14, 76, 151, 140, 201, 220, 175};
      uint64_t vb[] = {193178086259361742u};
      size_t l = 59;
      REQUIRE(dot_prod_cb_enc<int /* 64 */, int /* 64 */, uint64_t>(va, vb, l) == 789);
    }
    {
      int va[] =
          {216, 62, 49, 204, 210, 154, 219, 157, 91, 55, 216, 61, 175, 35, 233, 87, 44, 224, 218, 26, 137, 27, 164, 17,
           212, 13, 32, 35, 78, 216, 106, 52, 70, 220, 10, 168, 194, 220, 234, 191, 202, 66, 196, 112, 240, 41, 253,
           196, 249, 138, 117, 221, 134, 188, 104, 49, 148, 50, 160};
      uint64_t vb[] = {124680694583353121u};
      size_t l = 59;
      REQUIRE(dot_prod_cb_enc<int /* 64 */, int /* 64 */, uint64_t>(va, vb, l) == 2532);
    }
  }

  SECTION("int dot_prod_cb_enc(const int*, const uint64_t*, size_t), dim=100") {
    {
      int va[] =
          {94, 149, 219, 129, 166, 25, 162, 23, 44, 217, 205, 231, 176, 92, 137, 230, 91, 110, 17, 82, 18, 43, 53, 82,
           188, 30, 183, 226, 232, 118, 44, 129, 86, 41, 96, 183, 60, 143, 82, 103, 53, 96, 200, 171, 221, 246, 51, 84,
           213, 68, 0, 113, 34, 98, 102, 47, 126, 185, 187, 7, 116, 104, 70, 176, 47, 27, 42, 223, 143, 253, 52, 238,
           141, 56, 100, 160, 4, 109, 220, 135, 217, 194, 109, 144, 65, 237, 222, 227, 177, 167, 41, 49, 232, 160, 140,
           238, 217, 180, 169, 93};
      uint64_t vb[] = {8421445215997283429u, 15615771887u};
      size_t l = 100;
      REQUIRE(dot_prod_cb_enc<int /* 64 */, int /* 64 */, uint64_t>(va, vb, l) == 1369);
    }
    {
      int va[] =
          {19, 20, 149, 148, 87, 107, 170, 34, 67, 142, 48, 149, 249, 176, 183, 205, 143, 59, 211, 245, 41, 94, 23, 76,
           119, 60, 175, 255, 55, 109, 230, 60, 37, 159, 202, 178, 36, 228, 100, 251, 162, 233, 115, 236, 79, 95, 65,
           64, 84, 141, 166, 2, 21, 190, 253, 203, 71, 42, 145, 56, 201, 31, 69, 51, 179, 200, 10, 55, 76, 65, 176, 89,
           100, 142, 239, 34, 131, 31, 82, 2, 40, 208, 55, 101, 161, 22, 61, 7, 189, 187, 101, 93, 36, 7, 186, 28, 56,
           26, 249, 52};
      uint64_t vb[] = {16376607820301398584u, 26831702442u};
      size_t l = 100;
      REQUIRE(dot_prod_cb_enc<int /* 64 */, int /* 64 */, uint64_t>(va, vb, l) == 508);
    }
    {
      int va[] =
          {47, 152, 35, 199, 140, 251, 134, 40, 95, 70, 39, 187, 234, 106, 179, 181, 15, 121, 228, 149, 195, 155, 82,
           160, 33, 233, 29, 235, 71, 217, 141, 46, 211, 202, 247, 68, 11, 57, 73, 14, 34, 72, 178, 184, 33, 124, 82,
           146, 91, 216, 44, 89, 136, 0, 80, 247, 242, 4, 157, 25, 224, 156, 198, 53, 209, 183, 224, 32, 37, 70, 77,
           228, 48, 227, 127, 180, 85, 173, 135, 59, 144, 235, 88, 91, 50, 197, 137, 212, 3, 182, 242, 48, 30, 195, 237,
           66, 206, 155, 73, 32};
      uint64_t vb[] = {14278621907033737714u, 12238211295u};
      size_t l = 100;
      REQUIRE(dot_prod_cb_enc<int /* 64 */, int /* 64 */, uint64_t>(va, vb, l) == 530);
    }
    {
      int va[] =
          {127, 91, 69, 9, 80, 196, 246, 50, 99, 149, 85, 246, 159, 188, 21, 164, 217, 205, 183, 54, 52, 74, 125, 250,
           200, 94, 62, 250, 37, 204, 15, 13, 75, 34, 114, 21, 24, 239, 213, 25, 29, 254, 73, 63, 197, 3, 188, 95, 19,
           202, 50, 40, 185, 34, 113, 160, 103, 65, 201, 66, 62, 170, 40, 146, 220, 109, 107, 241, 229, 75, 21, 171,
           182, 9, 18, 89, 133, 105, 76, 171, 185, 91, 171, 44, 224, 1, 129, 130, 191, 75, 73, 245, 154, 223, 12, 72,
           173, 128, 185, 142};
      uint64_t vb[] = {3310482020520283379u, 45328427614u};
      size_t l = 100;
      REQUIRE(dot_prod_cb_enc<int /* 64 */, int /* 64 */, uint64_t>(va, vb, l) == 2085);
    }
    {
      int va[] =
          {23, 247, 242, 252, 148, 44, 212, 172, 254, 81, 86, 47, 218, 227, 124, 41, 25, 119, 66, 211, 167, 22, 244,
           132, 106, 150, 222, 113, 163, 16, 233, 182, 95, 173, 73, 8, 133, 142, 139, 67, 116, 164, 174, 131, 128, 52,
           65, 174, 109, 75, 141, 2, 192, 12, 136, 237, 49, 18, 220, 208, 213, 153, 208, 57, 79, 128, 185, 9, 157, 27,
           8, 181, 150, 213, 80, 97, 148, 148, 10, 205, 148, 51, 176, 49, 150, 42, 99, 59, 15, 230, 12, 187, 139, 248,
           124, 128, 104, 140, 255, 159};
      uint64_t vb[] = {5125628278187404725u, 50576980724u};
      size_t l = 100;
      REQUIRE(dot_prod_cb_enc<int /* 64 */, int /* 64 */, uint64_t>(va, vb, l) == 67);
    }
  }

  SECTION("int dot_prod_cb_enc(const int*, const uint64_t*, size_t), dim=119") {
    {
      int va[] =
          {199, 100, 5, 20, 214, 164, 168, 184, 246, 46, 32, 90, 183, 108, 42, 24, 134, 22, 204, 12, 213, 195, 141, 99,
           252, 190, 108, 81, 162, 212, 40, 100, 91, 140, 254, 146, 169, 179, 193, 14, 233, 159, 110, 157, 113, 81, 91,
           220, 255, 61, 223, 171, 84, 131, 225, 58, 140, 154, 199, 166, 24, 93, 15, 152, 15, 1, 168, 247, 99, 102, 10,
           39, 24, 246, 102, 121, 252, 102, 13, 53, 21, 167, 149, 125, 97, 87, 237, 184, 243, 126, 213, 100, 23, 245,
           42, 59, 5, 49, 132, 251, 91, 35, 51, 206, 122, 235, 47, 201, 108, 252, 185, 166, 249, 37, 39, 16, 108, 167,
           178};
      uint64_t vb[] = {2728528993108170190u, 25008933387107084u};
      size_t l = 119;
      REQUIRE(dot_prod_cb_enc<int /* 64 */, int /* 64 */, uint64_t>(va, vb, l) == 1353);
    }
    {
      int va[] =
          {147, 239, 63, 221, 52, 1, 195, 196, 191, 131, 30, 34, 112, 87, 131, 208, 163, 227, 209, 17, 143, 192, 112,
           109, 45, 255, 244, 151, 65, 142, 245, 54, 129, 81, 185, 49, 129, 1, 76, 89, 71, 130, 174, 156, 236, 99, 136,
           247, 192, 55, 243, 212, 137, 22, 162, 93, 48, 17, 112, 25, 114, 49, 140, 80, 196, 218, 39, 54, 99, 103, 177,
           104, 104, 110, 5, 251, 171, 119, 225, 231, 17, 42, 103, 126, 32, 160, 105, 77, 243, 160, 69, 116, 191, 197,
           83, 173, 236, 133, 31, 20, 10, 14, 204, 103, 128, 107, 191, 79, 24, 246, 236, 187, 243, 116, 154, 244, 22,
           221, 245};
      uint64_t vb[] = {10609114393950395720u, 21718556600352391u};
      size_t l = 119;
      REQUIRE(dot_prod_cb_enc<int /* 64 */, int /* 64 */, uint64_t>(va, vb, l) == -90);
    }
    {
      int va[] =
          {33, 214, 31, 26, 18, 113, 86, 247, 11, 4, 220, 92, 97, 35, 124, 226, 188, 187, 43, 223, 127, 122, 208, 188,
           189, 153, 100, 45, 109, 39, 197, 85, 127, 247, 172, 137, 171, 83, 78, 155, 88, 102, 74, 29, 201, 6, 132, 207,
           100, 147, 78, 243, 108, 157, 24, 137, 235, 241, 194, 74, 97, 128, 118, 156, 107, 60, 178, 9, 21, 26, 242, 48,
           145, 124, 209, 187, 41, 95, 205, 80, 47, 109, 218, 151, 101, 21, 226, 244, 144, 126, 71, 41, 220, 207, 131,
           31, 45, 11, 19, 214, 106, 166, 40, 77, 149, 0, 222, 127, 67, 159, 182, 12, 38, 191, 35, 244, 38, 218, 144};
      uint64_t vb[] = {9502561778819979764u, 18717572704455415u};
      size_t l = 119;
      REQUIRE(dot_prod_cb_enc<int /* 64 */, int /* 64 */, uint64_t>(va, vb, l) == 695);
    }
    {
      int va[] =
          {217, 2, 211, 39, 138, 230, 213, 194, 216, 19, 171, 76, 96, 72, 211, 31, 149, 239, 119, 68, 24, 224, 154, 90,
           41, 44, 206, 52, 8, 100, 6, 58, 106, 157, 149, 40, 255, 6, 180, 55, 204, 66, 49, 114, 255, 47, 91, 123, 90,
           101, 160, 7, 205, 14, 105, 201, 44, 136, 236, 133, 248, 21, 131, 190, 124, 22, 72, 250, 17, 209, 117, 233,
           53, 141, 121, 209, 60, 26, 83, 32, 254, 10, 87, 153, 168, 86, 70, 234, 81, 59, 190, 178, 192, 173, 99, 17,
           67, 88, 181, 245, 199, 240, 68, 29, 187, 247, 107, 115, 199, 189, 61, 10, 59, 221, 239, 232, 77, 16, 152};
      uint64_t vb[] = {3488750486302916287u, 17022402396429258u};
      size_t l = 119;
      REQUIRE(dot_prod_cb_enc<int /* 64 */, int /* 64 */, uint64_t>(va, vb, l) == -1905);
    }
    {
      int va[] =
          {66, 7, 68, 188, 217, 10, 158, 180, 106, 240, 13, 34, 204, 22, 233, 4, 121, 127, 192, 52, 157, 21, 240, 195,
           39, 32, 118, 15, 4, 211, 40, 220, 184, 208, 61, 138, 137, 132, 109, 215, 29, 172, 149, 19, 226, 170, 16, 86,
           130, 229, 141, 195, 215, 184, 24, 25, 154, 35, 4, 1, 64, 235, 163, 205, 156, 33, 136, 131, 222, 171, 249,
           126, 72, 35, 11, 159, 97, 111, 77, 95, 45, 16, 22, 132, 123, 157, 252, 245, 176, 89, 154, 63, 225, 22, 143,
           223, 72, 64, 184, 50, 101, 223, 15, 26, 170, 36, 121, 106, 85, 131, 199, 139, 167, 74, 130, 17, 67, 25, 206};
      uint64_t vb[] = {954794090601372614u, 12992076600125665u};
      size_t l = 119;
      REQUIRE(dot_prod_cb_enc<int /* 64 */, int /* 64 */, uint64_t>(va, vb, l) == -251);
    }
  }

  SECTION("int dot_prod_cb_enc(const int*, const uint64_t*, size_t), dim=24") {
    {
      int va[] =
          {196, 47, 108, 72, 22, 255, 186, 202, 23, 36, 250, 16, 114, 67, 100, 138, 198, 243, 51, 33, 92, 204, 33, 81};
      uint64_t vb[] = {13705697u};
      size_t l = 24;
      REQUIRE(dot_prod_cb_enc<int /* 64 */, int /* 64 */, uint64_t>(va, vb, l) == 189);
    }
    {
      int va[] =
          {120, 8, 81, 184, 53, 141, 226, 36, 182, 197, 80, 18, 58, 55, 185, 85, 2, 184, 149, 172, 253, 220, 206, 98};
      uint64_t vb[] = {13337776u};
      size_t l = 24;
      REQUIRE(dot_prod_cb_enc<int /* 64 */, int /* 64 */, uint64_t>(va, vb, l) == -987);
    }
    {
      int va[] =
          {29, 70, 32, 82, 67, 171, 123, 238, 96, 92, 87, 108, 226, 115, 197, 115, 135, 42, 179, 119, 211, 231, 228,
           141};
      uint64_t vb[] = {13600933u};
      size_t l = 24;
      REQUIRE(dot_prod_cb_enc<int /* 64 */, int /* 64 */, uint64_t>(va, vb, l) == 278);
    }
    {
      int va[] =
          {143, 219, 174, 228, 89, 115, 200, 70, 144, 142, 128, 55, 55, 5, 230, 90, 243, 202, 99, 190, 2, 137, 146, 37};
      uint64_t vb[] = {12296550u};
      size_t l = 24;
      REQUIRE(dot_prod_cb_enc<int /* 64 */, int /* 64 */, uint64_t>(va, vb, l) == 557);
    }
    {
      int va[] = {121, 69, 196, 221, 77, 23, 45, 99, 89, 55, 112, 96, 15, 110, 20, 225, 5, 59, 98, 11, 75, 175, 18, 92};
      uint64_t vb[] = {13598933u};
      size_t l = 24;
      REQUIRE(dot_prod_cb_enc<int /* 64 */, int /* 64 */, uint64_t>(va, vb, l) == -376);
    }
  }

  SECTION("int dot_prod_cb_enc(const int*, const uint64_t*, size_t), dim=23") {
    {
      int va[] =
          {189, 4, 123, 89, 198, 27, 126, 197, 63, 89, 219, 21, 14, 102, 127, 230, 213, 229, 127, 213, 163, 128, 244};
      uint64_t vb[] = {7393962u};
      size_t l = 23;
      REQUIRE(dot_prod_cb_enc<int /* 64 */, int /* 64 */, uint64_t>(va, vb, l) == 259);
    }
    {
      int va[] =
          {88, 109, 89, 93, 148, 239, 177, 185, 209, 202, 196, 163, 64, 95, 29, 238, 5, 244, 88, 144, 158, 16, 60};
      uint64_t vb[] = {6060838u};
      size_t l = 23;
      REQUIRE(dot_prod_cb_enc<int /* 64 */, int /* 64 */, uint64_t>(va, vb, l) == 421);
    }
    {
      int va[] =
          {106, 110, 53, 128, 52, 228, 232, 168, 227, 113, 95, 156, 81, 179, 220, 46, 41, 154, 45, 1, 25, 42, 63};
      uint64_t vb[] = {8052674u};
      size_t l = 23;
      REQUIRE(dot_prod_cb_enc<int /* 64 */, int /* 64 */, uint64_t>(va, vb, l) == 1195);
    }
    {
      int va[] =
          {234, 139, 246, 139, 157, 74, 122, 203, 82, 166, 239, 57, 55, 45, 221, 192, 154, 161, 58, 165, 191, 38, 239};
      uint64_t vb[] = {5063744u};
      size_t l = 23;
      REQUIRE(dot_prod_cb_enc<int /* 64 */, int /* 64 */, uint64_t>(va, vb, l) == -1491);
    }
    {
      int va[] =
          {228, 102, 3, 76, 98, 29, 168, 195, 217, 154, 134, 53, 199, 199, 153, 94, 28, 218, 218, 52, 10, 39, 241};
      uint64_t vb[] = {4388621u};
      size_t l = 23;
      REQUIRE(dot_prod_cb_enc<int /* 64 */, int /* 64 */, uint64_t>(va, vb, l) == 714);
    }
  }

  SECTION("int dot_prod_cb_enc(const int*, const uint64_t*, size_t), dim=150") {
    {
      int va[] =
          {13, 177, 119, 218, 13, 65, 12, 134, 247, 196, 175, 46, 55, 69, 40, 7, 203, 165, 53, 93, 75, 41, 174, 33, 135,
           184, 243, 171, 240, 125, 94, 153, 48, 141, 37, 52, 19, 250, 48, 116, 234, 120, 68, 131, 31, 63, 3, 69, 67,
           28, 141, 163, 60, 1, 107, 232, 65, 231, 112, 94, 239, 239, 144, 141, 40, 218, 89, 21, 60, 40, 216, 104, 232,
           193, 18, 142, 126, 127, 4, 118, 32, 135, 0, 124, 49, 88, 15, 210, 106, 40, 111, 197, 177, 89, 209, 137, 246,
           116, 248, 173, 6, 12, 127, 110, 213, 143, 169, 60, 187, 52, 199, 209, 104, 126, 245, 209, 65, 39, 28, 12,
           167, 174, 163, 137, 175, 165, 206, 58, 223, 208, 67, 100, 81, 21, 44, 201, 236, 133, 1, 63, 86, 218, 216,
           118, 60, 31, 69, 107, 217, 225};
      uint64_t vb[] = {10969411204827713491u, 16402582634439764608u, 3823701u};
      size_t l = 150;
      REQUIRE(dot_prod_cb_enc<int /* 64 */, int /* 64 */, uint64_t>(va, vb, l) == -2035);
    }
    {
      int va[] =
          {10, 92, 253, 243, 229, 44, 83, 48, 45, 78, 135, 109, 184, 203, 23, 246, 246, 45, 229, 143, 247, 251, 217, 53,
           9, 161, 37, 159, 219, 159, 118, 132, 211, 176, 107, 37, 66, 41, 40, 229, 57, 76, 53, 22, 53, 52, 248, 234,
           132, 242, 42, 194, 33, 244, 168, 182, 127, 86, 229, 251, 31, 249, 100, 86, 201, 132, 78, 96, 123, 80, 42,
           226, 172, 154, 191, 159, 97, 126, 203, 75, 142, 156, 116, 134, 195, 93, 33, 239, 232, 220, 245, 93, 8, 217,
           190, 109, 12, 240, 206, 197, 149, 96, 6, 18, 15, 88, 30, 227, 99, 184, 83, 139, 35, 171, 43, 254, 160, 234,
           110, 89, 251, 117, 0, 131, 197, 153, 2, 42, 139, 16, 200, 226, 130, 68, 112, 188, 2, 106, 86, 178, 113, 211,
           26, 253, 76, 42, 238, 50, 111, 55};
      uint64_t vb[] = {1125209097623349099u, 16712529787513729884u, 3606389u};
      size_t l = 150;
      REQUIRE(dot_prod_cb_enc<int /* 64 */, int /* 64 */, uint64_t>(va, vb, l) == 1859);
    }
    {
      int va[] =
          {95, 129, 74, 190, 6, 207, 118, 95, 127, 21, 13, 171, 127, 56, 34, 151, 123, 67, 97, 127, 243, 195, 14, 43,
           204, 148, 143, 61, 164, 117, 81, 246, 241, 120, 70, 209, 174, 120, 178, 41, 46, 250, 149, 176, 138, 43, 238,
           155, 229, 151, 168, 242, 205, 108, 46, 2, 255, 237, 116, 23, 66, 46, 180, 148, 192, 82, 210, 163, 233, 91,
           122, 131, 27, 215, 75, 45, 186, 220, 51, 186, 41, 54, 254, 151, 41, 218, 44, 34, 17, 21, 248, 76, 187, 88,
           35, 108, 158, 203, 38, 240, 196, 100, 157, 249, 72, 39, 120, 82, 248, 113, 87, 135, 106, 125, 145, 216, 81,
           99, 251, 27, 95, 24, 238, 193, 70, 14, 239, 26, 4, 209, 78, 176, 149, 250, 253, 55, 25, 76, 248, 222, 140,
           123, 22, 169, 11, 239, 112, 169, 168, 16};
      uint64_t vb[] = {14734783341866856100u, 11991919791897141482u, 2467621u};
      size_t l = 150;
      REQUIRE(dot_prod_cb_enc<int /* 64 */, int /* 64 */, uint64_t>(va, vb, l) == -295);
    }
    {
      int va[] =
          {180, 251, 143, 107, 115, 73, 234, 95, 137, 141, 5, 59, 132, 137, 58, 128, 80, 214, 213, 171, 160, 28, 196,
           16, 135, 146, 179, 98, 154, 9, 147, 51, 181, 148, 242, 139, 16, 218, 89, 40, 53, 124, 104, 67, 115, 212, 63,
           75, 180, 179, 241, 244, 72, 133, 119, 129, 123, 68, 214, 98, 26, 242, 121, 11, 72, 54, 195, 250, 154, 171,
           163, 230, 106, 155, 225, 207, 170, 17, 27, 65, 211, 81, 202, 39, 219, 111, 211, 176, 108, 205, 117, 64, 141,
           135, 39, 91, 218, 84, 216, 39, 240, 154, 134, 29, 35, 225, 185, 149, 243, 188, 28, 215, 200, 100, 194, 143,
           99, 251, 175, 223, 213, 45, 32, 178, 176, 170, 79, 37, 103, 78, 202, 227, 88, 85, 41, 156, 228, 35, 83, 184,
           239, 93, 247, 13, 64, 234, 102, 218, 80, 223};
      uint64_t vb[] = {10804901655843911972u, 18424908453747235747u, 1050799u};
      size_t l = 150;
      REQUIRE(dot_prod_cb_enc<int /* 64 */, int /* 64 */, uint64_t>(va, vb, l) == 181);
    }
    {
      int va[] =
          {206, 207, 24, 22, 240, 49, 87, 194, 91, 89, 202, 12, 233, 58, 153, 114, 15, 20, 231, 126, 142, 59, 92, 46,
           73, 157, 22, 228, 223, 233, 207, 19, 145, 224, 27, 221, 129, 196, 6, 140, 243, 84, 207, 31, 146, 0, 93, 141,
           114, 121, 197, 197, 235, 208, 100, 156, 94, 222, 243, 64, 90, 215, 250, 65, 138, 11, 236, 226, 20, 21, 143,
           113, 226, 213, 205, 247, 231, 46, 183, 199, 174, 115, 29, 62, 14, 101, 154, 93, 140, 182, 92, 84, 221, 90,
           114, 105, 30, 7, 205, 18, 178, 64, 44, 51, 85, 9, 51, 182, 223, 170, 72, 16, 209, 94, 94, 133, 240, 159, 182,
           245, 10, 103, 231, 93, 196, 189, 15, 45, 177, 133, 252, 168, 94, 18, 195, 183, 90, 40, 7, 166, 152, 99, 28,
           39, 32, 132, 22, 174, 32, 98};
      uint64_t vb[] = {17847643573524221657u, 14335570897868790207u, 1219136u};
      size_t l = 150;
      REQUIRE(dot_prod_cb_enc<int /* 64 */, int /* 64 */, uint64_t>(va, vb, l) == 1610);
    }
  }

  SECTION("float dot_prod_cb_enc(const float*, const uint64_t*, size_t), dim=64") {
    {
      float va[] =
          {-0.044194936752319336, 0.3566083014011383, 1.1571238040924072, -0.8325671553611755, 0.09482040256261826,
           -0.01230083778500557, -0.9901304244995117, -2.121316432952881, -0.4082794785499573, 0.6593010425567627,
           0.9036663770675659, -1.770741581916809, -1.5499649047851562, 1.0456736087799072, 0.7371154427528381,
           2.7702345848083496, -1.1105023622512817, -1.4146982431411743, 0.3133193552494049, -0.26439371705055237,
           -0.9964523911476135, 0.8773337602615356, -1.013069987297058, 0.6878737807273865, 0.6783944368362427,
           1.0242527723312378, -0.5061802268028259, 0.9900401830673218, -0.631257951259613, -0.3083370327949524,
           -0.5357375144958496, -0.03097866103053093, 0.9925121665000916, 0.7621663212776184, -1.0671497583389282,
           -0.009264197200536728, -1.1405400037765503, 0.12023022770881653, 1.3548204898834229, -1.0109155178070068,
           0.7695868611335754, -2.3565878868103027, -1.2031805515289307, -0.8417178392410278, 1.03107488155365,
           0.5822454690933228, -1.840956449508667, -0.2806026041507721, -0.7565159797668457, 1.2438015937805176,
           -0.875464916229248, -0.8767486214637756, -0.8011038303375244, 0.11375322192907333, -1.3606935739517212,
           0.1284995973110199, -1.134464144706726, 0.46027517318725586, -2.2653322219848633, -0.8852118253707886,
           0.5394198298454285, -1.1120046377182007, -1.7194591760635376, 0.32571762800216675};
      uint64_t vb[] = {16137701829568736632u};
      size_t l = 64;
      REQUIRE(
          dot_prod_cb_enc<float /* 64 */, float /* 64 */, uint64_t>(va, vb, l) == Approx(6.05723817274).epsilon(0.01));
    }
    {
      float va[] =
          {-0.12718267738819122, -1.529895544052124, -0.9188778400421143, -0.6481332182884216, -0.10982927680015564,
           1.0118563175201416, -0.5292249917984009, -1.6624797582626343, -0.5907366871833801, 0.6989855170249939,
           0.07073049992322922, 1.10965096950531, -0.07780823111534119, 0.3532063961029053, -0.12759727239608765,
           -0.9338942766189575, -0.5749859809875488, 0.602597177028656, -0.9310243725776672, 0.9433404207229614,
           0.9708982110023499, -0.4630979299545288, 0.9863000512123108, 0.11612381786108017, 1.2693719863891602,
           -0.4275095462799072, -0.015045697800815105, 0.019667603075504303, 1.7266508340835571, 1.0567196607589722,
           -0.5155006647109985, -0.734970211982727, -0.5929577350616455, 0.8533440828323364, 0.4537201225757599,
           0.46167469024658203, 0.16955725848674774, 1.0837053060531616, -0.6514389514923096, -1.1003220081329346,
           1.052350640296936, -0.6299421787261963, 0.7121416330337524, 0.4085950255393982, 0.23860102891921997,
           0.5564565062522888, 0.9879544973373413, -0.23300601541996002, 0.853600025177002, 0.14025618135929108,
           1.441111445426941, -1.7960420846939087, 0.36885741353034973, -0.5701491832733154, 0.5784434676170349,
           0.15257427096366882, -0.9930850863456726, -1.8676934242248535, 0.9514160752296448, 0.6722550988197327,
           -1.1991584300994873, 0.5147531628608704, -0.22647665441036224, 0.035937368869781494};
      uint64_t vb[] = {16735066981647780460u};
      size_t l = 64;
      REQUIRE(
          dot_prod_cb_enc<float /* 64 */, float /* 64 */, uint64_t>(va, vb, l) == Approx(-1.63820740301).epsilon(0.01));
    }
    {
      float va[] =
          {-1.0446257591247559, 0.22719237208366394, -0.4902169704437256, 0.9338305592536926, -0.8097491264343262,
           1.445620059967041, -1.0065518617630005, 0.6696606874465942, -0.39929667115211487, -0.9344397187232971,
           0.10849132388830185, 0.08134352415800095, 1.7908319234848022, 0.4330954849720001, -0.04882751777768135,
           0.41286996006965637, -0.03578915819525719, -0.8722677230834961, -0.262871116399765, 0.41067585349082947,
           2.3682804107666016, 0.8045901656150818, -0.2463521957397461, 0.7721034288406372, -1.0277494192123413,
           1.065158486366272, 0.11267510056495667, -1.0039751529693604, 0.8025524616241455, 0.4267357289791107,
           0.6814880967140198, -0.6809919476509094, -0.12571057677268982, 1.3137602806091309, -0.6312254071235657,
           -1.6689661741256714, 1.9451782703399658, -0.8814293742179871, 0.052131056785583496, 1.7090126276016235,
           -0.9252756237983704, 1.639217495918274, 1.0020142793655396, 0.6787194013595581, 0.9794884324073792,
           0.9694024920463562, 0.21959879994392395, 0.957904577255249, -0.8644608855247498, 1.7891499996185303,
           1.0643177032470703, 0.5439598560333252, -0.560908854007721, -1.2554175853729248, -0.2535093426704407,
           -0.3291369676589966, -1.392853021621704, 0.07952764630317688, 1.2537132501602173, 0.6432752013206482,
           1.5054134130477905, -0.38026753067970276, 0.762596607208252, 0.910382866859436};
      uint64_t vb[] = {7162866645765842929u};
      size_t l = 64;
      REQUIRE(
          dot_prod_cb_enc<float /* 64 */, float /* 64 */, uint64_t>(va, vb, l) == Approx(11.5631240159).epsilon(0.01));
    }
    {
      float va[] = {0.7670671939849854, -0.1092868447303772, 0.5906208753585815, 1.285904049873352, -0.5771384239196777,
                    0.47430819272994995, 0.517199695110321, 1.6033380031585693, -0.46322494745254517,
                    1.2798388004302979, 1.1851743459701538, 1.387194275856018, -1.5989223718643188, -0.6332246661186218,
                    -0.5331181287765503, 0.7036962509155273, 0.15104517340660095, -0.7846963405609131,
                    -0.04760287329554558, -0.25852394104003906, 1.2039700746536255, -1.6589066982269287,
                    -1.6758495569229126, -0.676203191280365, -1.0991073846817017, 0.42101529240608215,
                    2.213791847229004, 0.21196173131465912, 0.1585470587015152, 0.5656000971794128,
                    -0.26344794034957886, 0.04906012490391731, -1.0106347799301147, 1.4161326885223389,
                    0.24821163713932037, 0.3777600824832916, -0.1339573711156845, 1.0200657844543457,
                    -0.6366154551506042, 0.04823886230587959, 0.5195631384849548, -0.44876158237457275,
                    0.15761536359786987, -0.3633168041706085, 0.6333935260772705, 2.6608693599700928,
                    1.6573636531829834, -0.26456567645072937, -1.2149943113327026, -0.7255308628082275,
                    0.4543362557888031, 0.3798794150352478, -1.9627574682235718, 1.1258562803268433, 3.2031280994415283,
                    1.0011831521987915, 0.8151136040687561, -1.5082874298095703, 0.6438425779342651, 1.288045883178711,
                    1.8188377618789673, 2.0085079669952393, 1.112218976020813, -0.24474743008613586};
      uint64_t vb[] = {10805891050042275727u};
      size_t l = 64;
      REQUIRE(
          dot_prod_cb_enc<float /* 64 */, float /* 64 */, uint64_t>(va, vb, l) == Approx(26.5907454677).epsilon(0.01));
    }
    {
      float va[] =
          {0.8541836142539978, -0.46362876892089844, -0.8033771514892578, 0.5426682233810425, 1.2158074378967285,
           -1.7267450094223022, -0.6611078977584839, 2.463071823120117, 0.7751328349113464, -1.1363695859909058,
           -0.7209205031394958, 0.6625314950942993, -0.24918241798877716, -0.5320196151733398, -1.1111677885055542,
           -0.45309731364250183, 2.263655424118042, -0.13060592114925385, -1.0388730764389038, 0.34332776069641113,
           -1.921568512916565, 2.93412446975708, 0.3947756588459015, 0.7212640047073364, 0.3674938678741455,
           -0.17727722227573395, -0.759473979473114, 0.32616737484931946, -0.8533210754394531, -0.0352587029337883,
           -2.315030813217163, 0.7042427659034729, 0.4214808940887451, -1.1235132217407227, 0.08925744146108627,
           0.9765560626983643, -0.10247762501239777, -0.678716778755188, 1.0021374225616455, 0.6186825037002563,
           -0.20154307782649994, 0.2646033465862274, -1.0693362951278687, 0.026722991839051247, -0.6424199938774109,
           1.8388218879699707, -1.0956605672836304, -1.6256985664367676, -0.36111804842948914, -1.87771475315094,
           -0.09488992393016815, -1.1242598295211792, -0.7002715468406677, 0.6363189816474915, -1.0945134162902832,
           0.8362785577774048, -0.322877436876297, 0.3328111171722412, -0.21609516441822052, -0.45916178822517395,
           -0.10273987799882889, 0.3973652124404907, 0.5851410031318665, 1.3726521730422974};
      uint64_t vb[] = {4574284018554059197u};
      size_t l = 64;
      REQUIRE(
          dot_prod_cb_enc<float /* 64 */, float /* 64 */, uint64_t>(va, vb, l) == Approx(-1.53169331141).epsilon(0.01));
    }
  }

  SECTION("float dot_prod_cb_enc(const float*, const uint64_t*, size_t), dim=128") {
    {
      float va[] =
          {0.8210973739624023, -2.705260992050171, 0.4979320466518402, -0.36395156383514404, -0.7513787150382996,
           0.7112261056900024, 0.1704944670200348, -1.7455452680587769, -0.23663394153118134, 0.25247272849082947,
           0.44975146651268005, -0.8674500584602356, -0.1808280497789383, 0.27164989709854126, -0.6931276321411133,
           -0.15156063437461853, -0.7150382399559021, 1.02472984790802, -0.6340988874435425, -0.19577743113040924,
           -0.1662960648536682, -0.22825834155082703, -1.466077208518982, 1.387892723083496, -0.20156127214431763,
           0.33159610629081726, 0.7628180384635925, -0.21706832945346832, -1.0860881805419922, -0.0416041761636734,
           -0.29717764258384705, -1.2525135278701782, -0.6502013206481934, -2.69467830657959, -0.2865551710128784,
           0.5939562916755676, -0.9978889226913452, -1.036069393157959, 1.3977019786834717, -1.6648080348968506,
           0.5723136067390442, 0.8808678984642029, -0.4235728681087494, 0.5204104781150818, -1.3182786703109741,
           1.708083152770996, 0.6337375640869141, 0.08431815356016159, -0.4692102372646332, -0.2154376059770584,
           0.2510664463043213, 0.9818752408027649, -0.530377984046936, 0.3895426392555237, -2.028508186340332,
           0.609803318977356, 0.24124622344970703, -1.5721189975738525, -0.5216928124427795, 0.32553720474243164,
           0.007194184232503176, -0.8518691062927246, 1.5517570972442627, -0.1700720191001892, 0.8612911701202393,
           0.1520158350467682, -1.1529747247695923, 0.6184961199760437, 1.7515450716018677, 0.1805453896522522,
           -1.47053062915802, -1.9999910593032837, 1.7648102045059204, -1.2102094888687134, 1.3360834121704102,
           -0.38407865166664124, 1.4234076738357544, -0.7921784520149231, -0.7765018343925476, 0.3565840423107147,
           1.1716915369033813, -0.762678325176239, -0.3998377025127411, 0.14816541969776154, -0.397012323141098,
           -0.6961985230445862, 0.47420161962509155, -0.35468626022338867, -0.43993014097213745, -0.13098470866680145,
           0.02348422259092331, 0.02538353018462658, 1.4701379537582397, -0.603106677532196, -0.4204038977622986,
           -0.9275578856468201, -0.7415165901184082, 0.3441104292869568, -0.5499918460845947, 0.9369686245918274,
           1.81943941116333, 0.5579715371131897, -0.22095058858394623, 1.206047773361206, 0.2010294795036316,
           1.8088295459747314, 0.1732729822397232, -0.6008239984512329, -0.6150163412094116, 2.658233404159546,
           1.9515646696090698, -0.443615198135376, 1.1440062522888184, -1.520501732826233, -0.44073811173439026,
           0.751934826374054, 1.8729838132858276, 0.8237627744674683, -0.6469876170158386, 0.7137156128883362,
           0.46095627546310425, -0.4344809651374817, 0.33673879504203796, -0.38891464471817017, -0.956017792224884,
           0.21582747995853424, 1.390273094177246, 0.7641735672950745};
      uint64_t vb[] = {6240780375220909843u, 10398299248478645176u};
      size_t l = 128;
      REQUIRE(
          dot_prod_cb_enc<float /* 64 */, float /* 64 */, uint64_t>(va, vb, l) == Approx(8.2328552804).epsilon(0.01));
    }
    {
      float va[] =
          {-1.0527857542037964, 1.3694602251052856, -0.0711217150092125, 0.11434212327003479, 0.6210302710533142,
           0.6000135540962219, 1.2042272090911865, -0.4427588880062103, -0.4103730022907257, 1.5149558782577515,
           -1.4352611303329468, 0.01498871948570013, -0.686545729637146, -0.30620110034942627, -0.7941187024116516,
           -1.644139289855957, -1.3899203538894653, 1.2390265464782715, 0.3183005154132843, 0.544279932975769,
           -0.17875462770462036, 0.9262380003929138, -0.8164845705032349, -2.852511405944824, 0.7369834780693054,
           -0.7950349450111389, 2.848381996154785, -0.03208763897418976, 0.37993884086608887, 1.7877994775772095,
           -0.22151552140712738, -1.2266526222229004, -0.5638493895530701, 1.4453750848770142, -0.3330513834953308,
           -0.6195638179779053, -1.243079662322998, -0.7744209170341492, 1.0423760414123535, 0.3679804503917694,
           -0.34672170877456665, 1.2726105451583862, 1.2721232175827026, 0.2436368316411972, -1.462913990020752,
           -1.2466903924942017, -0.20956182479858398, 0.46075835824012756, 1.0392972230911255, -1.2447230815887451,
           -0.17908631265163422, -0.0978885367512703, 0.31747961044311523, -0.17313046753406525, 0.26680874824523926,
           -0.9672369956970215, 0.6456233263015747, 0.9141508340835571, 0.19014474749565125, -0.4193580448627472,
           2.8425753116607666, 0.278453528881073, -0.3980243504047394, 0.9878413677215576, -0.21036988496780396,
           -0.24489259719848633, -0.37966620922088623, 0.0687248706817627, -0.06407241523265839, -0.6584102511405945,
           -0.8977596163749695, 0.4116373360157013, 0.09436911344528198, 1.316042184829712, 1.1318626403808594,
           -0.7015823125839233, -0.4323512017726898, 1.3083592653274536, -0.4211381673812866, 0.10716549307107925,
           -0.9298558831214905, 0.26281702518463135, -0.6310938596725464, -0.006710446439683437, -0.9641649127006531,
           0.6833890676498413, -0.7388935685157776, -0.16690605878829956, -0.16146515309810638, 0.6581165790557861,
           -0.6472349166870117, -0.5794790387153625, 1.3305505514144897, -0.8296924233436584, -1.1778267621994019,
           -0.6945778727531433, 0.2213868796825409, 1.433359980583191, 0.5988044142723083, 0.6352729201316833,
           -0.8367170691490173, -0.21775473654270172, 0.29780423641204834, 1.572562336921692, -1.1756548881530762,
           2.354836940765381, -0.17280445992946625, -0.45584362745285034, -0.6473560929298401, -0.3354719877243042,
           1.045556664466858, -0.6695178747177124, 1.399328351020813, -0.5939285755157471, 1.354060173034668,
           0.022783640772104263, -0.02782401815056801, -0.04505322873592377, 1.178031325340271, 0.4320284426212311,
           -0.9880124926567078, -1.0840476751327515, 0.6246463060379028, -0.05522279813885689, 0.7442210912704468,
           0.7542487382888794, -1.6692811250686646, -0.4978429973125458};
      uint64_t vb[] = {10792111708771555890u, 3533668806902144855u};
      size_t l = 128;
      REQUIRE(
          dot_prod_cb_enc<float /* 64 */, float /* 64 */, uint64_t>(va, vb, l) == Approx(2.06732408516).epsilon(0.01));
    }
    {
      float va[] = {2.116420030593872, -0.273078978061676, -0.9429370164871216, 1.2239874601364136, 0.4378807246685028,
                    0.27261045575141907, 2.4127774238586426, 0.8416647911071777, 0.5260056853294373,
                    0.20800775289535522, -0.11415578424930573, -0.7963436841964722, 0.7371858954429626,
                    0.1358570158481598, 0.4801788926124573, 0.48560357093811035, 0.9553452730178833,
                    -0.9329707622528076, 0.78557288646698, -1.061852216720581, 1.173480749130249, 0.005973671097308397,
                    -1.094416856765747, -1.8817858695983887, 0.5181165337562561, -0.9741264581680298,
                    0.2284107804298401, -1.0700504779815674, -1.4083906412124634, 0.6895676255226135,
                    -0.7335687875747681, -0.2043299525976181, -0.77188640832901, -0.5023394227027893,
                    0.12092239409685135, -0.15707740187644958, 0.7369728684425354, 0.01249625626951456,
                    -0.6190561652183533, -0.32993146777153015, -0.6113333106040955, 0.029007481411099434,
                    -0.35120269656181335, 1.1149861812591553, -0.5250898003578186, 0.18004535138607025,
                    -0.8101012706756592, -0.3110710382461548, -0.7606099843978882, 0.9703720808029175,
                    0.28340208530426025, 0.592173159122467, -0.5052617788314819, -0.48207366466522217,
                    -0.35110512375831604, -0.8156365752220154, -1.3387559652328491, -1.802254557609558,
                    -0.8184743523597717, -3.4011216163635254, -0.3187015652656555, 0.38365447521209717,
                    0.7587360739707947, 1.0210543870925903, 2.0151994228363037, -0.451454758644104, 0.10209456086158752,
                    0.5922859907150269, -0.9095767736434937, -0.42779332399368286, -0.419315367937088,
                    -0.006818121764808893, 1.085960865020752, -1.010860800743103, 0.4306342899799347,
                    0.18914851546287537, -0.22778761386871338, -1.1955674886703491, -0.10837934166193008,
                    1.0748190879821777, 0.05356718227267265, -1.1477192640304565, -1.3670639991760254,
                    -0.036722030490636826, 0.02303914539515972, -0.13310210406780243, -1.1557294130325317,
                    -1.7439149618148804, -1.4668978452682495, 0.4800858199596405, 2.6365387439727783,
                    1.0021358728408813, -1.9760514497756958, 2.163294792175293, -1.1281722784042358,
                    -0.5574735403060913, 0.19490765035152435, -0.016914905980229378, -0.18937142193317413,
                    0.809673547744751, -1.8289856910705566, -1.1619904041290283, -1.7760494947433472,
                    1.6854455471038818, 0.5708062052726746, 0.4908655881881714, 0.25392717123031616,
                    -0.1653716117143631, -1.3113713264465332, -0.9719730019569397, 0.5165961980819702,
                    -0.7825245261192322, -0.8198822736740112, -1.3213043212890625, 0.7671549320220947,
                    0.742104709148407, 0.22767329216003418, -0.24040336906909943, -2.0313286781311035,
                    1.6111412048339844, -0.5911257266998291, -0.8064663410186768, -0.27553749084472656,
                    0.8861646056175232, 1.8756966590881348, -1.1629270315170288, 0.08191902190446854,
                    1.514290452003479};
      uint64_t vb[] = {9306687531335656406u, 13703671853544610821u};
      size_t l = 128;
      REQUIRE(
          dot_prod_cb_enc<float /* 64 */, float /* 64 */, uint64_t>(va, vb, l) == Approx(5.96693024598).epsilon(0.01));
    }
    {
      float va[] =
          {1.6533764600753784, -0.8824637532234192, -2.9278810024261475, -0.43335986137390137, -0.6187168955802917,
           1.5191373825073242, -0.8030639886856079, 0.5068464875221252, -0.2264808565378189, -1.3629109859466553,
           0.12060705572366714, 0.029714025557041168, 0.646612823009491, 0.7241701483726501, -0.8895409107208252,
           -1.01858389377594, -0.9997729063034058, -0.6823252439498901, 1.5964943170547485, -2.290947675704956,
           -0.2795776128768921, 0.8736036419868469, 1.301400065422058, -0.7665255665779114, 0.06858108937740326,
           2.4544053077697754, 1.0116913318634033, 0.9889817833900452, 0.25733035802841187, -1.006983995437622,
           -0.4186320900917053, 1.1920937299728394, -0.14516346156597137, -0.11473216116428375, -0.5159066319465637,
           -0.9029600620269775, -0.12889240682125092, 0.4395013451576233, 0.7096946239471436, 1.3945914506912231,
           1.2498029470443726, 0.0868009701371193, -1.7765945196151733, 0.6158808469772339, -0.02633094973862171,
           -1.3123704195022583, -1.196277141571045, -0.629895031452179, 0.16042952239513397, 0.4236149191856384,
           -1.2835074663162231, 1.1191874742507935, 0.7867090106010437, -2.396850347518921, -0.9446425437927246,
           0.8279600143432617, 1.3361865282058716, 0.6337099671363831, -1.2758452892303467, -1.3061320781707764,
           -0.008390241302549839, 1.8369754552841187, -0.283172607421875, -0.24161943793296814, 1.3757697343826294,
           -0.9075950384140015, -0.8088093400001526, -1.0943492650985718, 0.3762889504432678, 0.08184077590703964,
           -1.0686628818511963, 0.4403310716152191, -0.2156042903661728, 1.9256863594055176, 1.0996503829956055,
           -1.6836082935333252, 0.30917102098464966, 1.1542283296585083, 0.4960184097290039, -0.805256724357605,
           0.3877413868904114, -0.15580187737941742, 1.966753602027893, -2.3659579753875732, 0.44345447421073914,
           -1.6121187210083008, -1.343559980392456, -0.8365284204483032, 0.6119562983512878, -0.8389870524406433,
           0.08051662892103195, 1.4474711418151855, 1.547274112701416, -1.461543321609497, 0.9887809157371521,
           -0.4847419261932373, 0.7661018371582031, 1.3592970371246338, 1.0851287841796875, -1.200379490852356,
           1.2837162017822266, 1.4535846710205078, 0.7868161797523499, 0.6770827174186707, 0.17501546442508698,
           0.21114148199558258, -1.8008710145950317, -0.796015202999115, 0.05583852529525757, 0.465398371219635,
           -1.0109317302703857, -0.4910684823989868, -0.19796554744243622, 0.0384080745279789, -0.2975403368473053,
           0.1517886072397232, -0.45893189311027527, 0.042563535273075104, -0.051996272057294846, -0.7661906480789185,
           0.5359657406806946, 0.24620506167411804, -0.002069470938295126, 0.7223287224769592, 0.40185391902923584,
           -1.4526880979537964, -0.05736498534679413, 0.6844131946563721};
      uint64_t vb[] = {1334070645174702079u, 18428745542717220862u};
      size_t l = 128;
      REQUIRE(
          dot_prod_cb_enc<float /* 64 */, float /* 64 */, uint64_t>(va, vb, l) == Approx(-23.2360940953).epsilon(0.01));
    }
    {
      float va[] = {-1.7503987550735474, -0.294029176235199, 0.4381435215473175, -0.85418701171875, 0.45252469182014465,
                    -0.5194485783576965, 0.8644281029701233, -0.31145575642585754, 1.0504764318466187,
                    -0.5810438990592957, 0.6075039505958557, -0.8277450799942017, 0.4043000042438507,
                    0.8371676206588745, -1.4532442092895508, -0.028262251988053322, -0.4130306839942932,
                    0.2660471200942993, -1.4448484182357788, 1.2370296716690063, -0.8675612807273865, 0.426954448223114,
                    0.4431118071079254, 0.5822330713272095, 0.1167198121547699, 1.1732494831085205, 0.35203927755355835,
                    0.17960311472415924, -1.323203444480896, -0.4584420323371887, -1.6665945053100586,
                    -0.043272219598293304, -0.5634509325027466, 0.5729237198829651, 0.47712600231170654,
                    -0.19757620990276337, -0.4762400686740875, -0.41047418117523193, -0.6136760711669922,
                    -0.8212113976478577, 2.0728578567504883, 0.3396802544593811, -0.4661557078361511,
                    -0.27378419041633606, -0.38788050413131714, 0.6529619097709656, -0.17921707034111023,
                    -0.08013810217380524, 1.1446161270141602, 0.06983055919408798, 0.10789167881011963,
                    0.6364637017250061, 0.7787607908248901, -0.44381383061408997, 2.2671656608581543,
                    0.43337497115135193, 2.0100290775299072, -0.006564092356711626, -1.5080835819244385,
                    0.39909493923187256, 0.17552056908607483, -0.4146580994129181, -1.1637648344039917, 1.0257488489151,
                    1.0348647832870483, 0.5395722389221191, 0.7369770407676697, 2.9092328548431396, 0.7144598960876465,
                    -0.6020186543464661, -0.2995113730430603, 0.34440580010414124, 0.35009947419166565,
                    0.7069631814956665, 0.5432590842247009, 1.2722691297531128, 1.4349724054336548, 0.11636312305927277,
                    -1.2455191612243652, -1.5302748680114746, -0.3376169800758362, 0.5064886212348938,
                    1.2176165580749512, -0.25940966606140137, -0.5042716860771179, -0.36227333545684814,
                    1.1535842418670654, -0.0395684689283371, -0.8065009713172913, -0.16589555144309998,
                    -1.265891671180725, -0.47463327646255493, -2.1186201572418213, -1.0647401809692383,
                    -0.5053079128265381, 0.2398238629102707, 0.47126978635787964, -0.060616690665483475,
                    -1.7681679725646973, 0.22546154260635376, -0.32997140288352966, -0.1849396973848343,
                    0.15868958830833435, -1.890228271484375, -0.15067480504512787, -0.04073033481836319,
                    1.2434929609298706, -0.040477752685546875, 0.09970027953386307, -2.523902177810669,
                    -0.23219086229801178, -0.3515434265136719, -0.5992589592933655, -0.8351799845695496,
                    -0.11446816474199295, 1.0115833282470703, 0.47615358233451843, 0.01368200033903122,
                    0.21239106357097626, -1.4998522996902466, -1.200880527496338, -0.964089035987854,
                    0.49484023451805115, -0.7783141732215881, 1.3042925596237183, 0.024882473051548004,
                    1.1102577447891235, -0.5521306395530701};
      uint64_t vb[] = {5039578363799596642u, 8354740570108087032u};
      size_t l = 128;
      REQUIRE(
          dot_prod_cb_enc<float /* 64 */, float /* 64 */, uint64_t>(va, vb, l) == Approx(-6.22557848552).epsilon(0.01));
    }
  }

  SECTION("float dot_prod_cb_enc(const float*, const uint64_t*, size_t), dim=256") {
    {
      float va[] =
          {-0.37180882692337036, 0.43305426836013794, 1.2099316120147705, -1.4277127981185913, -0.18943986296653748,
           -0.6729047298431396, 1.5083611011505127, -0.7757865786552429, -0.01835521310567856, -1.0203304290771484,
           0.829550564289093, 0.9628174304962158, -0.020399311557412148, -0.6810030937194824, 0.4544921815395355,
           -1.6675076484680176, -0.6639562249183655, 1.8035889863967896, 0.35686254501342773, -0.20589233934879303,
           0.17037124931812286, -0.7609130144119263, 1.4921081066131592, -1.1702467203140259, 0.9233278036117554,
           1.873216152191162, -0.18271145224571228, -0.17651747167110443, 1.2278506755828857, 1.554999828338623,
           1.5200954675674438, -0.7580801248550415, 0.22076480090618134, -0.7048286199569702, -0.453428715467453,
           1.960944652557373, 1.2749899625778198, -0.3621957302093506, -0.9632713794708252, -0.2485806792974472,
           -0.6427233815193176, -0.43105751276016235, 1.3542834520339966, -1.2444219589233398, 1.1498316526412964,
           0.3812796473503113, 1.234440565109253, -0.6887264251708984, -0.23212873935699463, 0.9822182059288025,
           0.0437413714826107, -0.28908422589302063, -0.49128010869026184, 1.4548791646957397, 0.8460279107093811,
           -0.17713700234889984, 0.874788761138916, 0.30458569526672363, 0.6696484684944153, -1.5038392543792725,
           -0.7009316086769104, 0.051587700843811035, -0.1980188935995102, -0.9478699564933777, -0.8340460062026978,
           1.0494637489318848, -0.13071928918361664, 1.0564420223236084, 0.7606992721557617, 0.2709428071975708,
           -0.02118116244673729, -0.7337685227394104, -0.06452201306819916, 0.8867475390434265, 0.38751885294914246,
           0.49502459168434143, 0.8291460275650024, -1.0256773233413696, -0.3721237778663635, -0.7950812578201294,
           0.9966930747032166, -0.14100657403469086, 1.4766755104064941, -0.19980742037296295, -0.9509176015853882,
           -1.36526620388031, -1.0741482973098755, 2.5962471961975098, -1.6988621950149536, 0.981810986995697,
           0.9473552107810974, -1.73356294631958, -0.16268688440322876, 0.7978359460830688, 1.5274195671081543,
           0.22952741384506226, -1.1271368265151978, -0.3591689467430115, -1.9385842084884644, -0.4310525953769684,
           -1.3372901678085327, 1.342645525932312, 0.35402414202690125, 1.5085946321487427, -1.6457475423812866,
           0.8735880851745605, -0.19206494092941284, -1.063755989074707, -0.1838776171207428, 0.9574169516563416,
           -1.6314445734024048, -0.33009299635887146, 0.803946852684021, 1.8333290815353394, -0.2292940616607666,
           0.014974691905081272, -2.390409469604492, 0.37981992959976196, 0.004867284093052149, -0.7086605429649353,
           -1.2198996543884277, -0.7902880907058716, -0.6524440050125122, 0.7241936922073364, -0.09637120366096497,
           -0.23702622950077057, 1.3366000652313232, -0.12425301969051361, -0.7611598372459412, 2.098675012588501,
           0.9577738642692566, -0.37927860021591187, 1.306617021560669, -0.5722173452377319, 0.8776598572731018,
           -0.47583335638046265, -1.6805977821350098, -0.8477648496627808, 1.6724019050598145, -0.44973963499069214,
           -0.7146093845367432, -0.7639989852905273, -0.4064934551715851, -0.09634745866060257, -0.010511850006878376,
           -2.0802085399627686, -0.44541630148887634, 0.9179214239120483, 1.2533546686172485, 2.7598135471343994,
           -0.5965652465820312, -0.11586698889732361, 1.7214030027389526, -1.3965480327606201, 0.30231764912605286,
           -0.6144441962242126, 1.5521920919418335, 0.3862810730934143, 1.2476598024368286, -0.5720791816711426,
           -0.7202964425086975, 2.064140796661377, -0.03254678472876549, 2.07485294342041, 0.3120458126068115,
           0.6778886318206787, 1.2362829446792603, 0.9392242431640625, 0.39021027088165283, 0.550998330116272,
           -0.46648290753364563, -1.418592095375061, 1.0417207479476929, -1.2791392803192139, 0.7723919749259949,
           -0.21146179735660553, 1.4201120138168335, -0.23997627198696136, -1.0306780338287354, -1.9714688062667847,
           -1.4266910552978516, -0.43614476919174194, -0.30548161268234253, -0.13689769804477692, 0.38000956177711487,
           -1.121114730834961, 0.041104208678007126, -2.2453417778015137, -0.27400633692741394, 0.8175276517868042,
           -0.28935983777046204, 2.4721896648406982, -0.3129517734050751, -0.12088593095541, 0.3300234377384186,
           1.5245975255966187, -0.6153934597969055, -1.3502166271209717, 0.2196975201368332, 0.7429048418998718,
           0.4014368951320648, 1.499745488166809, -0.45216256380081177, -0.28491610288619995, -0.5040722489356995,
           -0.141338512301445, -0.7193580269813538, -0.8296383619308472, 1.08319890499115, 0.9055212140083313,
           -0.9101034998893738, 0.375649094581604, 0.3689790368080139, 0.17532376945018768, 1.1046791076660156,
           -0.08553656935691833, -0.07116667181253433, -0.8388250470161438, 0.18255428969860077, -1.4368139505386353,
           1.4189561605453491, 0.23483392596244812, 0.29780107736587524, 0.08958273380994797, -1.692278504371643,
           0.3422596752643585, -0.22756172716617584, -0.11859291791915894, -0.046773072332143784, 0.7068145275115967,
           -1.619117259979248, 0.4763547480106354, 0.9289500117301941, -0.15209181606769562, 0.16790831089019775,
           -0.4905042350292206, 1.9123059511184692, -1.5987948179244995, 0.43887779116630554, 1.3549822568893433,
           0.9388396143913269, -0.9325189590454102, -0.05877145379781723, 0.012012563645839691, 1.210330605506897,
           0.4526026248931885, 0.5648515224456787, -0.9499349594116211, 0.11148552596569061, -0.7656777501106262,
           0.3690243661403656, -0.05654454231262207, 2.421990394592285, -0.9895110130310059, -0.34625446796417236,
           0.5052579641342163};
      uint64_t vb[] = {4288429560477471502u, 13590122121962953455u, 12230729355962170760u, 9682290110048899557u};
      size_t l = 256;
      REQUIRE(
          dot_prod_cb_enc<float /* 64 */, float /* 64 */, uint64_t>(va, vb, l) == Approx(-11.5878090388).epsilon(0.01));
    }
    {
      float va[] =
          {-0.19745610654354095, -0.6588428616523743, -2.1102495193481445, 0.15776702761650085, -1.5673518180847168,
           0.22188495099544525, 0.4177877604961395, -0.04632436856627464, 1.6159204244613647, -1.5386565923690796,
           1.7539300918579102, 0.01949472725391388, 0.17763791978359222, 1.5696865320205688, 0.9835561513900757,
           0.922382652759552, 0.4526401162147522, 0.8832315802574158, 0.058645691722631454, -0.00533174816519022,
           0.7893293499946594, 1.6604421138763428, 0.49155116081237793, -0.4539729654788971, 0.07302198559045792,
           -0.059276923537254333, -0.8773660063743591, 0.3076079189777374, 0.7784662842750549, -0.8282239437103271,
           -1.0617873668670654, -0.1472191959619522, -0.6926360130310059, 0.4196423590183258, -0.41874369978904724,
           2.606240749359131, -0.11946222186088562, -0.3867267966270447, 0.42922645807266235, 0.28432902693748474,
           -0.6097337603569031, 0.7279640436172485, 0.06521838903427124, 0.08348280936479568, 2.571152925491333,
           -0.6494555473327637, -0.46142664551734924, 1.6116926670074463, -0.1796485334634781, 0.48694226145744324,
           -0.9704296588897705, 1.425868034362793, -0.9580690860748291, 1.3818273544311523, 1.7530107498168945,
           -2.3814733028411865, -0.7300564646720886, 0.29120373725891113, 1.3354034423828125, 1.6101707220077515,
           -2.0307323932647705, -0.465631902217865, 0.20288462936878204, -0.06824888288974762, -0.7133657336235046,
           1.023754358291626, 0.09059613198041916, 0.1372164934873581, -0.573673665523529, -0.030638346448540688,
           -0.6728141903877258, -0.8062061071395874, 1.6160318851470947, 0.39016395807266235, 0.5695287585258484,
           0.7505875825881958, 0.816393256187439, -0.02566881850361824, -1.1673742532730103, -0.9042861461639404,
           -2.4491868019104004, 0.9564990997314453, 1.7096422910690308, 0.5040406584739685, 1.75313138961792,
           0.1569230556488037, -1.1888694763183594, -0.3258528411388397, -0.9583646655082703, 0.18672583997249603,
           2.5097076892852783, 1.366723656654358, -1.1840314865112305, -0.06365333497524261, -0.9761844277381897,
           -0.8056254982948303, 0.44070398807525635, -0.6643883585929871, -0.6274157166481018, -0.49612143635749817,
           -0.5035684108734131, 0.4247334599494934, 1.3200414180755615, 0.9908642172813416, -0.17221872508525848,
           2.097059965133667, -0.5350130200386047, 0.9713167548179626, 0.6654230356216431, -0.22112968564033508,
           0.7438166737556458, 1.2641916275024414, -0.42563796043395996, -0.44172683358192444, -1.1596479415893555,
           -0.19649529457092285, -0.6810417771339417, 0.38819465041160583, 1.788280963897705, 1.787376880645752,
           1.4853121042251587, -0.7068425416946411, 1.7157626152038574, 1.8724875450134277, -0.3395233452320099,
           -0.29840317368507385, 0.14186546206474304, 0.8389447331428528, 0.33197641372680664, -2.229386568069458,
           -0.6403072476387024, -0.23191508650779724, 1.4452530145645142, -0.8343188762664795, -0.048788346350193024,
           0.5547122359275818, 0.2852315902709961, -0.10513496398925781, -1.575860619544983, 0.6056540608406067,
           -0.030034586787223816, 1.8793673515319824, 1.0878478288650513, -1.161595344543457, -1.3103004693984985,
           -1.3334343433380127, 1.0960099697113037, 0.19384336471557617, 0.09347862005233765, -0.7638561725616455,
           -0.6063167452812195, 1.9870696067810059, 0.3448888659477234, 1.6255288124084473, -1.5521749258041382,
           -0.8440127968788147, -1.0880793333053589, 0.6592246890068054, -0.2766106128692627, -0.5470397472381592,
           -0.1617443859577179, 0.47907528281211853, 1.2431926727294922, -0.8330751061439514, -1.1793279647827148,
           0.8926116228103638, 0.674867570400238, 1.3051903247833252, 0.884595513343811, 0.14804549515247345,
           0.011620583012700081, -0.6623807549476624, -1.335988163948059, 1.5060086250305176, 0.9005835652351379,
           0.45617830753326416, 0.028502976521849632, 0.47133713960647583, -0.6326578259468079, 0.08324015140533447,
           1.9432843923568726, -1.4905492067337036, -1.0583986043930054, 0.20814596116542816, 1.1440565586090088,
           0.6104341745376587, -0.8062881231307983, 0.8272169828414917, 1.40891695022583, 1.3371987342834473,
           0.40330222249031067, 0.10940710455179214, -1.2952923774719238, 1.1383001804351807, -0.7560645937919617,
           -2.0805344581604004, 0.1357811540365219, -2.174272298812866, 0.9319251179695129, -0.3496432900428772,
           -0.7668036222457886, -0.4987693727016449, 2.6206564903259277, 0.17088750004768372, -0.46272706985473633,
           -1.1042814254760742, -1.1971060037612915, 0.14187848567962646, -0.23930779099464417, 1.6803544759750366,
           1.0675653219223022, 1.0376713275909424, 0.002817225642502308, -0.46233710646629333, 0.24258586764335632,
           -0.11896272003650665, 0.30212315917015076, -1.8529592752456665, -1.373645305633545, 1.1785311698913574,
           -0.829413890838623, -0.2643854022026062, 0.4491753578186035, 0.47948893904685974, -0.999401867389679,
           -0.6323479413986206, -0.36139440536499023, -0.4687211513519287, 0.745270311832428, 1.5303758382797241,
           -0.6138773560523987, -0.6608043313026428, 0.2927345335483551, 0.23015457391738892, 0.5302777886390686,
           0.23515373468399048, 0.27765944600105286, 0.45941615104675293, -0.4351794123649597, -0.8162676095962524,
           1.1048436164855957, 1.8157048225402832, -0.952913224697113, 0.035313282161951065, 0.3951544463634491,
           -0.824080765247345, 0.777956485748291, -1.0297514200210571, 0.2493717223405838, 1.3106374740600586,
           -0.36324021220207214, -0.669761061668396, 1.0854849815368652, 0.7678954601287842, 0.017010992392897606,
           0.30278557538986206};
      uint64_t vb[] = {4325290781178687108u, 11900873016706294709u, 136539866472862804u, 6122769341042799465u};
      size_t l = 256;
      REQUIRE(
          dot_prod_cb_enc<float /* 64 */, float /* 64 */, uint64_t>(va, vb, l) == Approx(36.7058713175).epsilon(0.01));
    }
    {
      float va[] =
          {-1.4029985666275024, 0.42392659187316895, -0.35806530714035034, 0.9787115454673767, 2.0016610622406006,
           0.25247910618782043, -1.144970178604126, -0.09950775653123856, 0.017904041334986687, -0.0833687037229538,
           -1.5164285898208618, -0.022009938955307007, -0.3615891933441162, -0.8642946481704712, -0.7293932437896729,
           0.6968532204627991, 0.6985681653022766, -1.5676393508911133, -1.5520787239074707, 0.2121340036392212,
           0.6554490923881531, -0.23971742391586304, 1.13485586643219, -0.1846344769001007, 0.3503175675868988,
           0.22309881448745728, 1.2353878021240234, -0.2226688712835312, 0.6560271978378296, 1.428856372833252,
           0.8144190907478333, 1.220411777496338, -0.3547244071960449, 0.4904949963092804, 0.5458511114120483,
           -0.5057011842727661, -0.5126436948776245, 0.9346020817756653, 0.13198769092559814, -0.5816552042961121,
           0.6123015284538269, 1.148516058921814, 0.4820154905319214, 0.00689762644469738, 0.002004012232646346,
           -0.27244439721107483, 0.928326427936554, -0.11858835816383362, 0.3765905499458313, -0.17774158716201782,
           0.8331607580184937, -0.0651649758219719, -1.558413028717041, 0.6472206711769104, -0.7679231762886047,
           1.7825847864151, -1.319348931312561, -0.6979324221611023, 0.16196538507938385, 0.8253950476646423,
           1.490748405456543, -0.7732003927230835, 0.8418883085250854, -0.20007260143756866, 0.21136412024497986,
           -0.4099949300289154, 2.431051254272461, -1.5646260976791382, -0.36882010102272034, -0.5477496981620789,
           -1.1733540296554565, -1.0889531373977661, -2.2729032039642334, -0.06657345592975616, -0.2955361306667328,
           0.1448642462491989, 1.3718370199203491, -1.7095214128494263, -1.3485052585601807, 0.7369381189346313,
           0.00850913766771555, -1.430728554725647, -0.3787045478820801, 1.0420125722885132, 2.1857190132141113,
           -0.4932945668697357, 0.271779328584671, -0.5588787794113159, 2.112056016921997, 1.5984957218170166,
           -1.8611372709274292, -0.9877496361732483, 0.2793799638748169, 1.4935623407363892, 0.9715514183044434,
           -0.23938819766044617, 1.1140660047531128, -2.4924137592315674, -1.057631015777588, 1.705660104751587,
           -0.08090536296367645, 0.9355257153511047, 0.45804187655448914, 1.0056010484695435, 1.818561315536499,
           0.20099642872810364, -0.4063720107078552, 0.784516453742981, 0.5035674571990967, -1.6399617195129395,
           -0.2731306552886963, 0.736380934715271, 0.4235582649707794, -0.2750909626483917, 0.7197152972221375,
           -0.47630181908607483, -1.0432060956954956, 1.8422518968582153, 1.0088211297988892, 0.22382190823554993,
           -1.4332343339920044, -0.16128069162368774, -0.6928487420082092, -2.6989848613739014, -0.7940940856933594,
           -1.5507475137710571, -1.4762569665908813, 1.978537678718567, -1.4558722972869873, 0.26253387331962585,
           0.9572410583496094, 0.21227099001407623, -1.80984365940094, -0.6245760917663574, -0.3591636121273041,
           -1.6871181726455688, 0.8635865449905396, -0.8595287203788757, -0.12324453890323639, 0.3824896514415741,
           0.08682109415531158, -1.309133529663086, -0.3382158875465393, 2.579911470413208, -0.9340130686759949,
           0.7262285947799683, -0.13108845055103302, -0.1305486559867859, 1.8165504932403564, -0.2554536759853363,
           -0.13985927402973175, -0.058819256722927094, -0.6436717510223389, 0.4507264792919159, 0.8015087246894836,
           0.4369330108165741, 0.3061940670013428, -1.4468820095062256, 1.6520243883132935, 0.6099451184272766,
           -2.0723674297332764, 0.1552823930978775, -1.0507045984268188, 0.007332541048526764, -0.49820226430892944,
           -1.5271697044372559, -0.7053356170654297, 0.2394402176141739, -0.9957940578460693, 2.0887537002563477,
           1.7395577430725098, 0.7522951364517212, -0.5930505394935608, -1.5882946252822876, 0.3849390149116516,
           0.6313568949699402, 0.7793550491333008, 0.8620662689208984, -0.9686914682388306, -0.8389255404472351,
           -1.061008334159851, 0.7080086469650269, 0.7983715534210205, -0.21783603727817535, 0.0062937610782682896,
           -0.16367381811141968, -0.015928959473967552, 0.9379973411560059, 1.0270781517028809, -1.8532370328903198,
           1.1006563901901245, 0.5371316075325012, -0.8535122871398926, 1.4824821949005127, -2.6133456230163574,
           -0.6323277950286865, 0.8298099637031555, 0.5629785656929016, -2.131566047668457, 0.3461780846118927,
           0.04162367060780525, -0.47873470187187195, 0.824927806854248, -0.5482980012893677, -0.4584745168685913,
           -1.1738663911819458, 0.39969369769096375, -0.49850934743881226, -0.9187633991241455, 0.43073055148124695,
           2.1770942211151123, 1.0589479207992554, -1.1544016599655151, 0.9081145524978638, -2.0260298252105713,
           0.7405201196670532, -0.36262109875679016, -1.439534306526184, 0.6888144612312317, -1.3330827951431274,
           0.7381895780563354, 1.2464754581451416, 0.9929511547088623, -1.251684308052063, -0.7803251147270203,
           0.4605306088924408, 0.4396176338195801, 0.47890475392341614, -0.17860285937786102, -1.4980322122573853,
           -0.3918227553367615, -1.2745729684829712, -0.43521788716316223, 0.9684868454933167, 0.3294215202331543,
           -0.43219679594039917, -1.04377281665802, 0.15898962318897247, 2.4903664588928223, 1.5276150703430176,
           1.6086841821670532, 0.40711718797683716, 0.447026789188385, -0.5968016386032104, -1.9531843662261963,
           -1.2107993364334106, -2.1153383255004883, 0.195965975522995, 0.4526737630367279, 1.1473358869552612,
           -0.4596429169178009, -1.2793805599212646, -0.28001320362091064, 0.5009213089942932, -0.5166869759559631,
           -1.359541893005371};
      uint64_t vb[] = {7393517284306976309u, 17705286731732734602u, 17535024660668990699u, 11505597007241285892u};
      size_t l = 256;
      REQUIRE(
          dot_prod_cb_enc<float /* 64 */, float /* 64 */, uint64_t>(va, vb, l) == Approx(11.7360950911).epsilon(0.01));
    }
    {
      float va[] = {-1.122338891029358, 1.047235131263733, 0.6766343712806702, 0.9191569089889526, -0.5380266904830933,
                    0.8961111307144165, 0.6311454772949219, -0.18409714102745056, -1.845704436302185,
                    0.9413539171218872, -0.21981069445610046, -0.004386534448713064, 0.24641743302345276,
                    -0.5147329568862915, -1.1475677490234375, -0.6036065816879272, 0.3080156147480011,
                    1.259093165397644, -1.2204933166503906, -0.46819061040878296, 0.7753448486328125,
                    -1.0256363153457642, -2.714125394821167, 0.7520989775657654, 1.7410873174667358,
                    -1.4134564399719238, 1.6302473545074463, -0.11398284137248993, 1.3607158660888672,
                    -1.311371088027954, 0.9291865229606628, -2.7559750080108643, 0.11375971138477325,
                    -0.8973228931427002, -0.45207712054252625, 1.324446439743042, 1.3772094249725342,
                    -0.16155734658241272, 0.9315134882926941, -1.422422170639038, 0.6366905570030212,
                    0.8467400074005127, -0.7506164312362671, -0.9324949383735657, -1.127936601638794,
                    -1.1235661506652832, 0.2464568018913269, -2.1054368019104004, -0.9167606234550476,
                    -0.9995205402374268, 0.1068105697631836, -0.16161982715129852, -1.2291125059127808,
                    0.5138710141181946, -0.5857426524162292, 0.8064447045326233, -0.07572270184755325,
                    1.1083332300186157, 1.246118187904358, -0.8814225196838379, 0.9943427443504333,
                    0.008041278459131718, -0.19798438251018524, -0.8926681876182556, -0.8490377068519592,
                    -0.4774404764175415, 0.23735101521015167, 1.6077176332473755, 0.2163400650024414,
                    1.5743368864059448, 1.3736401796340942, 2.171703815460205, -1.8884809017181396, -1.0945277214050293,
                    -0.7970492243766785, 1.159373164176941, 1.3794398307800293, 0.27332255244255066, 1.7063430547714233,
                    -2.081199884414673, 2.0365793704986572, 0.15981172025203705, 1.598359227180481,
                    -0.04019935801625252, -0.1765141785144806, 0.08465313166379929, 0.8847606182098389,
                    0.22643522918224335, 1.5968135595321655, 1.3620338439941406, 1.2153680324554443, 1.8609527349472046,
                    -0.22139114141464233, 0.09915746003389359, 0.5080315470695496, -0.8923035860061646,
                    0.005559762939810753, 0.7001146674156189, 0.25828975439071655, 0.20109869539737701,
                    0.9330816268920898, -0.30153560638427734, -0.49138665199279785, -1.1068949699401855,
                    0.3926958739757538, -0.8384677171707153, -1.0120201110839844, -0.6490970253944397,
                    -0.4263031482696533, 0.9065977931022644, -1.868013620376587, 1.4571447372436523, 1.5026991367340088,
                    0.32035884261131287, 0.9900516867637634, 0.5963857769966125, -0.365375816822052, 0.5055966377258301,
                    -0.10103433579206467, -0.7305440306663513, 0.7290742993354797, 0.565117359161377,
                    -1.017052173614502, 0.20128954946994781, 0.24136218428611755, 0.3082951307296753,
                    -0.5586453676223755, -0.8488112092018127, 1.522862195968628, -0.1838381290435791,
                    -0.031921666115522385, 0.8858031034469604, -0.019461095333099365, -0.8612026572227478,
                    -1.029672384262085, -1.4159682989120483, 0.8141213059425354, -0.27060315012931824,
                    0.9461963176727295, 0.7696498036384583, 0.8684052228927612, 0.5375818014144897, 0.8782267570495605,
                    -1.2215368747711182, -0.3040343225002289, -1.575510859489441, 0.19691431522369385,
                    -1.544365644454956, 1.85610032081604, 1.386849284172058, -0.08226025104522705, 0.8482083678245544,
                    0.3820558488368988, 1.1473628282546997, 2.4468414783477783, -0.2913954257965088, 0.7279666066169739,
                    0.5445973873138428, 0.3807518184185028, -1.081499457359314, 1.354345440864563, 1.4300838708877563,
                    1.0029199123382568, 0.41211068630218506, 2.0534474849700928, -1.1709473133087158,
                    0.8918454051017761, -0.6467288732528687, -0.1607126146554947, 0.49365028738975525,
                    -1.9036805629730225, -0.5833870768547058, 1.113304853439331, -0.31895583868026733,
                    1.0732933282852173, -1.6910446882247925, 0.045385368168354034, 1.069440245628357,
                    -0.3078632354736328, 1.9666804075241089, 1.6785082817077637, -0.1622724086046219,
                    -0.7680439949035645, -0.12108602374792099, 0.8133264780044556, 0.64519864320755, 0.518878161907196,
                    1.0426595211029053, -1.5683996677398682, 0.5713005065917969, -0.26789718866348267,
                    -1.3034520149230957, 0.09877468645572662, 0.4899091422557831, 0.8494904637336731,
                    1.5275449752807617, 0.39711472392082214, -0.22877174615859985, 0.626183032989502,
                    0.19919808208942413, -1.0718990564346313, 0.19917315244674683, -1.9459443092346191,
                    -1.1037907600402832, 1.2147406339645386, 1.166039228439331, -1.0348777770996094, 1.3806792497634888,
                    1.337977409362793, -0.752546489238739, 0.7443616390228271, 0.5421477556228638, -1.870816707611084,
                    -1.2389466762542725, -0.19104371964931488, 0.6909801959991455, 0.5547849535942078,
                    -0.5622268319129944, -1.7185128927230835, -1.1095088720321655, -0.7356514930725098,
                    1.5835282802581787, 0.0007694291416555643, 0.32230278849601746, 0.4888443648815155,
                    1.431645393371582, -1.5608103275299072, 0.8850898742675781, 0.12028740346431732, 0.5123597383499146,
                    -0.31129196286201477, -1.18366539478302, 2.2917397022247314, -2.0854153633117676,
                    0.2942672371864319, 1.0249186754226685, -0.5416840314865112, 0.7443298697471619,
                    -0.9293293952941895, -1.5468273162841797, 2.081254720687866, -0.8165432214736938, 0.568044900894165,
                    0.1250474601984024, 0.040083449333906174, -0.5101572275161743, 0.8082662224769592,
                    0.983031690120697, 1.0291008949279785, -0.8982113003730774, -0.012101932428777218,
                    -1.4886754751205444, -0.12842628359794617, 0.5594388246536255, 1.4737776517868042,
                    0.9473254084587097};
      uint64_t vb[] = {9933815717931045856u, 3260961403198417920u, 18357121806638251795u, 643975864720885647u};
      size_t l = 256;
      REQUIRE(
          dot_prod_cb_enc<float /* 64 */, float /* 64 */, uint64_t>(va, vb, l) == Approx(-5.74200306204).epsilon(0.01));
    }
    {
      float va[] =
          {0.39352118968963623, -0.3919788599014282, 0.9529680609703064, 0.2781279683113098, -0.8412285447120667,
           0.022334642708301544, 0.03719370439648628, -0.5238817930221558, 0.5341585278511047, 0.9299860596656799,
           2.002166986465454, -1.7422029972076416, 0.29471415281295776, 1.1613415479660034, -1.1966466903686523,
           2.046469211578369, 0.9781371355056763, -1.416306972503662, 0.7657851576805115, -0.810088574886322,
           -0.1497657597064972, 1.4646674394607544, 0.5644649863243103, 0.037485528737306595, -1.3270039558410645,
           -0.7284347414970398, 0.3823779225349426, 0.44863903522491455, 1.005605936050415, -1.2222843170166016,
           0.5724072456359863, -0.46270328760147095, -0.22387027740478516, 0.4057440459728241, 1.3770751953125,
           -0.09052317589521408, -0.3073520064353943, -0.26684874296188354, -0.6126518249511719, -1.0110113620758057,
           -0.5118367075920105, -0.1288900375366211, 0.023111239075660706, 1.0232254266738892, 0.7370915412902832,
           0.6084364056587219, -1.4894026517868042, -0.25555601716041565, 0.10889590531587601, 0.8259420990943909,
           0.29545778036117554, 0.35175251960754395, 1.43779456615448, -0.20411403477191925, 0.54106205701828,
           -1.5294272899627686, -1.3532592058181763, -0.3332877457141876, -0.7911095023155212, 0.869564414024353,
           -0.022075623273849487, 0.9266953468322754, -0.33313652873039246, -1.4584001302719116, -0.5968723297119141,
           -0.04154723510146141, -0.9004222750663757, 1.2760192155838013, 0.5519000887870789, 0.33265602588653564,
           0.13594551384449005, 0.6045168042182922, -0.6604176163673401, -1.2106647491455078, 0.23344366252422333,
           -0.6269135475158691, -0.40928876399993896, 1.1949703693389893, -0.1493772715330124, -1.2422986030578613,
           0.7594582438468933, 0.6959535479545593, -0.3795825242996216, 0.5031283497810364, -1.302392601966858,
           -2.4023935794830322, 0.6835212707519531, -0.42376500368118286, 0.42111480236053467, -1.26896071434021,
           1.4741599559783936, -1.2540675401687622, -0.006009186152368784, 0.07155951857566833, 0.2943461239337921,
           -0.6274601817131042, -1.6341749429702759, -0.09709325432777405, 0.872119665145874, -2.0949676036834717,
           0.8258301019668579, 1.086011290550232, -0.33690598607063293, 0.10798555612564087, -0.5930695533752441,
           -0.6939996480941772, -1.166685938835144, 1.7863720655441284, 0.6142101883888245, 0.8329348564147949,
           1.0970567464828491, -0.10745184123516083, -1.481710433959961, -0.35597801208496094, 0.8292543888092041,
           -1.1140971183776855, -1.0692076683044434, 1.4205371141433716, 1.3466864824295044, 0.8803008794784546,
           -0.6521346569061279, -1.5273994207382202, -0.7917903661727905, 1.080186367034912, -1.995665192604065,
           -0.47962093353271484, -1.250699758529663, -0.5578831434249878, 0.3983827233314514, -1.9829744100570679,
           -0.8991513848304749, 1.8409193754196167, -0.9216287136077881, -2.423903226852417, 0.23228828608989716,
           0.4988415539264679, -0.3301977515220642, -1.2557971477508545, -0.09742052108049393, -0.6476194262504578,
           0.6156898140907288, -0.9812935590744019, 0.696799099445343, 1.9246646165847778, -0.5422502160072327,
           2.1217544078826904, -1.4101814031600952, 1.266496181488037, -1.6610467433929443, 0.11205065995454788,
           -0.3626581132411957, -0.47018322348594666, 0.788951575756073, 0.3021472990512848, 0.5109997987747192,
           -0.3497328460216522, -0.523866593837738, -0.05258278548717499, -0.6235590577125549, -1.191677451133728,
           0.9013919234275818, 0.5625761151313782, -0.1255744993686676, 0.5182667970657349, -0.2298142910003662,
           -1.1301325559616089, -0.7745092511177063, -1.1593010425567627, -0.22210322320461273, -1.5344715118408203,
           1.3067213296890259, -0.29304811358451843, 0.6477029323577881, -0.9185121655464172, 2.914323091506958,
           -1.7281489372253418, -1.8685752153396606, -0.4315548241138458, -1.3396637439727783, 1.0426994562149048,
           1.2164334058761597, 1.4103552103042603, 0.2241225689649582, -0.4085885286331177, -0.8794321417808533,
           1.1340675354003906, 0.20577947795391083, 1.558496117591858, -0.3181491196155548, -0.5670488476753235,
           0.7134281992912292, -1.8058034181594849, -0.21245750784873962, -0.4445858597755432, 0.3421148359775543,
           -1.0668076276779175, 1.2100269794464111, 1.116549015045166, 1.4350463151931763, -1.080376386642456,
           1.5921783447265625, -0.9101654887199402, -0.1743999868631363, -1.643459677696228, -1.0124452114105225,
           0.8434332013130188, 0.4735347330570221, 0.7448692917823792, 0.6511142253875732, 0.21977640688419342,
           -0.1922513097524643, -1.09223473072052, -1.2142037153244019, 0.23889166116714478, -0.6709768772125244,
           -0.5223166942596436, 0.13950486481189728, 0.24314385652542114, -0.5362626314163208, 1.5764538049697876,
           -0.26833152770996094, 0.03082718513906002, -1.463988184928894, -0.08736260235309601, -1.4373493194580078,
           -0.07997522503137589, -0.3584059476852417, 1.074408769607544, -0.6413981914520264, 0.6302550435066223,
           0.8713113069534302, 1.9983121156692505, -0.27474111318588257, -0.46979567408561707, 0.14086873829364777,
           1.2930952310562134, 0.6801791787147522, -0.14133860170841217, 2.2043251991271973, 0.5263631939888,
           -0.04332566633820534, -2.127798080444336, 0.4937000572681427, -1.1577798128128052, -0.9832786917686462,
           -1.3440059423446655, 0.8330960869789124, -0.011484364978969097, -0.3949638903141022, 0.5291686058044434,
           0.6003665924072266, 0.4698340892791748, -1.3466980457305908, 0.05040562152862549, -0.3939996063709259,
           -1.1623069047927856};
      uint64_t vb[] = {9720889014263091502u, 17145477095707214563u, 11193489180004986509u, 3888544205773590784u};
      size_t l = 256;
      REQUIRE(
          dot_prod_cb_enc<float /* 64 */, float /* 64 */, uint64_t>(va, vb, l) == Approx(-3.72769778827).epsilon(0.01));
    }
  }

  SECTION("float dot_prod_cb_enc(const float*, const uint64_t*, size_t), dim=60") {
    {
      float va[] =
          {-0.7214112281799316, -0.6018544435501099, -0.7468152642250061, -0.9210873246192932, -1.6251857280731201,
           -0.2782121002674103, -1.7552988529205322, 0.3719753921031952, -1.512768268585205, -0.37527525424957275,
           -1.735929250717163, 1.6537169218063354, 0.3208755850791931, 0.008654026314616203, -0.09343242645263672,
           1.025779128074646, -0.19161143898963928, -0.6687297224998474, -0.5196080803871155, 0.03308368846774101,
           0.6395163536071777, 0.6421870589256287, -0.9563199281692505, -0.37176376581192017, -0.04473345726728439,
           -0.3216925859451294, -0.9357735514640808, 0.1947518140077591, 0.36090144515037537, 0.20697592198848724,
           0.44716569781303406, 0.6071169376373291, -0.4586225748062134, -0.804206907749176, 0.08478932082653046,
           -0.05652693659067154, -0.5822258591651917, 0.4673842191696167, -0.19677148759365082, 0.21106891334056854,
           1.2762662172317505, 0.17005835473537445, 0.9936225414276123, -0.838422417640686, -0.7778592109680176,
           -1.9225914478302002, -0.8560150265693665, -1.0148241519927979, -0.06998009234666824, 1.3484503030776978,
           -1.2808994054794312, 0.5778799653053284, 0.32508784532546997, -0.6066698431968689, 0.7750596404075623,
           -0.9546041488647461, 0.18211455643177032, -0.8487467765808105, -0.019890129566192627, -0.6441535949707031};
      uint64_t vb[] = {189665647281014653u};
      size_t l = 60;
      REQUIRE(
          dot_prod_cb_enc<float /* 64 */, float /* 64 */, uint64_t>(va, vb, l) == Approx(5.74340594001).epsilon(0.01));
    }
    {
      float va[] =
          {-1.5072193145751953, 0.32291293144226074, -0.1460547000169754, 0.7444106340408325, 0.5094981789588928,
           -0.4910445213317871, -1.9202059507369995, -1.415333867073059, 1.2898437976837158, 2.7658097743988037,
           0.5130089521408081, -1.2906306982040405, 1.3260294198989868, 0.6881483197212219, -0.5674709677696228,
           -2.265390157699585, -2.089085578918457, -0.6749522686004639, 0.1617320477962494, -1.963571548461914,
           -0.3911815285682678, -0.870507538318634, -0.531152606010437, -1.916758418083191, 0.17878687381744385,
           -1.5849895477294922, -0.03530839830636978, -0.860314667224884, -0.07723265141248703, 0.19077841937541962,
           -0.08773660659790039, 0.08162802457809448, -0.010788651183247566, 0.549399733543396, 0.7546637058258057,
           0.9767897129058838, -2.3321547508239746, 0.6505617499351501, -1.1893036365509033, -0.04458915814757347,
           -2.2503488063812256, -0.6689881682395935, -0.26421788334846497, 0.09249386936426163, 0.15113027393817902,
           -1.1302541494369507, 1.614182710647583, -0.8219614028930664, -0.3812350630760193, 1.5764217376708984,
           -1.3406219482421875, -0.007330980151891708, 0.08245020359754562, -0.5067926645278931, 1.0992945432662964,
           -0.23511990904808044, -1.536320447921753, -1.1927356719970703, 0.12145818769931793, 0.26825815439224243};
      uint64_t vb[] = {668716766780405692u};
      size_t l = 60;
      REQUIRE(
          dot_prod_cb_enc<float /* 64 */, float /* 64 */, uint64_t>(va, vb, l) == Approx(15.0641057026).epsilon(0.01));
    }
    {
      float va[] = {1.447455883026123, 0.7263305187225342, 1.2843669652938843, 1.2252951860427856, 0.6080753207206726,
                    0.9531019330024719, 2.0774919986724854, -0.9741665720939636, -0.8789151906967163,
                    1.0297902822494507, 0.8192359209060669, -1.658764362335205, -0.13026893138885498,
                    -1.837322473526001, 0.39283186197280884, -1.6658343076705933, -0.2642429769039154,
                    1.2619982957839966, -1.549800992012024, -0.13036257028579712, 1.5248860120773315,
                    -0.35835644602775574, 0.4558790326118469, 1.858053207397461, -1.9429479837417603,
                    0.0629761815071106, -0.8826241493225098, 0.33841603994369507, -0.5758779644966125,
                    -0.09802145510911942, 0.04550114646553993, 1.0316786766052246, 1.070754051208496,
                    -1.9293392896652222, 0.18832139670848846, -0.8481957316398621, -0.0028192754834890366,
                    0.04702377691864967, 0.6205708980560303, 1.4618306159973145, 1.2512452602386475,
                    -0.9247031211853027, -1.5742205381393433, -0.40850380063056946, -0.8862662315368652,
                    -0.5850280523300171, 1.0355550050735474, 0.4803401231765747, 1.279873251914978, 0.5894880294799805,
                    -0.4253828525543213, 0.24853593111038208, 0.32418352365493774, 1.322269082069397,
                    0.045301955193281174, 0.09808236360549927, 0.6699516773223877, 0.08706837892532349,
                    0.3612259030342102, 0.7492280006408691};
      uint64_t vb[] = {1065060464589717973u};
      size_t l = 60;
      REQUIRE(
          dot_prod_cb_enc<float /* 64 */, float /* 64 */, uint64_t>(va, vb, l) == Approx(-5.86772613786).epsilon(0.01));
    }
    {
      float va[] =
          {-1.2591935396194458, -1.852204442024231, 0.4691176414489746, -1.8120871782302856, 0.19999250769615173,
           -0.5464869737625122, -0.15620549023151398, 0.9158515930175781, -2.559220314025879, -1.8863823413848877,
           -0.3443063199520111, -0.9093918204307556, -0.018363632261753082, 0.9344714283943176, -0.967288613319397,
           -0.14375293254852295, 0.29862186312675476, 1.2426912784576416, -0.6428468823432922, -0.21787376701831818,
           -0.7745377421379089, -0.016177313402295113, 0.11710570752620697, -0.13281871378421783, -1.7970823049545288,
           -0.5212359428405762, -0.0703519806265831, 0.4602310061454773, 1.5281212329864502, 0.26191309094429016,
           -0.9969815015792847, 0.33947187662124634, -0.45062392950057983, -0.10198017209768295, -1.5296911001205444,
           -1.2045166492462158, -1.1350640058517456, 0.6879735589027405, 0.5198388695716858, 0.14775216579437256,
           0.12863846123218536, 1.1855747699737549, 1.3260830640792847, 0.24374355375766754, -0.10543014109134674,
           0.20241935551166534, 1.4014190435409546, 0.4588468670845032, -1.531266689300537, 1.2030980587005615,
           1.785793662071228, 0.47744619846343994, -1.5162749290466309, -0.306673526763916, 0.153323695063591,
           -0.7275521755218506, -0.47128504514694214, 0.6242397427558899, -0.1482262909412384, 0.9194781184196472};
      uint64_t vb[] = {664191693965868575u};
      size_t l = 60;
      REQUIRE(
          dot_prod_cb_enc<float /* 64 */, float /* 64 */, uint64_t>(va, vb, l) == Approx(2.2843197044).epsilon(0.01));
    }
    {
      float va[] =
          {1.669090986251831, -0.4675460159778595, -0.04784685745835304, 2.1094589233398438, -0.877780556678772,
           -1.103112816810608, 1.0923129320144653, -2.444340944290161, 0.42674148082733154, 0.7482492327690125,
           -0.4558105766773224, -0.5720573663711548, 1.3623273372650146, 0.14089474081993103, -0.6447713971138,
           1.7988218069076538, -0.2761041820049286, -0.6308919787406921, 0.16235966980457306, 0.543850839138031,
           -1.2421436309814453, -0.6696956753730774, 0.018144577741622925, 0.9698808193206787, -0.8615602850914001,
           -0.6320731043815613, -1.2280737161636353, -0.322126179933548, -2.2464210987091064, 0.10681453347206116,
           -1.8692444562911987, -1.4944332838058472, -1.389073133468628, -0.9243104457855225, 0.7184685468673706,
           -0.24012668430805206, -1.8830589056015015, -1.7525864839553833, -1.1213390827178955, 0.8304319381713867,
           1.3385685682296753, 0.5660280585289001, 0.06381929665803909, -0.031980156898498535, 0.21722841262817383,
           -0.6543132662773132, -0.5698812007904053, -0.8596708178520203, -1.0223199129104614, 0.7467547655105591,
           1.215029239654541, 1.6882230043411255, -0.5317310690879822, -0.17164412140846252, 0.3569490611553192,
           1.4881012439727783, 1.6923940181732178, -0.8307123184204102, -1.6646820306777954, 1.7981075048446655};
      uint64_t vb[] = {139136240087736392u};
      size_t l = 60;
      REQUIRE(
          dot_prod_cb_enc<float /* 64 */, float /* 64 */, uint64_t>(va, vb, l) == Approx(-2.62331852689).epsilon(0.01));
    }
  }

  SECTION("float dot_prod_cb_enc(const float*, const uint64_t*, size_t), dim=59") {
    {
      float va[] =
          {-0.5386907458305359, -0.8301909565925598, -0.2931564748287201, -1.4913444519042969, -0.8911731243133545,
           -1.1785789728164673, 0.3853117525577545, 0.5642077326774597, -0.1203114241361618, -0.24542021751403809,
           -0.8240517973899841, 2.2835209369659424, -0.5939046740531921, 1.04678475856781, 0.44896399974823,
           0.9516321420669556, 0.5126615762710571, -0.7264178395271301, 0.2217978984117508, 1.9216080904006958,
           -1.6391525268554688, -0.6690632700920105, -0.4530838429927826, 0.07514700293540955, -0.16397246718406677,
           1.2862606048583984, 0.001598642091266811, 0.5015547275543213, 0.492959201335907, -0.8482966423034668,
           0.4838169515132904, -0.6711485385894775, -0.20470711588859558, 0.4780918061733246, -0.8060363531112671,
           0.04433143511414528, 0.8899074792861938, 1.2276487350463867, 0.14558449387550354, -1.0516846179962158,
           -1.4998749494552612, 0.8436794281005859, -0.01298384927213192, 0.0017465865239501, 1.2614027261734009,
           1.9349658489227295, -0.5777738690376282, -1.322779893875122, 0.12458881735801697, -0.22068247199058533,
           1.511886477470398, 0.6365542411804199, 0.6183447241783142, 0.6946999430656433, 0.402656614780426,
           0.45809435844421387, -0.9284266829490662, 0.22882792353630066, 2.1222264766693115};
      uint64_t vb[] = {482560084676091292u};
      size_t l = 59;
      REQUIRE(
          dot_prod_cb_enc<float /* 64 */, float /* 64 */, uint64_t>(va, vb, l) == Approx(-8.2884599847).epsilon(0.01));
    }
    {
      float va[] =
          {-0.1584504395723343, -0.2373734414577484, -0.5823091268539429, -0.6717170476913452, -0.8218424916267395,
           0.07700274884700775, 0.7824622988700867, -0.5009242296218872, -0.2993803918361664, -1.7043150663375854,
           2.732483386993408, -0.5066462159156799, 0.355182945728302, -0.602112889289856, 0.18783323466777802,
           -0.30554553866386414, -0.27404001355171204, -0.774597704410553, 0.5311405658721924, -0.8778516054153442,
           -0.5891356468200684, -0.4744860827922821, 0.3377794027328491, 0.44690850377082825, -1.6797502040863037,
           -0.6156123876571655, 0.814874529838562, 1.577054500579834, -0.5146313905715942, 0.025366518646478653,
           -0.2290964126586914, -0.6191214919090271, -0.3380740284919739, 0.7838835716247559, 1.1942541599273682,
           -0.9868896007537842, 0.4326959252357483, -0.6928331255912781, 1.7203971147537231, -0.3298906981945038,
           0.7502405047416687, -1.320095181465149, -2.1907639503479004, -1.7401225566864014, 0.14740727841854095,
           -0.6545010805130005, 0.3681527376174927, -1.2835173606872559, 0.568068265914917, -2.401139736175537,
           -0.35205531120300293, -0.9204666018486023, 0.19509568810462952, -1.3442853689193726, 0.5156189203262329,
           0.6887388825416565, 0.8080320954322815, -0.31846553087234497, 1.0117502212524414};
      uint64_t vb[] = {374160716134506529u};
      size_t l = 59;
      REQUIRE(
          dot_prod_cb_enc<float /* 64 */, float /* 64 */, uint64_t>(va, vb, l) == Approx(14.077621337).epsilon(0.01));
    }
    {
      float va[] =
          {0.722801923751831, -0.5442906022071838, -1.064910650253296, 0.33674710988998413, -1.7610400915145874,
           -1.6296921968460083, -0.550055742263794, 1.0590544939041138, 0.6000722646713257, 1.0293675661087036,
           -0.5328378081321716, 1.148643970489502, -1.0005736351013184, 0.7935791611671448, 0.2063930332660675,
           -0.4061451554298401, -0.9894543290138245, -2.0364444255828857, 1.7914115190505981, -0.42789748311042786,
           0.10350646823644638, -0.15401193499565125, -1.7048248052597046, -2.448941469192505, -0.3627614676952362,
           -0.635551393032074, 0.6336746215820312, 0.10526922345161438, -1.680261254310608, -0.7476998567581177,
           0.17790605127811432, -0.8191928863525391, -0.5091555714607239, -0.22203364968299866, -0.5626013875007629,
           0.007509240414947271, -1.7221183776855469, -1.2313345670700073, -2.5800514221191406, -0.02098453976213932,
           -0.13827666640281677, -0.8849793076515198, -0.08903418481349945, -1.7145048379898071, -0.6488116979598999,
           -1.2164229154586792, -0.8005900382995605, 1.0193026065826416, -3.121490716934204, -1.5968133211135864,
           -0.1519024521112442, -0.0920400395989418, 0.31662338972091675, 1.4935858249664307, -0.9136350750923157,
           -0.6200520396232605, -0.8388952016830444, 0.10421538352966309, 0.2812989056110382};
      uint64_t vb[] = {375660580106158512u};
      size_t l = 59;
      REQUIRE(
          dot_prod_cb_enc<float /* 64 */, float /* 64 */, uint64_t>(va, vb, l) == Approx(8.95035575004).epsilon(0.01));
    }
    {
      float va[] =
          {0.24028636515140533, -1.0245825052261353, -0.47955483198165894, 0.015881959348917007, -1.7268821001052856,
           -0.678793728351593, 0.7159510850906372, 1.9767649173736572, -0.15616543591022491, 2.005187511444092,
           0.08257890492677689, -1.093756914138794, -0.9766761064529419, 0.5807526707649231, -1.604577660560608,
           -0.8761879205703735, -1.2938942909240723, -1.9633561372756958, -1.3598674535751343, 0.0755237564444542,
           0.19468092918395996, -0.36015796661376953, -1.0669775009155273, 1.5224238634109497, 0.10103511065244675,
           0.08069221675395966, 0.7836662530899048, -0.5619630217552185, -0.32935741543769836, 1.4393103122711182,
           -0.5352679491043091, -0.36356738209724426, 0.012209744192659855, 0.6110023856163025, 0.5410516262054443,
           -0.6650806665420532, 0.3823641240596771, 0.49758946895599365, -1.902204990386963, -0.3876952826976776,
           -2.408632755279541, -0.17237208783626556, -0.47458750009536743, 0.7210665941238403, 0.6612203121185303,
           0.18046292662620544, 0.6305273771286011, 0.5045623779296875, 0.5626586675643921, -0.18729731440544128,
           -1.1339786052703857, 1.5457957983016968, -1.4582490921020508, -1.364027976989746, 0.7305014133453369,
           1.5642497539520264, -1.466294527053833, -1.8425099849700928, -0.6955551505088806};
      uint64_t vb[] = {316580367920166396u};
      size_t l = 59;
      REQUIRE(
          dot_prod_cb_enc<float /* 64 */, float /* 64 */, uint64_t>(va, vb, l) == Approx(-8.49447720777).epsilon(0.01));
    }
    {
      float va[] =
          {1.010166883468628, -0.09888526052236557, -0.35420340299606323, 0.888350248336792, 0.1352367252111435,
           -0.3696882128715515, -2.9997105598449707, -0.2344086915254593, -0.18543291091918945, 1.2921217679977417,
           -0.08869823813438416, 0.45724964141845703, 0.25311729311943054, 0.3846018314361572, -1.932726502418518,
           -1.5239664316177368, 0.19180873036384583, 0.6022895574569702, -1.2139604091644287, -1.0893718004226685,
           0.5076179504394531, -1.0685863494873047, -0.442265123128891, 0.15637418627738953, -0.4526870548725128,
           1.1101775169372559, -0.4604291319847107, 0.30435213446617126, -0.4958357810974121, -0.49114587903022766,
           0.8608662486076355, -0.5118259787559509, -0.1684465855360031, -0.5280020833015442, -0.8045235276222229,
           -0.08700509369373322, 0.97858726978302, 0.6696841716766357, 0.0965539813041687, 0.5730310678482056,
           0.6293678283691406, 0.753811776638031, -0.1511469930410385, 1.3455814123153687, -0.5632556080818176,
           -1.2247055768966675, -0.47109419107437134, 0.35195234417915344, 0.5127744674682617, -0.8367034792900085,
           -0.8273778557777405, 0.16111886501312256, 1.010896921157837, 0.5259758234024048, 0.8601528406143188,
           0.2957768440246582, 0.40458744764328003, 0.38204869627952576, -0.3027294874191284};
      uint64_t vb[] = {348195850770958845u};
      size_t l = 59;
      REQUIRE(
          dot_prod_cb_enc<float /* 64 */, float /* 64 */, uint64_t>(va, vb, l) == Approx(8.7865235284).epsilon(0.01));
    }
  }

  SECTION("float dot_prod_cb_enc(const float*, const uint64_t*, size_t), dim=100") {
    {
      float va[] =
          {-0.4502343535423279, 0.2340504378080368, -0.2521999776363373, 0.8637936115264893, 0.8278205990791321,
           0.7750670909881592, -1.1685080528259277, -1.064908504486084, -0.8220813870429993, 0.2544955611228943,
           0.15180045366287231, 0.0672597736120224, -0.3483414351940155, -0.5218856334686279, 0.6272088885307312,
           -0.16211068630218506, 0.6780319809913635, 1.314333438873291, -1.025075912475586, -1.9513576030731201,
           -1.3208359479904175, -0.14588341116905212, -0.9061060547828674, -1.9138792753219604, -1.6867341995239258,
           0.4121156334877014, -0.6642969250679016, -0.7395026683807373, -1.0831634998321533, -1.6884922981262207,
           0.7186826467514038, 0.6002199649810791, 0.24050690233707428, 1.9365602731704712, 0.7844417095184326,
           0.48153460025787354, 0.010134960524737835, 0.8779663443565369, 1.1705543994903564, 2.050053596496582,
           -0.7174269556999207, 0.6909950375556946, -0.073536716401577, -1.5493919849395752, -0.34054023027420044,
           0.0467156283557415, 0.9239502549171448, -1.1615242958068848, -1.4384088516235352, -0.2384488880634308,
           1.5612422227859497, -0.8512443900108337, -0.23524346947669983, -0.8112002015113831, -0.9069462418556213,
           -0.0909048318862915, 0.09582670032978058, -0.9005123972892761, -0.004947860725224018, 0.9791213274002075,
           -0.3065160810947418, -0.48047012090682983, 0.9436417818069458, -0.29552239179611206, 0.01783190667629242,
           -1.0853586196899414, 0.041854798793792725, 0.3910614252090454, 0.23859594762325287, -0.4906396269798279,
           1.9306334257125854, 1.7030229568481445, 1.1110808849334717, 0.30688703060150146, -0.8500550985336304,
           -0.7033864259719849, 0.4241306781768799, -0.633222758769989, -1.6006383895874023, -1.6594648361206055,
           1.1898090839385986, 0.04896976426243782, -1.982919692993164, -0.4188040792942047, -0.616062343120575,
           0.7550668120384216, 0.3444797098636627, -0.9964127540588379, -0.06194448098540306, 2.7346599102020264,
           0.4628591537475586, 0.3369410037994385, 0.6494404077529907, 0.1092643216252327, -0.7565523386001587,
           0.3279045820236206, -0.9350112676620483, 1.996793508529663, 0.04451669007539749, -1.3259702920913696};
      uint64_t vb[] = {12350163627757739496u, 6345917321u};
      size_t l = 100;
      REQUIRE(
          dot_prod_cb_enc<float /* 64 */, float /* 64 */, uint64_t>(va, vb, l) == Approx(-7.01232552342).epsilon(0.01));
    }
    {
      float va[] = {-2.452477216720581, 0.6307218074798584, 1.1238301992416382, 0.33609968423843384, 0.5478329062461853,
                    0.2723532021045685, 0.6943864822387695, -0.32565614581108093, 0.43493902683258057,
                    0.058320656418800354, 0.33007511496543884, -0.7858178019523621, 0.794808566570282,
                    -0.20553025603294373, -1.1107934713363647, 1.3041099309921265, -0.2444864809513092,
                    0.770343005657196, -1.3398693799972534, 0.9109805822372437, 0.11550920456647873, 1.503941535949707,
                    -0.06790003180503845, 1.1087567806243896, 0.25726473331451416, -0.08966115117073059,
                    0.1995752453804016, -0.39423784613609314, 1.4854466915130615, 0.6834582686424255, 0.746005654335022,
                    0.8366668820381165, 2.1220107078552246, 0.017965996637940407, 0.65462327003479, 0.4819033443927765,
                    -0.7181543111801147, 0.1986333131790161, -2.1780471801757812, 1.2271674871444702,
                    1.7785366773605347, 0.8125351667404175, 1.7644996643066406, 0.06201536953449249, 1.088109016418457,
                    -1.5245972871780396, 1.3289624452590942, 0.4432450234889984, -1.4333804845809937,
                    0.7434482574462891, 1.224397897720337, 0.6622344851493835, -1.4386357069015503, 0.7991622686386108,
                    -0.326852411031723, 1.075587511062622, -0.5034608244895935, 0.0208746287971735, 1.063474178314209,
                    1.9685276746749878, -0.1387374997138977, 0.2642168402671814, -0.2825299799442291,
                    -1.2169060707092285, 1.1551321744918823, 0.33091428875923157, 0.5977121591567993,
                    -0.10059906542301178, 0.5656983852386475, -0.2287907600402832, -0.17477791011333466,
                    0.726627767086029, 1.7375415563583374, -0.35069096088409424, 0.22587504982948303,
                    -0.3809509575366974, 0.05479329451918602, -1.6477992534637451, -0.6781688332557678,
                    -0.2199455350637436, -1.0008231401443481, -0.05323897302150726, -0.29079270362854004,
                    -0.33964526653289795, 2.7032806873321533, -0.3470732271671295, 0.13452555239200592,
                    -0.019297359511256218, -0.5189429521560669, 0.11996997147798538, -2.029585123062134,
                    0.05511174350976944, -1.8075639009475708, -0.7248507738113403, -1.252040147781372,
                    1.9937375783920288, -0.7129598259925842, 1.8177543878555298, 0.01625046692788601,
                    -0.6331579089164734};
      uint64_t vb[] = {2445820442278389128u, 53937994369u};
      size_t l = 100;
      REQUIRE(dot_prod_cb_enc<float /* 64 */, float /* 64 */, uint64_t>(va, vb, l)
                  == Approx(0.0162110626698).epsilon(0.01));
    }
    {
      float va[] =
          {-0.6843512058258057, 0.975884735584259, 1.4013992547988892, 0.14622436463832855, -1.2278378009796143,
           0.2600017189979553, -0.1006259173154831, 0.6137382388114929, 1.6587492227554321, 1.077475666999817,
           0.03775768727064133, 0.4200765788555145, -0.7887101173400879, -0.1243530660867691, 0.07203284651041031,
           -0.7059661149978638, 1.0915367603302002, -1.5420258045196533, -0.22856765985488892, -0.6485350728034973,
           -0.6453084349632263, 0.7075940370559692, 0.6530304551124573, 0.16637052595615387, -1.8819968700408936,
           -0.7742027044296265, -1.6003557443618774, 0.334639310836792, -0.84169602394104, 0.04139244928956032,
           -0.6021712422370911, 1.0006307363510132, 0.41645321249961853, -0.21348904073238373, -0.5250493288040161,
           -0.9813451766967773, 1.022486925125122, -0.21167825162410736, 1.0618647336959839, 0.5274316668510437,
           -0.1540309488773346, 1.028582215309143, -0.262146532535553, -0.5557582378387451, 0.3634501099586487,
           -1.749725341796875, -0.16046346724033356, 0.7168448567390442, -0.9022942185401917, 0.931806743144989,
           -2.085505723953247, 0.9631547331809998, 0.014486173167824745, 0.5935077667236328, -0.10685563087463379,
           1.1909267902374268, -0.9652906060218811, 1.8327276706695557, 1.4009467363357544, -1.2057172060012817,
           1.132612705230713, -0.8386643528938293, -0.3199672996997833, 0.23169352114200592, -1.7195237874984741,
           0.5055617094039917, 1.4767216444015503, -1.000948429107666, -0.8098394870758057, 0.03199929744005203,
           -0.32769137620925903, -0.6556011438369751, -1.0443141460418701, -1.1299149990081787, -0.6256459355354309,
           -0.3917088806629181, -1.5074814558029175, -0.5637571811676025, 0.42919936776161194, -1.776607632637024,
           1.0447028875350952, -0.6855481266975403, -0.5190576910972595, 0.008869491517543793, 0.5097053050994873,
           -0.7953697443008423, 0.5762842297554016, 0.08171000331640244, 0.7803316712379456, 2.120340585708618,
           -0.6565283536911011, 1.1595996618270874, 1.8667082786560059, -1.823866844177246, 0.06245110183954239,
           -0.19048094749450684, 0.8756037354469299, -0.8930119276046753, -0.7834116220474243, 0.13163240253925323};
      uint64_t vb[] = {6950921226452575162u, 65622276934u};
      size_t l = 100;
      REQUIRE(
          dot_prod_cb_enc<float /* 64 */, float /* 64 */, uint64_t>(va, vb, l) == Approx(0.360922792926).epsilon(0.01));
    }
    {
      float va[] =
          {0.3195573687553406, -2.7744429111480713, -0.3228335380554199, -0.9046463966369629, 1.1437134742736816,
           -0.8558909296989441, -1.247852087020874, 0.4255640208721161, -1.990532636642456, 1.0318776369094849,
           -1.0963302850723267, -0.8714187741279602, -0.5379778742790222, 0.739868700504303, -0.8829518556594849,
           0.2451438158750534, -1.328323245048523, -0.8497631549835205, 0.43292707204818726, 0.7573010921478271,
           0.6320722103118896, 0.8028786182403564, 0.240060955286026, -0.7199823260307312, -2.0488545894622803,
           -0.40469619631767273, -0.3143240213394165, -0.2867337167263031, 0.6694642305374146, -1.9240316152572632,
           -1.5318738222122192, 1.1186822652816772, 1.5426894426345825, -0.13719578087329865, -0.13157156109809875,
           0.938288152217865, 0.9297443628311157, 0.36064809560775757, 1.4110068082809448, -0.18828564882278442,
           -0.8984817862510681, -0.6658793687820435, -0.6113986968994141, 0.36692583560943604, -0.4647546708583832,
           0.7109785676002502, 1.3732346296310425, 0.9638475775718689, -0.11980626732110977, -1.5664129257202148,
           0.3054354786872864, 0.14414747059345245, -0.7564032077789307, -0.6054117679595947, -0.08219878375530243,
           0.9220208525657654, -1.7860848903656006, 0.687623143196106, 0.2716105282306671, -1.8183133602142334,
           -0.2836102843284607, -2.326340913772583, -0.6487960815429688, -0.16603636741638184, -1.8062975406646729,
           0.19766166806221008, 0.1711752563714981, -1.2532001733779907, -0.5295418500900269, -1.2189253568649292,
           0.6072969436645508, 1.2079113721847534, -0.434987336397171, 1.262506365776062, 0.7685233354568481,
           -3.1749608516693115, -1.729202389717102, -1.156191110610962, 0.49532637000083923, 1.2873589992523193,
           -0.5843798518180847, 0.810911238193512, 1.3379000425338745, 0.6848569512367249, -0.6551461815834045,
           0.5949464440345764, 0.41714826226234436, -1.3730806112289429, -0.05393436178565025, 1.5440293550491333,
           -0.36681854724884033, -0.777553379535675, -0.7845005393028259, 1.2069376707077026, -1.0023006200790405,
           -0.7001474499702454, -0.4196496307849884, 0.8947158455848694, 0.4730962812900543, -1.399863362312317};
      uint64_t vb[] = {9337816882714707578u, 15904578027u};
      size_t l = 100;
      REQUIRE(
          dot_prod_cb_enc<float /* 64 */, float /* 64 */, uint64_t>(va, vb, l) == Approx(-1.48669466749).epsilon(0.01));
    }
    {
      float va[] = {2.5494141578674316, 0.66225266456604, 0.4867483675479889, 0.5638945698738098, -0.2922850251197815,
                    0.7423518300056458, -0.2178928703069687, 0.21797266602516174, 0.5959972143173218,
                    -0.16579188406467438, 0.845392107963562, -1.7785234451293945, 0.08136195689439774,
                    -0.6015731692314148, -0.603171706199646, 0.17448033392429352, -0.6855563521385193,
                    2.543546199798584, 0.2060917764902115, 0.08598970621824265, 0.3923402726650238, 1.3075981140136719,
                    -0.2667253613471985, -0.18592585623264313, 0.5987450480461121, 0.48322203755378723,
                    -1.1044288873672485, -1.2180100679397583, -1.5058568716049194, 0.3390882611274719,
                    2.132279872894287, 1.4838900566101074, -0.41371357440948486, -1.7243155241012573,
                    -0.10717909783124924, 0.7018461227416992, -0.015513635240495205, 0.69855135679245,
                    1.093419075012207, -0.01895689219236374, -0.5501739382743835, -0.32616424560546875,
                    -0.2908700406551361, 0.43383151292800903, 1.3071798086166382, -1.7483794689178467,
                    -0.381849080324173, -1.1739341020584106, -0.24744842946529388, 0.43413466215133667,
                    0.8810215592384338, -0.5057204365730286, -1.6011236906051636, 0.3052331507205963,
                    -0.38136354088783264, -0.9494369626045227, 0.7320863008499146, 1.2953426837921143,
                    0.5002042651176453, 0.7540501356124878, 0.4129820764064789, -0.2903602123260498, 0.4456138014793396,
                    -0.944207489490509, -2.3594069480895996, 0.504360556602478, 0.7693215608596802, -2.7845985889434814,
                    0.7080618739128113, 0.2735884189605713, -0.3842904269695282, 1.8759549856185913,
                    0.17965000867843628, 0.8500774502754211, -1.9552558660507202, 0.05720150098204613,
                    -0.9861721992492676, -1.310513973236084, 2.5743982791900635, -0.1825547218322754,
                    -0.33393532037734985, 0.19494570791721344, -0.9046002626419067, 0.8438524603843689,
                    -0.9542782306671143, 0.23139449954032898, 1.0475070476531982, 0.662817656993866,
                    -1.4700638055801392, 0.052196159958839417, -0.8254625201225281, 1.2218347787857056,
                    0.6067184805870056, -0.8644646406173706, 0.20392628014087677, -0.2664542496204376,
                    0.37052062153816223, 1.0185898542404175, 0.1191621646285057, -0.12163014709949493};
      uint64_t vb[] = {2792490941755848333u, 50824832080u};
      size_t l = 100;
      REQUIRE(
          dot_prod_cb_enc<float /* 64 */, float /* 64 */, uint64_t>(va, vb, l) == Approx(11.8220011266).epsilon(0.01));
    }
  }

  SECTION("float dot_prod_cb_enc(const float*, const uint64_t*, size_t), dim=119") {
    {
      float va[] =
          {1.1566057205200195, 0.3941749036312103, 0.026494622230529785, 0.6148156523704529, -1.4668426513671875,
           -0.3959314823150635, -0.09755425155162811, -1.0333421230316162, -0.8196721076965332, -2.0959765911102295,
           0.6373620629310608, 0.22548368573188782, -0.1674865186214447, 0.21613439917564392, -0.6640195846557617,
           1.3333204984664917, 0.22062091529369354, -1.902442455291748, -1.2527050971984863, -1.2079952955245972,
           0.38036710023880005, -0.12451432645320892, -1.2915072441101074, 0.23341013491153717, 0.05293715372681618,
           2.084152936935425, 1.1994150876998901, -0.032089799642562866, -0.6599618792533875, -0.41345539689064026,
           -0.6803940534591675, -0.8979877233505249, 0.7092843055725098, 0.05828004702925682, 0.15113656222820282,
           -0.25851359963417053, -0.21445101499557495, -0.7563674449920654, 2.1176209449768066, -0.9131700992584229,
           -0.13537627458572388, -1.8872207403182983, -0.6975096464157104, 0.7249987721443176, -1.6023091077804565,
           -0.7276108264923096, 0.42975229024887085, 1.2514504194259644, 0.18829673528671265, 0.12584802508354187,
           -0.05802057310938835, -0.21644581854343414, -0.028819644823670387, 1.1498295068740845, 0.122056744992733,
           0.9321300983428955, -0.8930597901344299, 0.918713390827179, -0.1790798157453537, 1.2482751607894897,
           -0.3713361918926239, -0.3416486978530884, 0.5909926295280457, 0.654491662979126, -0.49730443954467773,
           0.45011088252067566, -2.522559404373169, 0.7044024467468262, -0.4738816022872925, -1.3614797592163086,
           -0.6310020089149475, 0.7087967395782471, -0.4200522303581238, -1.0500593185424805, 0.5499439835548401,
           0.6552457809448242, 0.19778770208358765, -1.110785961151123, 0.824005663394928, 0.5121955275535583,
           0.22670374810695648, 0.5221519470214844, 0.7305273413658142, 0.5345471501350403, 0.5580213665962219,
           0.21718017756938934, 0.4115619957447052, 1.8983250856399536, -0.8592157959938049, 0.7482886910438538,
           -1.1997941732406616, -0.829375147819519, -0.31065917015075684, -0.07223310321569443, -0.09702017158269882,
           -0.8970154523849487, 0.5197650194168091, 1.120753288269043, 0.3636842370033264, 1.19618821144104,
           -0.6804911494255066, -0.6178734302520752, 0.6034886240959167, -0.38750195503234863, -0.5265838503837585,
           0.9246677756309509, -0.2577251195907593, 0.2250109761953354, -1.28561532497406, 1.1406197547912598,
           1.0060466527938843, 0.9685659408569336, -1.9031202793121338, 0.5401679277420044, -0.6472603678703308,
           1.3285439014434814, 0.47466611862182617, -0.4367055594921112, -0.3927779793739319};
      uint64_t vb[] = {11175833563555232721u, 3404151781082044u};
      size_t l = 119;
      REQUIRE(
          dot_prod_cb_enc<float /* 64 */, float /* 64 */, uint64_t>(va, vb, l) == Approx(24.7440774832).epsilon(0.01));
    }
    {
      float va[] =
          {-0.2353215217590332, 0.4613981246948242, 0.7332258224487305, -1.9219423532485962, 1.0388681888580322,
           0.46570345759391785, -0.02309597097337246, 0.3296380639076233, 0.7254925966262817, -0.46973004937171936,
           0.19997207820415497, 1.2994481325149536, -0.12119397521018982, 1.1647075414657593, -0.2903902530670166,
           -0.1655481457710266, -0.4368474781513214, -1.7155784368515015, 0.19927573204040527, -0.7005999684333801,
           0.7735123634338379, -0.703779399394989, -0.7153841257095337, -1.3563100099563599, -0.2177058756351471,
           -0.43513619899749756, -0.14116890728473663, -1.4239623546600342, -0.04468917474150658, -1.1052051782608032,
           -0.3100346624851227, 0.125484898686409, 1.6277146339416504, 0.002376074902713299, 0.6144043803215027,
           1.694930911064148, -1.2103265523910522, -0.28490743041038513, 0.46221208572387695, -1.0376555919647217,
           0.4664267599582672, 0.9190108776092529, -1.9542601108551025, 0.0402020700275898, -0.253068208694458,
           -1.446184754371643, -0.15394620597362518, -0.4927285611629486, -1.4282349348068237, 0.03774666413664818,
           -2.20346736907959, 1.05123770236969, 0.929415225982666, -1.5012226104736328, -0.050547756254673004,
           -0.18267063796520233, 0.33771809935569763, 0.436747282743454, -0.2477310299873352, -0.1357169896364212,
           -1.2473719120025635, -1.4397083520889282, 0.9204877614974976, 0.5360450744628906, -0.47659555077552795,
           1.898529291152954, -1.7175136804580688, 0.22918768227100372, 0.108235202729702, 0.3868672549724579,
           0.2193440943956375, -0.4252488315105438, 1.5783640146255493, 1.329659342765808, -0.9017925262451172,
           -0.0672266036272049, -0.34811437129974365, 0.8961437344551086, 0.25909358263015747, -1.0278464555740356,
           0.9254732131958008, -0.5192981362342834, 1.5379937887191772, -0.29763007164001465, -0.8725326657295227,
           0.4059889018535614, -0.900543212890625, 0.08950699120759964, -1.4470131397247314, -0.5751028656959534,
           -1.5988736152648926, -0.10806115716695786, -2.2572851181030273, 1.5502930879592896, 0.7844518423080444,
           1.4343483448028564, -2.0871896743774414, 0.07617464661598206, -0.427768349647522, 0.23275057971477509,
           0.4837340712547302, 0.5419656038284302, 0.13627015054225922, 0.45698127150535583, -1.1063199043273926,
           0.028795275837183, 1.1673064231872559, -0.6338655352592468, -0.7705180644989014, -0.4320022463798523,
           0.3782466650009155, -0.7896466255187988, 1.5781992673873901, -0.6474471092224121, 1.181069254875183,
           1.3069584369659424, 1.504419207572937, 0.13063789904117584, 0.39030951261520386};
      uint64_t vb[] = {1183053731785714884u, 28764932536400507u};
      size_t l = 119;
      REQUIRE(
          dot_prod_cb_enc<float /* 64 */, float /* 64 */, uint64_t>(va, vb, l) == Approx(-7.79869777616).epsilon(0.01));
    }
    {
      float va[] =
          {0.6056733727455139, -1.3693143129348755, -0.5615171194076538, -2.6382863521575928, 0.31203746795654297,
           -1.847920298576355, 1.8028972148895264, -1.901694893836975, 0.7391233444213867, 0.3924434781074524,
           0.5084500312805176, -1.1844083070755005, -0.865288496017456, -0.26712554693222046, -0.15436403453350067,
           0.3808142840862274, 1.1217046976089478, 0.47704800963401794, 0.1753682643175125, 0.10604061186313629,
           0.7742904424667358, 0.5417286157608032, -0.002523203380405903, -0.38958293199539185, -0.06575797498226166,
           -0.8178285360336304, -0.21758414804935455, -0.19596759974956512, 0.222690150141716, 0.26934584975242615,
           -0.8430057168006897, 2.7865102291107178, 0.9678292274475098, 0.03644494339823723, 0.5840309858322144,
           1.062180995941162, 0.7928362488746643, 0.4684540927410126, -0.5989710092544556, 0.026468446478247643,
           -0.1011044979095459, 0.3127366900444031, -2.5517849922180176, -1.3904016017913818, -0.705124020576477,
           0.22569355368614197, 0.8153496980667114, -0.8349268436431885, -0.5404566526412964, -0.8100234270095825,
           -0.5971221923828125, -0.31193092465400696, 0.06968538463115692, 0.19286364316940308, 1.101225733757019,
           0.6535923480987549, -0.25869694352149963, -0.862643837928772, 0.685674786567688, -0.16771377623081207,
           -0.5819865465164185, 0.002247184980660677, -0.9289878010749817, -0.17861312627792358, 2.6096878051757812,
           -1.1824908256530762, 0.9169036149978638, 1.4578102827072144, 0.6405524015426636, -0.01827714778482914,
           0.026770399883389473, 0.12656532227993011, -1.0846132040023804, 0.05344940349459648, -1.041797399520874,
           0.3363288938999176, 0.21748414635658264, 1.3882451057434082, -1.422582745552063, -1.415539026260376,
           -0.13843011856079102, -1.3979978561401367, 0.45269882678985596, 0.8373381495475769, 0.4050365686416626,
           0.7932276129722595, -0.7053669095039368, -1.5188671350479126, -0.07311944663524628, 0.7784239649772644,
           -1.5368211269378662, -1.2946282625198364, -1.1837742328643799, 0.7235018610954285, 0.12718647718429565,
           0.29735830426216125, 1.0682587623596191, -0.20111146569252014, 1.9512509107589722, -0.18304884433746338,
           -1.8254191875457764, -1.1767710447311401, 1.1555063724517822, -0.23413020372390747, 0.38812679052352905,
           0.21840782463550568, 0.2104470431804657, -0.41643479466438293, 0.8320316076278687, 0.41072022914886475,
           1.5623070001602173, -0.5182057619094849, -0.038570329546928406, -2.031475067138672, -0.9507718086242676,
           -0.10195700824260712, -0.3286265432834625, 1.9861222505569458, 1.342191219329834};
      uint64_t vb[] = {6778882490759800147u, 25461263100098863u};
      size_t l = 119;
      REQUIRE(
          dot_prod_cb_enc<float /* 64 */, float /* 64 */, uint64_t>(va, vb, l) == Approx(7.04069788614).epsilon(0.01));
    }
    {
      float va[] = {1.7729566097259521, 2.005657196044922, -0.5917147994041443, 0.0686672180891037, -0.6796954274177551,
                    0.5078502297401428, 0.19308117032051086, 1.0134962797164917, 0.8428173065185547, 1.3605637550354004,
                    -0.6766040921211243, 0.387300044298172, 0.4950847327709198, -0.5876573920249939,
                    -1.7021814584732056, -0.42487096786499023, -0.6343679428100586, 0.5417343378067017,
                    0.7781969308853149, 0.22292308509349823, -2.2224857807159424, -0.7544054388999939,
                    1.6414456367492676, -0.4470357298851013, -1.3298091888427734, 0.1151348203420639,
                    0.7459920048713684, 0.06439604610204697, -0.24620430171489716, 0.4068796932697296,
                    0.38823822140693665, 2.2546427249908447, 0.004661697894334793, -1.3609752655029297,
                    0.5336169600486755, -0.13868315517902374, 1.4585026502609253, -0.1886894404888153,
                    -1.1020563840866089, -0.9605233669281006, 1.1923692226409912, 0.22208358347415924,
                    -0.8841032385826111, -1.1382725238800049, 1.0508650541305542, -1.5441209077835083,
                    0.07788348197937012, -0.38325950503349304, -1.257926344871521, -1.2729202508926392,
                    -0.07348761707544327, -1.5165455341339111, 0.43640974164009094, -0.6713412404060364,
                    -1.0123989582061768, -0.3472571074962616, -0.2104150950908661, 0.8059864044189453,
                    0.37857288122177124, -0.9458651542663574, -1.7195638418197632, 0.6948325634002686,
                    -0.8192221522331238, -0.05919375643134117, -0.271460622549057, 2.4318883419036865,
                    1.4115900993347168, -1.7679104804992676, -1.7478036880493164, -0.3578857481479645,
                    -1.5464425086975098, -1.3303145170211792, -0.6430457830429077, 0.8680276870727539,
                    0.4098694324493408, 1.2992854118347168, -0.5972157716751099, -0.034316785633563995,
                    2.5883541107177734, 0.4265974462032318, 1.7537734508514404, 2.4822568893432617, 0.5550097227096558,
                    0.8671459555625916, 1.1834099292755127, 1.4647272825241089, -0.13536657392978668,
                    -0.28396323323249817, 0.5182109475135803, -1.560590386390686, -1.0161097049713135,
                    0.6721135973930359, 0.5458970069885254, 1.0938692092895508, 0.3421257436275482, -0.1464070826768875,
                    -0.7568226456642151, -0.4013839364051819, 1.4817506074905396, 1.7021907567977905,
                    -0.9731325507164001, 0.49111810326576233, -0.6974930167198181, -0.6665244698524475,
                    0.33579978346824646, 1.0112485885620117, 0.42013925313949585, 1.0507174730300903,
                    -1.2900424003601074, -0.9336287379264832, -1.0128798484802246, -1.086429476737976,
                    1.629155158996582, 1.0118800401687622, 1.1519044637680054, -0.48992422223091125, 0.521950900554657,
                    -1.9461194276809692, -0.8487674593925476};
      uint64_t vb[] = {11666965269687056798u, 18008259425236755u};
      size_t l = 119;
      REQUIRE(
          dot_prod_cb_enc<float /* 64 */, float /* 64 */, uint64_t>(va, vb, l) == Approx(10.9749529809).epsilon(0.01));
    }
    {
      float va[] =
          {0.12793855369091034, 1.1375805139541626, -1.855308175086975, -0.8254776000976562, -0.31955257058143616,
           -1.3388737440109253, -1.4660758972167969, 0.28540074825286865, -0.5531148314476013, -0.27346643805503845,
           1.3710309267044067, -0.6580979824066162, -2.2111237049102783, 2.4998068809509277, 0.031601432710886,
           -0.6959078311920166, 0.47230061888694763, 0.8205896019935608, 0.8130748867988586, -1.9717541933059692,
           -1.468544602394104, -1.1656779050827026, -0.07488393038511276, -0.061116691678762436, -0.42934170365333557,
           -0.5560554265975952, -0.5818655490875244, -1.5155247449874878, 0.8348939418792725, 0.9014260172843933,
           -0.061177339404821396, 0.9746257662773132, -0.26936444640159607, 0.12330836802721024, 0.8068107962608337,
           1.7422086000442505, 0.19459261000156403, -1.3238776922225952, -0.4770517647266388, 0.19902555644512177,
           -0.6772400736808777, -0.5614436268806458, 0.7389436960220337, -0.8242232203483582, 0.37175804376602173,
           0.7687888741493225, 0.34103143215179443, 0.36634182929992676, -1.5898257493972778, 0.47383880615234375,
           0.7938194870948792, -1.217975378036499, 1.3992211818695068, 0.04713311046361923, -0.41542375087738037,
           0.9346415400505066, -1.2774628400802612, -0.7205586433410645, 1.3227688074111938, 1.1457630395889282,
           -0.2382684201002121, -1.5784485340118408, 0.5290058255195618, -2.0136773586273193, -0.5391753315925598,
           0.021300246939063072, 1.7351100444793701, -1.426047444343567, -0.4748980402946472, -0.3695477545261383,
           -0.13183146715164185, -0.6915815472602844, 0.2300986498594284, 0.17536982893943787, 0.1040174663066864,
           -1.2217745780944824, 0.6346566081047058, -1.3732157945632935, -0.49443671107292175, 1.424204707145691,
           0.725930392742157, -0.987540066242218, -1.1937774419784546, -0.8988772034645081, 0.4385389983654022,
           1.3688589334487915, -0.2536073327064514, -1.2212660312652588, 0.07349017262458801, 0.07788165658712387,
           -1.1135584115982056, -1.0206799507141113, -1.7510592937469482, -0.9564205408096313, -1.4364250898361206,
           1.3542001247406006, -0.33893299102783203, 0.23160770535469055, -1.2095801830291748, -1.5551586151123047,
           0.4586181044578552, -0.018279852345585823, 0.7487173080444336, -0.6457594037055969, 0.25722554326057434,
           -0.7353196740150452, -1.4282031059265137, 1.371698260307312, 1.0366294384002686, 0.0030107281636446714,
           0.6176193952560425, -0.7083070278167725, 0.23321320116519928, -2.167710542678833, -2.220424175262451,
           -0.42194730043411255, -0.9408983588218689, 1.1004225015640259, 0.1141817569732666};
      uint64_t vb[] = {2226720693457039749u, 14297819366939239u};
      size_t l = 119;
      REQUIRE(
          dot_prod_cb_enc<float /* 64 */, float /* 64 */, uint64_t>(va, vb, l) == Approx(2.23427940602).epsilon(0.01));
    }
  }

  SECTION("float dot_prod_cb_enc(const float*, const uint64_t*, size_t), dim=24") {
    {
      float va[] = {1.9412442445755005, 0.998942494392395, -1.329201340675354, 0.9371527433395386, -1.8277922868728638,
                    -0.07906125485897064, -0.6214062571525574, -0.9024574756622314, 1.9515490531921387,
                    -1.8598053455352783, -0.5200210213661194, -1.079936146736145, -0.31079792976379395,
                    -0.6830524802207947, -0.005414698738604784, -1.621546745300293, 0.878983199596405,
                    -0.2996872663497925, -0.33672159910202026, -1.2824422121047974, 0.8336532115936279,
                    -0.7971926927566528, -0.9754467606544495, 0.1652449518442154};
      uint64_t vb[] = {3304509u};
      size_t l = 24;
      REQUIRE(
          dot_prod_cb_enc<float /* 64 */, float /* 64 */, uint64_t>(va, vb, l) == Approx(-4.78396632848).epsilon(0.01));
    }
    {
      float va[] =
          {-0.5767210125923157, 0.276378333568573, 0.27454516291618347, -0.4503753185272217, -1.0686672925949097,
           1.0800161361694336, -0.8646439909934998, 3.3057444095611572, -0.25550004839897156, 0.8592217564582825,
           -0.006996637210249901, -1.2944661378860474, 0.45955008268356323, 1.4714868068695068, -0.11171557754278183,
           0.0014258865267038345, -0.22633565962314606, 2.3733930587768555, -1.028737187385559, 0.1389266699552536,
           -0.25168463587760925, -1.508217692375183, 1.383457899093628, 0.5644411444664001};
      uint64_t vb[] = {8591898u};
      size_t l = 24;
      REQUIRE(dot_prod_cb_enc<float /* 64 */, float /* 64 */, uint64_t>(va, vb, l)
                  == Approx(-0.167630743235).epsilon(0.01));
    }
    {
      float va[] =
          {0.17182661592960358, 1.8809239864349365, 1.2328314781188965, -1.5968316793441772, 0.6478332877159119,
           -0.9640897512435913, 0.24651768803596497, -0.37077197432518005, 0.6965929269790649, 0.022233417257666588,
           0.40944647789001465, -2.193404197692871, -0.8506658673286438, -1.20892333984375, -1.409463882446289,
           1.3288620710372925, 1.6580697298049927, 0.27852940559387207, -0.342262864112854, 1.085678219795227,
           -0.6723912358283997, -0.41116806864738464, 0.7302178144454956, -2.05859112739563};
      uint64_t vb[] = {7948783u};
      size_t l = 24;
      REQUIRE(
          dot_prod_cb_enc<float /* 64 */, float /* 64 */, uint64_t>(va, vb, l) == Approx(4.64263761602).epsilon(0.01));
    }
    {
      float va[] =
          {0.7233831882476807, -0.5425070524215698, 0.022182408720254898, 0.381266713142395, 0.08186789602041245,
           -0.05811464414000511, -1.3730924129486084, 0.6296784281730652, -0.13420899212360382, -1.749804139137268,
           -1.5461868047714233, -0.6436397433280945, -0.8843365907669067, 0.7428354620933533, 0.46585386991500854,
           0.5707423686981201, -0.3622627556324005, 1.6330080032348633, -0.10803861171007156, 1.460371494293213,
           0.6414118409156799, 1.1285920143127441, -1.1976218223571777, -0.5554546117782593};
      uint64_t vb[] = {11348563u};
      size_t l = 24;
      REQUIRE(
          dot_prod_cb_enc<float /* 64 */, float /* 64 */, uint64_t>(va, vb, l) == Approx(2.22333612293).epsilon(0.01));
    }
    {
      float va[] =
          {1.5336881875991821, -2.4546451568603516, 1.1557364463806152, -1.3507441282272339, 1.2143903970718384,
           1.9713780879974365, -1.7160438299179077, -0.617177426815033, -0.7476484775543213, 0.5034752488136292,
           -0.055335741490125656, 0.06737860292196274, 1.4662185907363892, -1.0089975595474243, 0.010801923461258411,
           0.44668611884117126, 1.5283347368240356, 2.5381603240966797, 0.4867067337036133, 0.09420756250619888,
           0.4821974039077759, -1.01276433467865, -1.129786729812622, -0.02645239606499672};
      uint64_t vb[] = {4019411u};
      size_t l = 24;
      REQUIRE(
          dot_prod_cb_enc<float /* 64 */, float /* 64 */, uint64_t>(va, vb, l) == Approx(6.5000417484).epsilon(0.01));
    }
  }

  SECTION("float dot_prod_cb_enc(const float*, const uint64_t*, size_t), dim=23") {
    {
      float va[] =
          {-0.19574867188930511, -1.226305365562439, 0.6426470279693604, -0.5891293287277222, 1.0749708414077759,
           -0.4229004979133606, -1.8212478160858154, 0.07081212848424911, -1.2142815589904785, 0.2657392621040344,
           -0.6633999943733215, -0.5397968292236328, 1.0523550510406494, -1.1191678047180176, -2.0659255981445312,
           -0.8686758279800415, 0.13033005595207214, 0.7343456745147705, -1.7628296613693237, -0.32564452290534973,
           -0.46095430850982666, 0.7094445824623108, 2.1806416511535645};
      uint64_t vb[] = {6550209u};
      size_t l = 23;
      REQUIRE(
          dot_prod_cb_enc<float /* 64 */, float /* 64 */, uint64_t>(va, vb, l) == Approx(-3.35368736833).epsilon(0.01));
    }
    {
      float va[] =
          {0.8547765612602234, 0.48232612013816833, -0.04407893866300583, -1.4801722764968872, 1.3156410455703735,
           0.6461271643638611, -0.9089570045471191, -0.34958019852638245, -0.7575758099555969, -0.9989380240440369,
           0.48855626583099365, -1.2444632053375244, -0.03671880066394806, -0.2798536717891693, -0.58154296875,
           0.3279114067554474, 0.2596087157726288, 0.21570689976215363, -0.6655579805374146, -0.34109339118003845,
           -1.3006787300109863, 0.5793227553367615, 0.09391806274652481};
      uint64_t vb[] = {7846066u};
      size_t l = 23;
      REQUIRE(
          dot_prod_cb_enc<float /* 64 */, float /* 64 */, uint64_t>(va, vb, l) == Approx(5.12290173769).epsilon(0.01));
    }
    {
      float va[] =
          {0.9804251194000244, -0.9137710928916931, -0.2485761046409607, -1.0221980810165405, -0.2659212052822113,
           0.840144157409668, 0.16186995804309845, 0.6986547112464905, 0.1007290631532669, -1.142338752746582,
           -0.32539108395576477, 0.37022721767425537, -1.6767200231552124, 0.0017942734993994236, 1.5188467502593994,
           0.5777067542076111, 0.8474431037902832, -0.07114541530609131, -0.4986356794834137, 0.8896750807762146,
           -0.14031516015529633, 0.3524220585823059, -0.07989133894443512};
      uint64_t vb[] = {2302172u};
      size_t l = 23;
      REQUIRE(
          dot_prod_cb_enc<float /* 64 */, float /* 64 */, uint64_t>(va, vb, l) == Approx(0.288522427436).epsilon(0.01));
    }
    {
      float va[] =
          {1.3692669868469238, 1.2346922159194946, 2.3688433170318604, 0.6138761043548584, -0.20457477867603302,
           -0.47394469380378723, -0.1303955316543579, 1.8792749643325806, 1.4698370695114136, 0.03211269527673721,
           1.3102339506149292, 0.4386592507362366, -1.4572252035140991, -1.578061580657959, -0.002274762839078903,
           -0.41708946228027344, -1.658966064453125, 0.2974788248538971, -1.914486289024353, -1.0180206298828125,
           -0.9288836717605591, -0.9532743692398071, -1.7932476997375488};
      uint64_t vb[] = {5286312u};
      size_t l = 23;
      REQUIRE(
          dot_prod_cb_enc<float /* 64 */, float /* 64 */, uint64_t>(va, vb, l) == Approx(11.4126717262).epsilon(0.01));
    }
    {
      float va[] =
          {-1.6412572860717773, 0.33100631833076477, -1.3597811460494995, -0.9040584564208984, -1.9404948949813843,
           0.009211158379912376, 0.12904158234596252, -0.061855994164943695, -2.42777681350708, 0.06954579055309296,
           -0.027002885937690735, 0.9565674066543579, 1.6437718868255615, 0.9328042268753052, -0.8186138868331909,
           1.0547207593917847, -1.3777599334716797, -0.7343863844871521, 0.9165425300598145, -0.11321958154439926,
           -0.029616262763738632, 1.5111125707626343, -0.6240606307983398};
      uint64_t vb[] = {1856200u};
      size_t l = 23;
      REQUIRE(
          dot_prod_cb_enc<float /* 64 */, float /* 64 */, uint64_t>(va, vb, l) == Approx(-7.81957752444).epsilon(0.01));
    }
  }

  SECTION("float dot_prod_cb_enc(const float*, const uint64_t*, size_t), dim=150") {
    {
      float va[] =
          {-1.9679292440414429, 0.7603964805603027, 0.10738135874271393, -0.7093480229377747, -0.1846698373556137,
           0.20071761310100555, 2.783994674682617, -0.39154964685440063, 2.100043296813965, 0.683103621006012,
           -1.3426731824874878, 0.21027971804141998, 1.9786584377288818, -0.5177203416824341, -1.2376515865325928,
           -0.17808152735233307, 0.23351332545280457, 2.534571409225464, 1.1478358507156372, 1.2608330249786377,
           1.1646151542663574, -1.3089567422866821, 0.5640947222709656, -1.4009662866592407, -0.023605432361364365,
           -0.5336538553237915, 0.4112781584262848, -1.0877131223678589, 0.9672807455062866, -0.3787705600261688,
           -0.6258969902992249, 0.6468070149421692, -0.7479819655418396, 0.7166445255279541, 0.8138287663459778,
           -2.267066478729248, 1.7455189228057861, 0.17131353914737701, 0.18188540637493134, 1.6511143445968628,
           0.7339040040969849, -1.6469272375106812, 0.4127693772315979, 0.27148982882499695, 1.5110948085784912,
           -0.45631706714630127, 0.4898013472557068, -1.3480961322784424, -1.0291715860366821, -0.7560725808143616,
           1.5308468341827393, 1.1423182487487793, 1.0368289947509766, -0.6867763996124268, 0.4321662187576294,
           -0.9061854481697083, -0.9787365794181824, -1.313444972038269, -1.261171817779541, 0.5094813704490662,
           0.7852864861488342, -0.8984046578407288, 0.2638973891735077, 0.6040899157524109, 0.7482457160949707,
           -0.2455860823392868, -0.35672277212142944, 0.8525784611701965, -0.19775894284248352, 0.604533314704895,
           0.5783586502075195, 0.5282692909240723, -2.263293981552124, 0.0227787084877491, -0.731587290763855,
           0.3518514335155487, -0.5369603037834167, -0.24993346631526947, 0.7320066690444946, 0.750870406627655,
           0.2356196790933609, -1.8169260025024414, -0.7175976037979126, 0.3736094534397125, -0.15576282143592834,
           -0.49798232316970825, -0.3608042001724243, -1.161725401878357, 0.9192670583724976, -0.16969510912895203,
           0.41896766424179077, -1.7163217067718506, 0.18741032481193542, -0.15927039086818695, -0.5396987795829773,
           -0.5858996510505676, 0.35952305793762207, -1.8357044458389282, 0.21286016702651978, 0.5281558036804199,
           0.36273568868637085, 0.9133883714675903, 1.062676191329956, -0.6433156132698059, 0.05448419600725174,
           -0.9384956359863281, -1.3194124698638916, 0.02520127035677433, 0.194395512342453, -1.0098437070846558,
           -1.1183161735534668, -0.5984797477722168, 0.4222666919231415, 1.0719397068023682, 0.369111031293869,
           -0.2568879723548889, 1.7252602577209473, -1.9321138858795166, 2.3585708141326904, -0.2974763512611389,
           -1.5979783535003662, -0.6797979474067688, -0.5142954587936401, -2.795173406600952, 0.155042827129364,
           1.441781759262085, -0.6466081738471985, -1.06562077999115, -0.24029916524887085, 0.8669033050537109,
           -0.4929623007774353, -0.06140041723847389, 0.3765498399734497, 0.5106257200241089, 0.9356513619422913,
           -0.0399307981133461, 0.5892354249954224, -0.18014980852603912, 0.05445866286754608, -0.0949823334813118,
           0.8479311466217041, -0.8005139231681824, 2.24151873588562, 0.6450946927070618, -0.2778466045856476,
           -0.11308114975690842, 1.5820168256759644, -2.2931127548217773, 0.030986767262220383, 0.2806016504764557};
      uint64_t vb[] = {11414882201589329327u, 9146057191950458222u, 3892799u};
      size_t l = 150;
      REQUIRE(
          dot_prod_cb_enc<float /* 64 */, float /* 64 */, uint64_t>(va, vb, l) == Approx(0.178165318444).epsilon(0.01));
    }
    {
      float va[] =
          {-0.5974878072738647, -0.20772011578083038, 1.1441479921340942, 0.9442107081413269, -0.4918501675128937,
           -0.7501935958862305, -0.9735300540924072, 0.37024787068367004, 1.0269445180892944, 1.0822921991348267,
           -0.7065485715866089, 0.9810150861740112, 1.2904129028320312, 0.9776053428649902, 0.2959586977958679,
           0.7202893495559692, -1.2178711891174316, 0.6008655428886414, -1.214347243309021, 0.47363176941871643,
           0.7959712743759155, -0.5747798681259155, -1.515459418296814, -0.3464568853378296, 1.189814805984497,
           -2.6281352043151855, 0.3281340003013611, -1.1131296157836914, 0.3198555111885071, -1.18865168094635,
           0.9636043310165405, -1.3735045194625854, 0.20072363317012787, -0.37515828013420105, -0.9438275098800659,
           0.8025296926498413, -0.37975236773490906, -0.008017701096832752, 0.45185017585754395, -1.890992283821106,
           -0.4762091338634491, -0.9097841382026672, -0.07766292989253998, 0.8695212602615356, -0.9582594633102417,
           0.5879619717597961, 0.9642366170883179, -0.2840973138809204, 1.322549819946289, 0.14251084625720978,
           -0.9998162388801575, -0.4033809304237366, 0.19578306376934052, 0.8324130177497864, 1.5852458477020264,
           0.4067496061325073, 1.2666385173797607, 1.2538164854049683, 0.4931780993938446, 1.059471607208252,
           0.9048490524291992, 2.1082823276519775, -1.6059718132019043, 0.5471987128257751, -0.9386659860610962,
           -0.2345755249261856, 0.2886098623275757, -0.5397035479545593, 1.3374097347259521, -0.7658040523529053,
           -0.2260126918554306, -0.4026869833469391, 0.034065596759319305, -1.5721224546432495, 1.2514911890029907,
           2.0217578411102295, 0.3223726451396942, -0.8980857729911804, -0.9632453322410583, -0.30190059542655945,
           1.1185660362243652, 0.7034528851509094, -0.17017467319965363, 0.46208441257476807, -1.353636384010315,
           0.011075186543166637, 0.18959638476371765, -0.0981353148818016, -1.3472484350204468, 0.5437768697738647,
           -0.7421141862869263, -1.12090003490448, -0.461968332529068, -0.6255429983139038, -0.38810837268829346,
           -0.9689951539039612, -3.015840530395508, 1.061156988143921, 0.8739060163497925, 0.15106089413166046,
           -0.2780803143978119, 0.6464858651161194, 0.3893378973007202, -0.5760140419006348, -1.2817790508270264,
           1.8515597581863403, 0.0227164626121521, -0.541498064994812, -0.17808480560779572, 0.7471079230308533,
           0.22542721033096313, 1.1564042568206787, 0.6012182235717773, 1.3974100351333618, 1.2464803457260132,
           2.1393630504608154, -1.1958584785461426, -1.1952149868011475, 1.5059717893600464, -0.6937654614448547,
           -0.14865311980247498, 1.036958932876587, 1.1005276441574097, 0.4617358446121216, 0.3731372654438019,
           0.11395084112882614, -0.4448128938674927, 0.5044650435447693, -1.3952796459197998, -0.5284435749053955,
           0.30674993991851807, 0.05568014830350876, -2.7679898738861084, 0.17621470987796783, 0.11871913075447083,
           -0.6411434412002563, 2.4220545291900635, -0.6319417357444763, 0.7730855941772461, -1.8828792572021484,
           0.8783302903175354, -1.0229933261871338, 0.35244083404541016, 0.6215053200721741, -0.33270394802093506,
           -0.26819366216659546, -0.6066973805427551, -1.381133794784546, -0.9769493341445923, -1.0042613744735718};
      uint64_t vb[] = {18417820491607569569u, 9712322814584570419u, 3041523u};
      size_t l = 150;
      REQUIRE(
          dot_prod_cb_enc<float /* 64 */, float /* 64 */, uint64_t>(va, vb, l) == Approx(-4.16150478087).epsilon(0.01));
    }
    {
      float va[] =
          {0.588169515132904, -1.4394056797027588, -1.7978501319885254, -1.1866446733474731, 0.4561022222042084,
           -0.45580655336380005, 1.7328171730041504, 2.258873701095581, -0.19164210557937622, -0.057565707713365555,
           0.7176888585090637, -0.8720706105232239, 0.7781532406806946, -0.6245661377906799, 2.0519955158233643,
           0.46769949793815613, -0.68699711561203, -0.8843696117401123, 1.6350767612457275, -0.8322301506996155,
           0.7652533650398254, 1.4956598281860352, -0.47168081998825073, -0.025139987468719482, -1.4919700622558594,
           0.2734168469905853, -0.050567831844091415, 0.031358808279037476, 1.094609022140503, -1.013021469116211,
           2.123678207397461, 0.047597017139196396, 0.25158730149269104, 0.40896061062812805, 1.4055558443069458,
           1.144176721572876, -1.5895448923110962, -0.011058691889047623, -1.615613341331482, -0.025203829631209373,
           0.5702856779098511, 0.6123208999633789, 1.4687832593917847, -1.79576575756073, 0.43780815601348877,
           -0.5857791304588318, 0.7688620090484619, 0.85354083776474, -0.05013979598879814, 1.2580912113189697,
           0.6961420178413391, -0.7244361639022827, 0.8516215682029724, -0.31457066535949707, -0.48017239570617676,
           0.10108722001314163, 0.3320414423942566, 0.023188043385744095, 0.9227088689804077, 0.810441255569458,
           -0.708334743976593, 1.143928050994873, 1.9432494640350342, -1.0208820104599, -0.9325149655342102,
           0.10976976156234741, 0.11287540197372437, 0.7667843699455261, -0.3645136058330536, 0.03144429624080658,
           -0.4721643924713135, -0.03571773320436478, -0.07285197824239731, 0.35999467968940735, 0.2409353256225586,
           0.19656483829021454, -0.3225521147251129, -0.6079866290092468, 0.2126343548297882, -1.1010828018188477,
           -1.7953102588653564, -0.28871363401412964, -0.13775776326656342, -1.394798755645752, 1.191815972328186,
           0.1166517585515976, -1.223636269569397, 0.3632511496543884, -1.2751257419586182, 0.10550731420516968,
           0.3020336627960205, 1.625243902206421, 0.272356241941452, 0.8580183982849121, 0.12494111061096191,
           0.4732549488544464, 1.3748245239257812, -0.7959696650505066, 0.8993354439735413, 1.6145169734954834,
           -0.43376147747039795, 1.688159704208374, 0.41722649335861206, -1.77741277217865, -0.29794231057167053,
           -0.04866093024611473, 1.3320938348770142, 0.8542198538780212, 1.8311588764190674, 0.5323547720909119,
           1.5146596431732178, -0.9693266749382019, -0.014539009891450405, 0.05486534163355827, -0.5499506592750549,
           -1.7684669494628906, 0.41470491886138916, -1.3564469814300537, 0.5732011198997498, -0.31210771203041077,
           -0.3468414545059204, -0.9272233843803406, -0.29697635769844055, 0.4423040747642517, 1.5370830297470093,
           0.6579238772392273, 0.859921395778656, 1.0178542137145996, -1.381389856338501, 2.285627603530884,
           -0.2903119921684265, -1.9085098505020142, 1.2003682851791382, -0.6952559351921082, -0.20430275797843933,
           -1.2371948957443237, -0.11760786920785904, -1.0144416093826294, -0.4417482018470764, 0.2086762934923172,
           -0.03391098976135254, 0.6995238661766052, -0.6015092134475708, 1.3789324760437012, -1.307392954826355,
           -1.293394923210144, 0.9250326156616211, 1.8165559768676758, -1.7105666399002075, -0.1875482052564621};
      uint64_t vb[] = {5418208331281111985u, 13979609389911021182u, 3926997u};
      size_t l = 150;
      REQUIRE(
          dot_prod_cb_enc<float /* 64 */, float /* 64 */, uint64_t>(va, vb, l) == Approx(-10.9938236224).epsilon(0.01));
    }
    {
      float va[] =
          {-0.24504493176937103, -0.23748186230659485, 1.284298062324524, 1.8860721588134766, -0.3164542317390442,
           1.3371872901916504, -0.09227216243743896, 1.5073394775390625, -0.4499835968017578, -0.829325795173645,
           -1.1467260122299194, 0.0019010420655831695, -0.9748138785362244, -0.051391348242759705, -1.648709774017334,
           1.2057669162750244, 0.6265906691551208, 0.7004672884941101, -0.5035858750343323, 2.0343518257141113,
           0.5058691501617432, -0.48998966813087463, -1.27704918384552, 0.6090356111526489, -1.439765453338623,
           0.8841954469680786, 0.42567527294158936, -1.145219326019287, 0.1042494997382164, -0.6535958647727966,
           0.8246353268623352, -0.006559950299561024, 0.3741406500339508, 0.7437124848365784, -0.2484075427055359,
           -1.996334195137024, 0.2511347532272339, -0.7234035134315491, 2.024479389190674, 1.6727728843688965,
           -0.3083592355251312, 1.1497735977172852, -0.7978091239929199, 0.622101902961731, -0.750451385974884,
           -1.6335361003875732, 2.7587528228759766, 0.991194486618042, -0.4724835753440857, -0.30026358366012573,
           -0.8191753625869751, -0.11339098960161209, -2.6760151386260986, 1.503377079963684, -0.7767780423164368,
           1.4292070865631104, 0.7261118292808533, 0.10961294174194336, 0.7317642569541931, 0.2520579695701599,
           -0.07340797781944275, -0.6361792087554932, 1.2466318607330322, 0.48409509658813477, 0.07932927459478378,
           0.1322890669107437, 1.4873661994934082, 0.2915686368942261, 0.6648203134536743, -0.27327027916908264,
           1.0129703283309937, -1.2852009534835815, -0.2640670835971832, -2.185173988342285, -0.8789022564888,
           -0.17334112524986267, 1.739427089691162, 0.6794055700302124, -1.4435293674468994, 0.5923731923103333,
           -0.43541741371154785, 0.1864217221736908, 0.6835358738899231, 0.7695707082748413, 0.8549906015396118,
           1.8238639831542969, 0.48652538657188416, -0.4141511917114258, 0.6828144788742065, -1.0876158475875854,
           1.9931117296218872, -0.2487887591123581, -0.20918765664100647, -0.1662990301847458, 0.6854120492935181,
           -0.25849080085754395, 0.8745465874671936, -2.4592180252075195, -0.9370438456535339, 1.8624578714370728,
           0.062165431678295135, 1.7380915880203247, 0.6726377010345459, -0.35900893807411194, 0.3561820685863495,
           -0.12736736238002777, 1.433498740196228, 0.0056997863575816154, -0.5899563431739807, 0.09581153839826584,
           -0.9715569615364075, 0.046305764466524124, 1.386275291442871, 0.09778691828250885, -0.2161722481250763,
           -0.4075489044189453, -1.7251185178756714, 0.22425273060798645, -0.3224518895149231, -0.5052724480628967,
           0.24567405879497528, 0.3659363389015198, 0.1664925217628479, -0.32540926337242126, -0.895916223526001,
           0.24083733558654785, -0.25996673107147217, 1.2294433116912842, 1.7375011444091797, -0.36874181032180786,
           -0.21403783559799194, -0.10280201584100723, 1.611228585243225, -1.524553656578064, -0.9982296824455261,
           0.49177977442741394, 0.9804803729057312, -2.6693973541259766, 0.4824700355529785, 0.24644863605499268,
           0.1009102314710617, -0.03755991905927658, 0.19556716084480286, 0.837200939655304, -0.051210664212703705,
           -0.8326665759086609, -0.08447752147912979, -0.6904775500297546, -0.8478426933288574, 0.771592915058136};
      uint64_t vb[] = {6268988324552465198u, 2588788386570610236u, 2853878u};
      size_t l = 150;
      REQUIRE(
          dot_prod_cb_enc<float /* 64 */, float /* 64 */, uint64_t>(va, vb, l) == Approx(-4.84572011197).epsilon(0.01));
    }
    {
      float va[] =
          {0.5501688718795776, 0.10081832110881805, -1.0402547121047974, -0.27400097250938416, 0.5765066146850586,
           -1.3753010034561157, -0.7647078037261963, 1.0988434553146362, 0.2945868968963623, -1.5111712217330933,
           -0.780135452747345, -0.48427197337150574, -0.791791558265686, 0.4361804723739624, 0.2785193622112274,
           0.9012173414230347, 1.1994646787643433, -0.08981078118085861, 1.6055245399475098, 0.5669626593589783,
           0.321586012840271, 0.8138935565948486, -0.39855146408081055, -0.10442264378070831, 1.1490910053253174,
           0.4364660084247589, 0.13065794110298157, -1.0049077272415161, -0.24444931745529175, -0.4370623230934143,
           0.4182858467102051, -0.121388278901577, -0.07114171981811523, -1.0543915033340454, 0.9334878325462341,
           -2.12844181060791, -0.7395569682121277, 0.21606846153736115, 1.026918649673462, -0.2649509012699127,
           -0.11359841376543045, -0.6312662959098816, -0.6551641225814819, -0.2494780421257019, -1.031377911567688,
           0.32114705443382263, -0.7981842756271362, 0.20458188652992249, 1.3314833641052246, 0.9464247822761536,
           -1.330696940422058, -0.5448558330535889, -0.24574370682239532, 1.58012855052948, 0.7342726588249207,
           0.2954810857772827, -0.06301144510507584, 1.3254482746124268, -1.6572884321212769, 0.10167262703180313,
           -1.4588760137557983, 0.4984338581562042, -0.07418850064277649, 0.23958462476730347, 0.7737908959388733,
           0.16033397614955902, -0.4117860794067383, -0.8114979267120361, -0.8207048177719116, -1.3688219785690308,
           0.1748415231704712, -0.6006306409835815, -0.45659002661705017, 0.573714554309845, -1.443407654762268,
           0.14023129642009735, 0.19748494029045105, 1.2932531833648682, 1.1475310325622559, 0.754740834236145,
           0.21076416969299316, 0.12625551223754883, 0.6684767007827759, -1.9291858673095703, -1.3231428861618042,
           -1.5598970651626587, 1.116246223449707, 0.8620801568031311, 1.5334622859954834, 0.17483802139759064,
           -1.0804557800292969, 0.8702517151832581, -0.1968446522951126, 1.2256481647491455, -1.8432879447937012,
           -0.5885975360870361, -0.1129329577088356, 0.5462033748626709, 0.5839541554450989, 0.17082349956035614,
           -2.1332900524139404, 0.9148292541503906, -0.19503222405910492, -0.8783193826675415, -0.7255527377128601,
           -0.927088737487793, -1.1841707229614258, -0.48239004611968994, -0.8886815309524536, -0.09683846682310104,
           -1.2188800573349, 1.012959599494934, 0.6360180377960205, 0.3095490634441376, 0.3864467442035675,
           0.17414993047714233, -0.11526695638895035, -1.10093355178833, 0.3347381055355072, 0.9004730582237244,
           1.1955546140670776, -0.7531657814979553, -0.6008989214897156, 0.8560681343078613, 1.4586964845657349,
           0.4311417043209076, -0.047825369983911514, 0.7527942657470703, 1.1699542999267578, -0.3189283311367035,
           2.033679485321045, -0.906923234462738, -0.9515241980552673, -0.06255567818880081, 1.13752281665802,
           0.1486680954694748, 0.3679725229740143, 2.448590040206909, -0.32021012902259827, -0.23653027415275574,
           0.739180326461792, -1.598257303237915, -1.387488842010498, -0.36869847774505615, -0.7024185657501221,
           -0.835582971572876, -1.1519160270690918, 0.8694947957992554, 1.4085192680358887, 0.20325696468353271};
      uint64_t vb[] = {8054605141791832393u, 210596905635009182u, 3874569u};
      size_t l = 150;
      REQUIRE(
          dot_prod_cb_enc<float /* 64 */, float /* 64 */, uint64_t>(va, vb, l) == Approx(20.8739220239).epsilon(0.01));
    }
  }

}